"use strict";(()=>{var e={};e.id=412,e.ids=[412],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32307:e=>{e.exports=require("next/dist/server/app-render/prerender-async-storage.external.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},41808:e=>{e.exports=require("net")},72254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},84492:e=>{e.exports=require("node:stream")},47261:e=>{e.exports=require("node:util")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},4074:e=>{e.exports=require("perf_hooks")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},53405:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>L,requestAsyncStorage:()=>$,routeModule:()=>F,serverHooks:()=>M,staticGenerationAsyncStorage:()=>P});var a={};r.r(a),r.d(a,{DELETE:()=>E,POST:()=>j});var n=r(38728),o=r(64006),s=r(64615),i=r(30006),l=r(37080),c=r(92031),u=r(55203);function d(e){if("boolean"==typeof e)return{type:"boolean",properties:{}};let{type:t,description:r,required:a,properties:n,items:o,allOf:s,anyOf:i,oneOf:l,format:c,const:u,minLength:p}=e,m={};return r&&(m.description=r),a&&(m.required=a),c&&(m.format=c),void 0!==u&&(m.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(m.type=t.filter(e=>"null"!==e)[0],m.nullable=!0):m.type=t:"null"===t?m.type="null":m.type=t),n&&(m.properties=Object.entries(n).reduce((e,[t,r])=>(e[t]=d(r),e),{})),o&&(m.items=Array.isArray(o)?o.map(d):d(o)),s&&(m.allOf=s.map(d)),i&&(m.anyOf=i.map(d)),l&&(m.oneOf=l.map(d)),void 0!==p&&(m.minLength=p),m}function p(e){return e.includes("/")?e:`models/${e}`}var m=l.Ry({error:l.Ry({code:l.Rx().nullable(),message:l.Z_(),status:l.Z_()})}),h=(0,c.Sq)({errorSchema:m,errorToMessage:e=>e.error.message});function f({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"RECITATION":case"SAFETY":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";default:return"unknown"}}var g=class{constructor(e,t,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=r}get supportsObjectGeneration(){return!1!==this.settings.structuredOutputs}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:r,temperature:a,topP:n,topK:o,frequencyPenalty:s,presencePenalty:i,stopSequences:l,responseFormat:p,seed:m}){var h;let f=e.type,g=[];null!=s&&g.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=i&&g.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=m&&g.push({type:"unsupported-setting",setting:"seed"});let y={topK:null!=o?o:this.settings.topK,maxOutputTokens:r,temperature:a,topP:n,stopSequences:l,responseMimeType:(null==p?void 0:p.type)==="json"?"application/json":void 0,responseSchema:(null==p?void 0:p.type)==="json"&&null!=p.schema&&this.supportsObjectGeneration?d(p.schema):void 0},{contents:b,systemInstruction:v}=function(e){var t;let r=[],a=[],n=!0;for(let{role:o,content:s}of e)switch(o){case"system":if(!n)throw new u.A_({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:s});break;case"user":{n=!1;let e=[];for(let r of s)switch(r.type){case"text":e.push({text:r.text});break;case"image":if(r.image instanceof URL)throw new u.A_({functionality:"Image URLs in user messages"});e.push({inlineData:{mimeType:null!=(t=r.mimeType)?t:"image/jpeg",data:(0,c.k0)(r.image)}});break;case"file":if(r.data instanceof URL)throw new u.A_({functionality:"File URLs in user messages"});e.push({inlineData:{mimeType:r.mimeType,data:r.data}})}a.push({role:"user",parts:e});break}case"assistant":n=!1,a.push({role:"model",parts:s.map(e=>{switch(e.type){case"text":return 0===e.text.length?void 0:{text:e.text};case"tool-call":return{functionCall:{name:e.toolName,args:e.args}}}}).filter(e=>void 0!==e)});break;case"tool":n=!1,a.push({role:"user",parts:s.map(e=>({functionResponse:{name:e.toolName,response:e.result}}))});break;default:throw Error(`Unsupported role: ${o}`)}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:a}}(t);switch(f){case"regular":return{args:{generationConfig:y,contents:b,systemInstruction:v,safetySettings:this.settings.safetySettings,...function(e){var t;let r=(null==(t=e.tools)?void 0:t.length)?e.tools:void 0;if(null==r)return{tools:void 0,toolConfig:void 0};let a={functionDeclarations:r.map(e=>{var t;return{name:e.name,description:null!=(t=e.description)?t:"",parameters:d(e.parameters)}})},n=e.toolChoice;if(null==n)return{tools:a,toolConfig:void 0};let o=n.type;switch(o){case"auto":return{tools:a,toolConfig:{functionCallingConfig:{mode:"AUTO"}}};case"none":return{tools:a,toolConfig:{functionCallingConfig:{mode:"NONE"}}};case"required":return{tools:a,toolConfig:{functionCallingConfig:{mode:"ANY"}}};case"tool":return{tools:a,toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[n.toolName]}}};default:throw Error(`Unsupported tool choice type: ${o}`)}}(e),cachedContent:this.settings.cachedContent},warnings:g};case"object-json":return{args:{generationConfig:{...y,responseMimeType:"application/json",responseSchema:null!=e.schema&&this.supportsObjectGeneration?d(e.schema):void 0},contents:b,systemInstruction:v,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:g};case"object-tool":return{args:{generationConfig:y,contents:b,tools:{functionDeclarations:[{name:e.tool.name,description:null!=(h=e.tool.description)?h:"",parameters:d(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:g};default:throw Error(`Unsupported type: ${f}`)}}async doGenerate(e){var t,r;let{args:a,warnings:n}=await this.getArgs(e),{responseHeaders:o,value:s}=await (0,c.A8)({url:`${this.config.baseURL}/${p(this.modelId)}:generateContent`,headers:(0,c.NF)(this.config.headers(),e.headers),body:a,failedResponseHandler:h,successfulResponseHandler:(0,c.tc)(x),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:i,...l}=a,u=s.candidates[0],d=y({parts:u.content.parts,generateId:this.config.generateId}),m=s.usageMetadata;return{text:b(u.content.parts),toolCalls:d,finishReason:f({finishReason:u.finishReason,hasToolCalls:null!=d&&d.length>0}),usage:{promptTokens:null!=(t=null==m?void 0:m.promptTokenCount)?t:NaN,completionTokens:null!=(r=null==m?void 0:m.candidatesTokenCount)?r:NaN},rawCall:{rawPrompt:i,rawSettings:l},rawResponse:{headers:o},warnings:n}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),{responseHeaders:a,value:n}=await (0,c.A8)({url:`${this.config.baseURL}/${p(this.modelId)}:streamGenerateContent?alt=sse`,headers:(0,c.NF)(this.config.headers(),e.headers),body:t,failedResponseHandler:h,successfulResponseHandler:(0,c.cP)(R),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...s}=t,i="unknown",l={promptTokens:Number.NaN,completionTokens:Number.NaN},u=this.config.generateId,d=!1;return{stream:n.pipeThrough(new TransformStream({transform(e,t){var r,a;if(!e.success){t.enqueue({type:"error",error:e.error});return}let n=e.value,o=n.candidates[0];(null==o?void 0:o.finishReason)!=null&&(i=f({finishReason:o.finishReason,hasToolCalls:d}));let s=n.usageMetadata;null!=s&&(l={promptTokens:null!=(r=s.promptTokenCount)?r:NaN,completionTokens:null!=(a=s.candidatesTokenCount)?a:NaN});let c=o.content;if(null==c)return;let p=b(c.parts);null!=p&&t.enqueue({type:"text-delta",textDelta:p});let m=y({parts:c.parts,generateId:u});if(null!=m)for(let e of m)t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,argsTextDelta:e.args}),t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,args:e.args}),d=!0},flush(e){e.enqueue({type:"finish",finishReason:i,usage:l})}})),rawCall:{rawPrompt:o,rawSettings:s},rawResponse:{headers:a},warnings:r}}};function y({parts:e,generateId:t}){let r=e.filter(e=>"functionCall"in e);return 0===r.length?void 0:r.map(e=>({toolCallType:"function",toolCallId:t(),toolName:e.functionCall.name,args:JSON.stringify(e.functionCall.args)}))}function b(e){let t=e.filter(e=>"text"in e);return 0===t.length?void 0:t.map(e=>e.text).join("")}var v=l.Ry({role:l.Z_(),parts:l.IX(l.G0([l.Ry({text:l.Z_()}),l.Ry({functionCall:l.Ry({name:l.Z_(),args:l._4()})})]))}),x=l.Ry({candidates:l.IX(l.Ry({content:v,finishReason:l.Z_().optional()})),usageMetadata:l.Ry({promptTokenCount:l.Rx(),candidatesTokenCount:l.Rx().nullish(),totalTokenCount:l.Rx()}).optional()}),R=l.Ry({candidates:l.IX(l.Ry({content:v.optional(),finishReason:l.Z_().optional()})),usageMetadata:l.Ry({promptTokenCount:l.Rx(),candidatesTokenCount:l.Rx().nullish(),totalTokenCount:l.Rx()}).optional()}),w=class{constructor(e,t,r){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:r}){if(e.length>this.maxEmbeddingsPerCall)throw new u.ON({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:a,value:n}=await (0,c.A8)({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:(0,c.NF)(this.config.headers(),t),body:{requests:e.map(e=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:e}]},outputDimensionality:this.settings.outputDimensionality}))},failedResponseHandler:h,successfulResponseHandler:(0,c.tc)(C),abortSignal:r,fetch:this.config.fetch});return{embeddings:n.embeddings.map(e=>e.values),usage:void 0,rawResponse:{headers:a}}}},C=l.Ry({embeddings:l.IX(l.Ry({values:l.IX(l.Rx())}))}),I=function(e={}){var t,r;let a=null!=(r=(0,c.QT)(null!=(t=e.baseURL)?t:e.baseUrl))?r:"https://generativelanguage.googleapis.com/v1beta",n=()=>({"x-goog-api-key":(0,c.pd)({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),o=(t,r={})=>{var o;return new g(t,r,{provider:"google.generative-ai",baseURL:a,headers:n,generateId:null!=(o=e.generateId)?o:c.Ox,fetch:e.fetch})},s=(t,r={})=>new w(t,r,{provider:"google.generative-ai",baseURL:a,headers:n,fetch:e.fetch}),i=function(e,t){if(new.target)throw Error("The Google Generative AI model function cannot be called with the new keyword.");return o(e,t)};return i.languageModel=o,i.chat=o,i.generativeAI=o,i.embedding=s,i.textEmbedding=s,i.textEmbeddingModel=s,i}();let N={},_=(0,i.bm)({model:I("gemini-1.5-pro-002"),middleware:N}),A=(0,i.bm)({model:I("gemini-1.5-flash-002"),middleware:N});async function Z({flightNumber:e,date:t}){let{object:r}=await (0,i.jA)({model:A,prompt:`Flight status for flight number ${e} on ${t}`,schema:l.Ry({flightNumber:l.Z_().describe("Flight number, e.g., BA123, AA31"),departure:l.Ry({cityName:l.Z_().describe("Name of the departure city"),airportCode:l.Z_().describe("IATA code of the departure airport"),airportName:l.Z_().describe("Full name of the departure airport"),timestamp:l.Z_().describe("ISO 8601 departure date and time"),terminal:l.Z_().describe("Departure terminal"),gate:l.Z_().describe("Departure gate")}),arrival:l.Ry({cityName:l.Z_().describe("Name of the arrival city"),airportCode:l.Z_().describe("IATA code of the arrival airport"),airportName:l.Z_().describe("Full name of the arrival airport"),timestamp:l.Z_().describe("ISO 8601 arrival date and time"),terminal:l.Z_().describe("Arrival terminal"),gate:l.Z_().describe("Arrival gate")}),totalDistanceInMiles:l.Rx().describe("Total flight distance in miles")})});return r}async function S({origin:e,destination:t}){let{object:r}=await (0,i.jA)({model:A,prompt:`Generate search results for flights from ${e} to ${t}, limit to 4 results`,output:"array",schema:l.Ry({id:l.Z_().describe("Unique identifier for the flight, like BA123, AA31, etc."),departure:l.Ry({cityName:l.Z_().describe("Name of the departure city"),airportCode:l.Z_().describe("IATA code of the departure airport"),timestamp:l.Z_().describe("ISO 8601 departure date and time")}),arrival:l.Ry({cityName:l.Z_().describe("Name of the arrival city"),airportCode:l.Z_().describe("IATA code of the arrival airport"),timestamp:l.Z_().describe("ISO 8601 arrival date and time")}),airlines:l.IX(l.Z_().describe("Airline names, e.g., American Airlines, Emirates")),priceInUSD:l.Rx().describe("Flight price in US dollars"),numberOfStops:l.Rx().describe("Number of stops during the flight")})});return{flights:r}}async function T({flightNumber:e}){let{object:t}=await (0,i.jA)({model:A,prompt:`Simulate available seats for flight number ${e}, 6 seats on each row and 5 rows in total, adjust pricing based on location of seat`,output:"array",schema:l.IX(l.Ry({seatNumber:l.Z_().describe("Seat identifier, e.g., 12A, 15C"),priceInUSD:l.Rx().describe("Seat price in US dollars, less than $99"),isAvailable:l.O7().describe("Whether the seat is available for booking")}))});return{seats:t}}async function U(e){let{object:t}=await (0,i.jA)({model:A,prompt:`Generate price for the following reservation 

 ${JSON.stringify(e,null,2)}`,schema:l.Ry({totalPriceInUSD:l.Rx().describe("Total reservation price in US dollars")})});return t}var O=r(89228),k=r(21080),D=r(72724),q=r(87930);async function j(e){let{id:t,messages:r}=await e.json(),a=await (0,O.I8)();if(!a)return new Response("Unauthorized",{status:401});let n=(0,i.BZ)(r).filter(e=>e.content.length>0),o=r.filter(e=>"user"===e.role).pop()?.content||"",s="";if(a.user?.id&&o)try{let e=(0,D.vd)(),t=await e.retrieveDocuments(o,a.user.id,{maxDocs:3,threshold:.7});t.length>0&&(s=t.map((e,t)=>`[Source ${t+1}: ${e.source}]
${e.content}`).join("\n\n"))}catch(e){console.error("RAG retrieval error:",e)}let c=s?`You are an intelligent AI assistant with access to the user's uploaded documents. 
       
       DOCUMENT CONTEXT:
       ${s}
       
       INSTRUCTIONS:
       - Use the document context above to answer questions when relevant
       - Always cite your sources when using information from documents (e.g., "According to [Source 1: filename.pdf]...")
       - If the user's question cannot be answered from the provided documents, clearly state this
       - Be conversational and helpful
       - Keep responses concise but informative
       - If no relevant documents are found, answer based on your general knowledge but mention that you don't have specific documents to reference
       - Today's date is ${new Date().toLocaleDateString()}
       
       You can also help with general tasks like flight booking using the available tools when appropriate.`:`You are an intelligent AI assistant.
       
       INSTRUCTIONS:
       - Be helpful and conversational
       - Answer questions based on your knowledge
       - Keep responses concise but informative
       - You can help with various tasks including flight booking using available tools
       - Today's date is ${new Date().toLocaleDateString()}
       - If users want to upload documents for context, let them know they can use the document upload feature`;return(await (0,i.kP)({model:_,system:c,messages:n,tools:{searchDocuments:{description:"Search through the user's uploaded documents for specific information",parameters:l.Ry({query:l.Z_().describe("The search query to find relevant information in documents"),maxResults:l.Rx().optional().describe("Maximum number of results to return (default: 3)")}),execute:async({query:e,maxResults:t=3})=>{if(!a.user?.id)return{error:"User not authenticated"};try{let r=(0,D.vd)(),n=await r.retrieveDocuments(e,a.user.id,{maxDocs:t,threshold:.6});if(0===n.length)return{message:"No relevant documents found for this query.",results:[],query:e};return{query:e,results:n.map((e,t)=>({source:e.source,content:e.content.substring(0,500)+(e.content.length>500?"...":""),relevanceScore:e.relevance_score,index:t+1})),totalFound:n.length}}catch(t){return console.error("Document search error:",t),{error:"Failed to search documents",query:e}}}},getWeather:{description:"Get the current weather at a location",parameters:l.Ry({latitude:l.Rx().describe("Latitude coordinate"),longitude:l.Rx().describe("Longitude coordinate")}),execute:async({latitude:e,longitude:t})=>{let r=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${e}&longitude=${t}&current=temperature_2m&hourly=temperature_2m&daily=sunrise,sunset&timezone=auto`);return await r.json()}},displayFlightStatus:{description:"Display the status of a flight",parameters:l.Ry({flightNumber:l.Z_().describe("Flight number"),date:l.Z_().describe("Date of the flight")}),execute:async({flightNumber:e,date:t})=>await Z({flightNumber:e,date:t})},searchFlights:{description:"Search for flights based on the given parameters",parameters:l.Ry({origin:l.Z_().describe("Origin airport or city"),destination:l.Z_().describe("Destination airport or city")}),execute:async({origin:e,destination:t})=>await S({origin:e,destination:t})},selectSeats:{description:"Select seats for a flight",parameters:l.Ry({flightNumber:l.Z_().describe("Flight number")}),execute:async({flightNumber:e})=>await T({flightNumber:e})},createReservation:{description:"Display pending reservation details",parameters:l.Ry({seats:l.Z_().array().describe("Array of selected seat numbers"),flightNumber:l.Z_().describe("Flight number"),departure:l.Ry({cityName:l.Z_().describe("Name of the departure city"),airportCode:l.Z_().describe("Code of the departure airport"),timestamp:l.Z_().describe("ISO 8601 date of departure"),gate:l.Z_().describe("Departure gate"),terminal:l.Z_().describe("Departure terminal")}),arrival:l.Ry({cityName:l.Z_().describe("Name of the arrival city"),airportCode:l.Z_().describe("Code of the arrival airport"),timestamp:l.Z_().describe("ISO 8601 date of arrival"),gate:l.Z_().describe("Arrival gate"),terminal:l.Z_().describe("Arrival terminal")}),passengerName:l.Z_().describe("Name of the passenger")}),execute:async e=>{let{totalPriceInUSD:t}=await U(e),r=await (0,O.I8)(),a=(0,q.DO)();return r&&r.user&&r.user.id?(await (0,k.Rr)({id:a,userId:r.user.id,details:{...e,totalPriceInUSD:t}}),{id:a,...e,totalPriceInUSD:t}):{error:"User is not signed in to perform this action!"}}},authorizePayment:{description:"User will enter credentials to authorize payment, wait for user to repond when they are done",parameters:l.Ry({reservationId:l.Z_().describe("Unique identifier for the reservation")}),execute:async({reservationId:e})=>({reservationId:e})},verifyPayment:{description:"Verify payment status",parameters:l.Ry({reservationId:l.Z_().describe("Unique identifier for the reservation")}),execute:async({reservationId:e})=>(await (0,k.Qv)({id:e})).hasCompletedPayment?{hasCompletedPayment:!0}:{hasCompletedPayment:!1}},displayBoardingPass:{description:"Display a boarding pass",parameters:l.Ry({reservationId:l.Z_().describe("Unique identifier for the reservation"),passengerName:l.Z_().describe("Name of the passenger, in title case"),flightNumber:l.Z_().describe("Flight number"),seat:l.Z_().describe("Seat number"),departure:l.Ry({cityName:l.Z_().describe("Name of the departure city"),airportCode:l.Z_().describe("Code of the departure airport"),airportName:l.Z_().describe("Name of the departure airport"),timestamp:l.Z_().describe("ISO 8601 date of departure"),terminal:l.Z_().describe("Departure terminal"),gate:l.Z_().describe("Departure gate")}),arrival:l.Ry({cityName:l.Z_().describe("Name of the arrival city"),airportCode:l.Z_().describe("Code of the arrival airport"),airportName:l.Z_().describe("Name of the arrival airport"),timestamp:l.Z_().describe("ISO 8601 date of arrival"),terminal:l.Z_().describe("Arrival terminal"),gate:l.Z_().describe("Arrival gate")})}),execute:async e=>e}},onFinish:async({responseMessages:e})=>{if(a.user&&a.user.id)try{await (0,k.l_)({id:t,messages:[...n,...e],userId:a.user.id})}catch(e){console.error("Failed to save chat")}},experimental_telemetry:{isEnabled:!0,functionId:"stream-text"}})).toDataStreamResponse({})}async function E(e){let{searchParams:t}=new URL(e.url),r=t.get("id");if(!r)return new Response("Not Found",{status:404});let a=await (0,O.I8)();if(!a||!a.user)return new Response("Unauthorized",{status:401});try{if((await (0,k.T)({id:r})).userId!==a.user.id)return new Response("Unauthorized",{status:401});return await (0,k.LT)({id:r}),new Response("Chat deleted",{status:200})}catch(e){return new Response("An error occurred while processing your request",{status:500})}}let F=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/(chat)/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/(chat)/api/chat/route"},resolvedPagePath:"/Users/duy/Documents/build/rag/app/(chat)/api/chat/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:$,staticGenerationAsyncStorage:P,prerenderAsyncStorage:G,serverHooks:M}=F;function L(){return(0,s.patchFetch)({staticGenerationAsyncStorage:P,requestAsyncStorage:$,prerenderAsyncStorage:G})}},87930:(e,t,r)=>{r.d(t,{DO:()=>i,Ty:()=>l,cn:()=>s});var a=r(30006),n=r(57119),o=r(80106);function s(...e){return(0,o.m6)((0,n.W)(e))}function i(){if("undefined"!=typeof crypto&&crypto.randomUUID)return crypto.randomUUID();if("undefined"!=typeof crypto&&crypto.getRandomValues){let e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=15&e[6]|64,e[8]=63&e[8]|128;let t=Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("");return[t.slice(0,8),t.slice(8,12),t.slice(12,16),t.slice(16,20),t.slice(20,32)].join("-")}return console.warn("Using Math.random() for UUID generation - not cryptographically secure"),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function l(e){return e.reduce((e,t)=>{if("tool"===t.role)return function({toolMessage:e,messages:t}){return t.map(t=>t.toolInvocations?{...t,toolInvocations:t.toolInvocations.map(t=>{let r=e.content.find(e=>e.toolCallId===t.toolCallId);return r?{...t,state:"result",result:r.result}:t})}:t)}({toolMessage:t,messages:e});let r="",n=[];if("string"==typeof t.content)r=t.content;else if(Array.isArray(t.content))for(let e of t.content)"text"===e.type?r+=e.text:"tool-call"===e.type&&n.push({state:"call",toolCallId:e.toolCallId,toolName:e.toolName,args:e.args});return e.push({id:(0,a.Ox)(),role:t.role,content:r,toolInvocations:n}),e},[])}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[615,503,80,536,400,463],()=>r(53405));module.exports=a})();