(()=>{var e={};e.id=566,e.ids=[566],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},32307:e=>{"use strict";e.exports=require("next/dist/server/app-render/prerender-async-storage.external.js")},6113:e=>{"use strict";e.exports=require("crypto")},57147:e=>{"use strict";e.exports=require("fs")},41808:e=>{"use strict";e.exports=require("net")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},47261:e=>{"use strict";e.exports=require("node:util")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},4074:e=>{"use strict";e.exports=require("perf_hooks")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},23675:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>o});var a=r(40568),s=r(64006),i=r(90213),n=r.n(i),l=r(78787),d={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);r.d(t,d);let o=["",{children:["(auth)",{children:["register",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,32753)),"/Users/duy/Documents/build/rag/app/(auth)/register/page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,28706,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,3701)),"/Users/duy/Documents/build/rag/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,28706,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/duy/Documents/build/rag/app/(auth)/register/page.tsx"],c={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/(auth)/register/page",pathname:"/register",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},33046:(e,t,r)=>{let a={af0ed5d6a42a8cb127adf89b01a60f17535f05bb:()=>Promise.resolve().then(r.bind(r,16561)).then(e=>e.$$ACTION_0),e55076a0838d2fdeb16914021c9f1a95d37ee6d8:()=>Promise.resolve().then(r.bind(r,16561)).then(e=>e.register),f75ac3cb2feb73926a47277e1249c6044f85687c:()=>Promise.resolve().then(r.bind(r,16561)).then(e=>e.$$ACTION_1)};async function s(e,...t){return(await a[e]()).apply(null,t)}e.exports={af0ed5d6a42a8cb127adf89b01a60f17535f05bb:s.bind(null,"af0ed5d6a42a8cb127adf89b01a60f17535f05bb"),e55076a0838d2fdeb16914021c9f1a95d37ee6d8:s.bind(null,"e55076a0838d2fdeb16914021c9f1a95d37ee6d8"),f75ac3cb2feb73926a47277e1249c6044f85687c:s.bind(null,"f75ac3cb2feb73926a47277e1249c6044f85687c")}},55794:(e,t,r)=>{Promise.resolve().then(r.bind(r,49328))},3344:(e,t,r)=>{"use strict";r.d(t,{x:()=>i,z:()=>s}),r(65888);var a=r(8412),s=(0,a.$)("e55076a0838d2fdeb16914021c9f1a95d37ee6d8"),i=(0,a.$)("b587edaa61e984276ca60f8d9ca9de4ea6cccbc9")},49328:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(20149),s=r(85723),i=r(4619),n=r(63606),l=r(70968),d=r(76348),o=r(54933),u=r(3344);function c(){let e=(0,i.useRouter)(),[t,r]=(0,n.useState)(""),[c,m]=(0,n.useActionState)(u.z,{status:"idle"});return(0,n.useEffect)(()=>{"user_exists"===c.status?l.A.error("Account already exists"):"failed"===c.status?l.A.error("Failed to create account"):"invalid_data"===c.status?l.A.error("Failed validating your submission!"):"success"===c.status&&(l.A.success("Account created successfully"),e.refresh())},[c,e]),(0,a.jsx)("div",{className:"flex h-screen w-screen items-center justify-center bg-background",children:(0,a.jsxs)("div",{className:"w-full max-w-md overflow-hidden rounded-2xl gap-12 flex flex-col",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 px-4 text-center sm:px-16",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold dark:text-zinc-50",children:"Sign Up"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Create an account with your email and password"})]}),(0,a.jsxs)(d.B,{action:e=>{r(e.get("email")),m(e)},defaultEmail:t,children:[(0,a.jsx)(o.M,{children:"Sign Up"}),(0,a.jsxs)("p",{className:"text-center text-sm text-gray-600 mt-4 dark:text-zinc-400",children:["Already have an account? ",(0,a.jsx)(s.default,{href:"/login",className:"font-semibold text-gray-800 hover:underline dark:text-zinc-200",children:"Sign in"})," instead."]})]})]})})}},76348:(e,t,r)=>{"use strict";r.d(t,{B:()=>u});var a=r(20149),s=r(63606),i=r(24219);let n=s.forwardRef(({className:e,type:t,...r},s)=>(0,a.jsx)("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));n.displayName="Input";var l=r(18486);let d=(0,r(9285).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(l.f,{ref:r,className:(0,i.cn)(d(),e),...t}));function u({action:e,children:t,defaultEmail:r=""}){return(0,a.jsxs)("form",{action:e,className:"flex flex-col gap-4 px-4 sm:px-16",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(o,{htmlFor:"email",className:"text-zinc-600 font-normal dark:text-zinc-400",children:"Email Address"}),(0,a.jsx)(n,{id:"email",name:"email",className:"bg-muted text-md md:text-sm border-none",type:"email",placeholder:"user@acme.com",autoComplete:"email",required:!0,defaultValue:r}),(0,a.jsx)(o,{htmlFor:"password",className:"text-zinc-600 font-normal dark:text-zinc-400",children:"Password"}),(0,a.jsx)(n,{id:"password",name:"password",className:"bg-muted text-md md:text-sm border-none",type:"password",required:!0})]}),t]})}o.displayName=l.f.displayName},54933:(e,t,r)=>{"use strict";r.d(t,{M:()=>l});var a=r(20149),s=r(30028),i=r(73286),n=r(56598);function l({children:e}){let{pending:t}=(0,s.useFormStatus)();return(0,a.jsxs)(n.z,{type:t?"button":"submit","aria-disabled":t,className:"relative text-white",children:[e,t&&(0,a.jsx)("span",{className:"animate-spin absolute right-4",children:(0,a.jsx)(i.c0,{})}),(0,a.jsx)("span",{"aria-live":"polite",className:"sr-only",role:"status",children:t?"Loading":"Submit form"})]})}},16561:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$ACTION_0:()=>E,$$ACTION_1:()=>M,login:()=>C,register:()=>I});var a=r(81674);r(47770);var s=r(15278),i=r(11937),n=r(33816),l=r(88581),d=r(89519),o=r(90075),u=r(76399),c=r(67462),m=r(49720),f=r(249),p=r(39873),x=r(10020),h=r(98727),b=r(34223),g=r(14649),y=r(78824);let w=(0,u.af)("User",{id:(0,c.Vj)("id").primaryKey().notNull().defaultRandom(),email:(0,m.L7)("email",{length:64}).notNull(),password:(0,m.L7)("password",{length:128})},e=>({uniqueEmail:(0,f.Tw)().on(e.email)}));(0,u.af)("Chat",{id:(0,c.Vj)("id").primaryKey().notNull().defaultRandom(),createdAt:(0,p.AB)("createdAt").notNull(),messages:(0,x.AV)("messages").notNull(),userId:(0,c.Vj)("userId").notNull().references(()=>w.id)}),(0,u.af)("Reservation",{id:(0,c.Vj)("id").primaryKey().notNull().defaultRandom(),createdAt:(0,p.AB)("createdAt").notNull(),details:(0,x.AV)("details").notNull(),hasCompletedPayment:(0,h.O7)("hasCompletedPayment").notNull().default(!1),userId:(0,c.Vj)("userId").notNull().references(()=>w.id)}),(0,u.af)("Document",{id:(0,c.Vj)("id").primaryKey().notNull().defaultRandom(),filename:(0,m.L7)("filename",{length:255}).notNull(),originalName:(0,m.L7)("originalName",{length:255}).notNull(),fileType:(0,m.L7)("fileType",{length:50}).notNull(),fileSize:(0,b._L)("fileSize").notNull(),content:(0,g.fL)("content").notNull(),status:(0,m.L7)("status",{length:20}).notNull().default("indexed"),chunkCount:(0,b._L)("chunkCount").notNull().default(0),createdAt:(0,p.AB)("createdAt").notNull().default((0,y.i6)`CURRENT_TIMESTAMP`),updatedAt:(0,p.AB)("updatedAt").notNull().default((0,y.i6)`CURRENT_TIMESTAMP`),userId:(0,c.Vj)("userId").notNull().references(()=>w.id,{onDelete:"cascade"})});let v=process.env.POSTGRES_URL?(()=>{let e=new URL(process.env.POSTGRES_URL);return e.searchParams.set("sslmode","require"),e.toString()})():"postgres://dummy:dummy@localhost:5432/dummy",N=(0,o.Z)(v,{max:1,transform:process.env.POSTGRES_URL?o.Z.camel:void 0}),j=(0,d.t)(N);async function _(e){try{return await j.select().from(w).where((0,l.eq)(w.email,e))}catch(e){throw console.error("Failed to get user from database"),e}}async function A(e,t){let r=(0,n.W0)(10),a=(0,n.St)(t,r);try{return await j.insert(w).values({email:e,password:a})}catch(e){throw console.error("Failed to create user in database"),e}}var P=r(18245),q=r(64911);let{handlers:{GET:R,POST:S},auth:k,signIn:T,signOut:z}=(0,P.ZP)({pages:{signIn:"/login",newUser:"/"},providers:[],callbacks:{authorized({auth:e,request:{nextUrl:t}}){let r=!!e?.user,a=t.pathname.startsWith("/"),s=t.pathname.startsWith("/register"),i=t.pathname.startsWith("/login");return r&&(i||s)?Response.redirect(new URL("/",t)):!!s||!!i||(a?!!r:!r||Response.redirect(new URL("/",t)))}},providers:[(0,q.Z)({credentials:{},async authorize({email:e,password:t}){if(!e||!t)return null;let r=await _(e);if(0===r.length)return null;let a=r[0];return a.password&&await (0,n.qu)(t,a.password)?a:null}})],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e),session:async({session:e,token:t})=>(e.user&&(e.user.id=t.id),e)}});var L=r(47937);let U=s.Ry({email:s.Z_().email(),password:s.Z_().min(6)}),C=(0,a.j)("af0ed5d6a42a8cb127adf89b01a60f17535f05bb",E);async function E(e,t){try{let e=U.parse({email:t.get("email"),password:t.get("password")});return await T("credentials",{email:e.email,password:e.password,redirect:!1}),{status:"success"}}catch(e){if(e instanceof i.jm)return{status:"invalid_data"};return{status:"failed"}}}let I=(0,a.j)("f75ac3cb2feb73926a47277e1249c6044f85687c",M);async function M(e,t){try{let e=U.parse({email:t.get("email"),password:t.get("password")}),[r]=await _(e.email);if(r)return{status:"user_exists"};return await A(e.email,e.password),await T("credentials",{email:e.email,password:e.password,redirect:!1}),{status:"success"}}catch(e){if(e instanceof i.jm)return{status:"invalid_data"};return{status:"failed"}}}(0,L.h)([C,I]),(0,a.j)("b587edaa61e984276ca60f8d9ca9de4ea6cccbc9",C),(0,a.j)("e55076a0838d2fdeb16914021c9f1a95d37ee6d8",I)},32753:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>e});var s=r(3571);let e=(await (0,s.createProxy)(String.raw`/Users/duy/Documents/build/rag/app/(auth)/register/page.tsx`)).default;a()}catch(e){a(e)}},1)},57481:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(78099);let s=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[615,503,80,6,237,99,281,514],()=>r(23675));module.exports=a})();