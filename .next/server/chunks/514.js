exports.id=514,exports.ids=[514],exports.modules={42035:(e,t,s)=>{let a={"079af391027f515e6b475721fe8bdb2e8ebc1912":()=>Promise.resolve().then(s.bind(s,46918)).then(e=>e.$$ACTION_0)};async function r(e,...t){return(await a[e]()).apply(null,t)}e.exports={"079af391027f515e6b475721fe8bdb2e8ebc1912":r.bind(null,"079af391027f515e6b475721fe8bdb2e8ebc1912")}},98760:(e,t,s)=>{Promise.resolve().then(s.bind(s,12871)),Promise.resolve().then(s.bind(s,58464)),Promise.resolve().then(s.bind(s,58929)),Promise.resolve().then(s.bind(s,7622)),Promise.resolve().then(s.bind(s,7482)),Promise.resolve().then(s.t.bind(s,62704,23)),Promise.resolve().then(s.t.bind(s,73510,23)),Promise.resolve().then(s.bind(s,70968))},22552:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,52144,23)),Promise.resolve().then(s.t.bind(s,63582,23)),Promise.resolve().then(s.t.bind(s,9587,23)),Promise.resolve().then(s.t.bind(s,65329,23)),Promise.resolve().then(s.t.bind(s,50599,23))},12871:(e,t,s)=>{"use strict";s.d(t,{History:()=>I});var a=s(20149),r=s(20048),n=s(98638),i=s.n(n),l=s(85723),o=s(4619),d=s(63606),c=s(70968),m=s(15834),u=s(24219),x=s(73286),h=s(78280),p=s(56598);let f=h.fC;h.xz;let g=h.h_,j=d.forwardRef(({className:e,...t},s)=>(0,a.jsx)(h.aV,{className:(0,u.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));j.displayName=h.aV.displayName;let v=d.forwardRef(({className:e,...t},s)=>(0,a.jsxs)(g,{children:[(0,a.jsx)(j,{}),(0,a.jsx)(h.VY,{ref:s,className:(0,u.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));v.displayName=h.VY.displayName;let y=({className:e,...t})=>(0,a.jsx)("div",{className:(0,u.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});y.displayName="AlertDialogHeader";let b=({className:e,...t})=>(0,a.jsx)("div",{className:(0,u.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});b.displayName="AlertDialogFooter";let N=d.forwardRef(({className:e,...t},s)=>(0,a.jsx)(h.Dx,{ref:s,className:(0,u.cn)("text-lg font-semibold",e),...t}));N.displayName=h.Dx.displayName;let w=d.forwardRef(({className:e,...t},s)=>(0,a.jsx)(h.dk,{ref:s,className:(0,u.cn)("text-sm text-muted-foreground",e),...t}));w.displayName=h.dk.displayName;let C=d.forwardRef(({className:e,...t},s)=>(0,a.jsx)(h.aU,{ref:s,className:(0,u.cn)((0,p.d)(),e),...t}));C.displayName=h.aU.displayName;let k=d.forwardRef(({className:e,...t},s)=>(0,a.jsx)(h.$j,{ref:s,className:(0,u.cn)((0,p.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));k.displayName=h.$j.displayName;var D=s(7482),L=s(21459),R=s(9285),H=s(54521);let M=L.fC;L.xz,L.x8;let V=L.h_,S=d.forwardRef(({className:e,...t},s)=>(0,a.jsx)(L.aV,{className:(0,u.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));S.displayName=L.aV.displayName;let z=(0,R.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),A=d.forwardRef(({side:e="right",className:t,children:s,...r},n)=>(0,a.jsxs)(V,{children:[(0,a.jsx)(S,{}),(0,a.jsxs)(L.VY,{ref:n,className:(0,u.cn)(z({side:e}),t),...r,children:[s,(0,a.jsxs)(L.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(H.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));A.displayName=L.VY.displayName;let E=({className:e,...t})=>(0,a.jsx)("div",{className:(0,u.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});E.displayName="SheetHeader";let T=d.forwardRef(({className:e,...t},s)=>(0,a.jsx)(L.Dx,{ref:s,className:(0,u.cn)("text-lg font-semibold text-foreground",e),...t}));T.displayName=L.Dx.displayName;let P=d.forwardRef(({className:e,...t},s)=>(0,a.jsx)(L.dk,{ref:s,className:(0,u.cn)("text-sm text-muted-foreground",e),...t}));P.displayName=L.dk.displayName;let I=({user:e})=>{let{id:t}=(0,o.useParams)(),s=(0,o.usePathname)(),[n,h]=(0,d.useState)(!1),{data:g,isLoading:j,mutate:L}=(0,m.ZP)(e?"/api/history":null,u._i,{fallbackData:[]});(0,d.useEffect)(()=>{L()},[s,L]);let[R,H]=(0,d.useState)(null),[V,S]=(0,d.useState)(!1),z=async()=>{let e=fetch(`/api/chat?id=${R}`,{method:"DELETE"});c.A.promise(e,{loading:"Deleting chat...",success:()=>(L(e=>e?e.filter(e=>e.id!==R):e),"Chat deleted successfully"),error:"Failed to delete chat"}),S(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.z,{variant:"outline",className:"p-1.5 h-fit",onClick:()=>{h(!0)},children:(0,a.jsx)(x.Oq,{})}),(0,a.jsx)(M,{open:n,onOpenChange:e=>{h(e)},children:(0,a.jsxs)(A,{side:"left",className:"p-3 w-80 bg-muted",children:[(0,a.jsx)(E,{children:(0,a.jsxs)(r.fC,{children:[(0,a.jsx)(T,{className:"text-left",children:"History"}),(0,a.jsxs)(P,{className:"text-left",children:[void 0===g?"loading":g.length," chats"]})]})}),(0,a.jsx)("div",{className:"text-sm flex flex-row items-center justify-between",children:(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,a.jsx)("div",{className:"dark:text-zinc-300",children:"History"}),(0,a.jsxs)("div",{className:"dark:text-zinc-400 text-zinc-500",children:[void 0===g?"loading":g.length," chats"]})]})}),(0,a.jsxs)("div",{className:"mt-10 flex flex-col",children:[e&&(0,a.jsx)(p.z,{className:"font-normal text-sm flex flex-row justify-between text-white",asChild:!0,children:(0,a.jsxs)(l.default,{href:"/",children:[(0,a.jsx)("div",{children:"Start a new chat"}),(0,a.jsx)(x.gL,{size:14})]})}),(0,a.jsxs)("div",{className:"flex flex-col overflow-y-scroll p-1 h-[calc(100dvh-124px)]",children:[e?null:(0,a.jsxs)("div",{className:"text-zinc-500 h-dvh w-full flex flex-row justify-center items-center text-sm gap-2",children:[(0,a.jsx)(x.sz,{}),(0,a.jsx)("div",{children:"Login to save and revisit previous chats!"})]}),!j&&g?.length===0&&e?(0,a.jsxs)("div",{className:"text-zinc-500 h-dvh w-full flex flex-row justify-center items-center text-sm gap-2",children:[(0,a.jsx)(x.sz,{}),(0,a.jsx)("div",{children:"No chats found"})]}):null,j&&e?(0,a.jsx)("div",{className:"flex flex-col",children:[44,32,28,52].map(e=>(0,a.jsx)("div",{className:"p-2 my-[2px]",children:(0,a.jsx)("div",{className:"h-[20px] rounded-md bg-zinc-200 dark:bg-zinc-600 animate-pulse",style:{width:`${4*e}px`}})},e))}):null,g&&g.map(e=>(0,a.jsxs)("div",{className:i()("flex flex-row items-center gap-6 hover:bg-zinc-200 dark:hover:bg-zinc-700 rounded-md pr-2",{"bg-zinc-200 dark:bg-zinc-700":e.id===t}),children:[(0,a.jsx)(p.z,{variant:"ghost",className:i()("hover:bg-zinc-200 dark:hover:bg-zinc-700 justify-between p-0 text-sm font-normal flex flex-row items-center gap-2 pr-2 w-full transition-none"),asChild:!0,children:(0,a.jsx)(l.default,{href:`/chat/${e.id}`,className:"text-ellipsis overflow-hidden text-left py-2 pl-2 rounded-lg outline-zinc-900",children:(0,u.lG)(e)})}),(0,a.jsxs)(D.DropdownMenu,{modal:!0,children:[(0,a.jsx)(D.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(p.z,{className:"p-0 h-fit font-normal text-zinc-500 transition-none hover:bg-zinc-200 dark:hover:bg-zinc-700",variant:"ghost",children:(0,a.jsx)(x.xh,{})})}),(0,a.jsx)(D.DropdownMenuContent,{side:"left",className:"z-[60]",children:(0,a.jsx)(D.DropdownMenuItem,{asChild:!0,children:(0,a.jsxs)(p.z,{className:"flex flex-row gap-2 items-center justify-start w-full h-fit font-normal p-1.5 rounded-sm",variant:"ghost",onClick:()=>{H(e.id),S(!0)},children:[(0,a.jsx)(x.XH,{}),(0,a.jsx)("div",{children:"Delete"})]})})})]})]},e.id))]})]})]})}),(0,a.jsx)(f,{open:V,onOpenChange:S,children:(0,a.jsxs)(v,{children:[(0,a.jsxs)(y,{children:[(0,a.jsx)(N,{children:"Are you absolutely sure?"}),(0,a.jsx)(w,{children:"This action cannot be undone. This will permanently delete your chat and remove it from our servers."})]}),(0,a.jsxs)(b,{children:[(0,a.jsx)(k,{children:"Cancel"}),(0,a.jsx)(C,{onClick:z,children:"Continue"})]})]})})]})}},73286:(e,t,s)=>{"use strict";s.d(t,{Hf:()=>h,Kn:()=>i,Oq:()=>c,P$:()=>j,XH:()=>u,Z8:()=>r,aA:()=>l,c0:()=>o,fU:()=>v,gL:()=>m,og:()=>f,rG:()=>d,sz:()=>x,tB:()=>n,wN:()=>p,xh:()=>g});var a=s(20149);let r=()=>(0,a.jsx)("svg",{height:"16",strokeLinejoin:"round",viewBox:"0 0 16 16",width:"16",style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.75 2.79933C9.19835 2.53997 9.5 2.05521 9.5 1.5C9.5 0.671573 8.82843 0 8 0C7.17157 0 6.5 0.671573 6.5 1.5C6.5 2.05521 6.80165 2.53997 7.25 2.79933V5H7C4.027 5 1.55904 7.16229 1.08296 10H0V13H1V14.5V16H2.5H13.5H15V14.5V13H16V10H14.917C14.441 7.16229 11.973 5 9 5H8.75V2.79933ZM7 6.5C4.51472 6.5 2.5 8.51472 2.5 11V14.5H13.5V11C13.5 8.51472 11.4853 6.5 9 6.5H7ZM7.25 11.25C7.25 12.2165 6.4665 13 5.5 13C4.5335 13 3.75 12.2165 3.75 11.25C3.75 10.2835 4.5335 9.5 5.5 9.5C6.4665 9.5 7.25 10.2835 7.25 11.25ZM10.5 13C11.4665 13 12.25 12.2165 12.25 11.25C12.25 10.2835 11.4665 9.5 10.5 9.5C9.5335 9.5 8.75 10.2835 8.75 11.25C8.75 12.2165 9.5335 13 10.5 13Z",fill:"currentColor"})}),n=()=>(0,a.jsx)("svg",{"data-testid":"geist-icon",height:"16",strokeLinejoin:"round",viewBox:"0 0 16 16",width:"16",style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.75 0C5.95507 0 4.5 1.45507 4.5 3.25V3.75C4.5 5.54493 5.95507 7 7.75 7H8.25C10.0449 7 11.5 5.54493 11.5 3.75V3.25C11.5 1.45507 10.0449 0 8.25 0H7.75ZM6 3.25C6 2.2835 6.7835 1.5 7.75 1.5H8.25C9.2165 1.5 10 2.2835 10 3.25V3.75C10 4.7165 9.2165 5.5 8.25 5.5H7.75C6.7835 5.5 6 4.7165 6 3.75V3.25ZM2.5 14.5V13.1709C3.31958 11.5377 4.99308 10.5 6.82945 10.5H9.17055C11.0069 10.5 12.6804 11.5377 13.5 13.1709V14.5H2.5ZM6.82945 9C4.35483 9 2.10604 10.4388 1.06903 12.6857L1 12.8353V13V15.25V16H1.75H14.25H15V15.25V13V12.8353L14.931 12.6857C13.894 10.4388 11.6452 9 9.17055 9H6.82945Z",fill:"currentColor"})}),i=({size:e=17})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 1L16 15H0L8 1Z",fill:"currentColor"})}),l=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 13.5V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V13.5C1.5 14.8807 2.61929 16 4 16H12C13.3807 16 14.5 14.8807 14.5 13.5ZM13 13.5V6.5H9.5H8V5V1.5H3V13.5C3 14.0523 3.44772 14.5 4 14.5H12C12.5523 14.5 13 14.0523 13 13.5ZM9.5 5V2.12132L12.3787 5H9.5ZM5.13 5.00062H4.505V6.25062H5.13H6H6.625V5.00062H6H5.13ZM4.505 8H5.13H11H11.625V9.25H11H5.13H4.505V8ZM5.13 11H4.505V12.25H5.13H11H11.625V11H11H5.13Z",fill:"currentColor"})}),o=({size:e=16})=>(0,a.jsxs)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:[(0,a.jsxs)("g",{clipPath:"url(#clip0_2393_1490)",children:[(0,a.jsx)("path",{d:"M8 0V4",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.5",d:"M8 16V12",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.9",d:"M3.29773 1.52783L5.64887 4.7639",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.1",d:"M12.7023 1.52783L10.3511 4.7639",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.4",d:"M12.7023 14.472L10.3511 11.236",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.6",d:"M3.29773 14.472L5.64887 11.236",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.2",d:"M15.6085 5.52783L11.8043 6.7639",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.7",d:"M0.391602 10.472L4.19583 9.23598",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.3",d:"M15.6085 10.4722L11.8043 9.2361",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{opacity:"0.8",d:"M0.391602 5.52783L4.19583 6.7639",stroke:"currentColor",strokeWidth:"1.5"})]}),(0,a.jsx)("defs",{children:(0,a.jsx)("clipPath",{id:"clip0_2393_1490",children:(0,a.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]}),d=({size:e=16})=>(0,a.jsx)("svg",{"data-testid":"geist-icon",height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.5 4.875C1.5 3.01104 3.01104 1.5 4.875 1.5C6.20018 1.5 7.34838 2.26364 7.901 3.37829C8.1902 3.96162 8.79547 4.5 9.60112 4.5H12.25C13.4926 4.5 14.5 5.50736 14.5 6.75C14.5 7.42688 14.202 8.03329 13.7276 8.44689L13.1622 8.93972L14.1479 10.0704L14.7133 9.57758C15.5006 8.89123 16 7.8785 16 6.75C16 4.67893 14.3211 3 12.25 3H9.60112C9.51183 3 9.35322 2.93049 9.2449 2.71201C8.44888 1.1064 6.79184 0 4.875 0C2.18261 0 0 2.18261 0 4.875V6.40385C0 7.69502 0.598275 8.84699 1.52982 9.59656L2.11415 10.0667L3.0545 8.89808L2.47018 8.42791C1.87727 7.95083 1.5 7.22166 1.5 6.40385V4.875ZM7.29289 7.39645C7.68342 7.00592 8.31658 7.00592 8.70711 7.39645L11.7803 10.4697L12.3107 11L11.25 12.0607L10.7197 11.5303L8.75 9.56066V15.25V16H7.25V15.25V9.56066L5.28033 11.5303L4.75 12.0607L3.68934 11L4.21967 10.4697L7.29289 7.39645Z",fill:"currentColor"})}),c=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 2H1.75H14.25H15V3.5H14.25H1.75H1V2ZM1 12.5H1.75H14.25H15V14H14.25H1.75H1V12.5ZM1.75 7.25H1V8.75H1.75H14.25H15V7.25H14.25H1.75Z",fill:"currentColor"})}),m=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.75 0.189331L12.2803 0.719661L15.2803 3.71966L15.8107 4.24999L15.2803 4.78032L5.15901 14.9016C4.45575 15.6049 3.50192 16 2.50736 16H0.75H0V15.25V13.4926C0 12.4981 0.395088 11.5442 1.09835 10.841L11.2197 0.719661L11.75 0.189331ZM11.75 2.31065L9.81066 4.24999L11.75 6.18933L13.6893 4.24999L11.75 2.31065ZM2.15901 11.9016L8.75 5.31065L10.6893 7.24999L4.09835 13.841C3.67639 14.2629 3.1041 14.5 2.50736 14.5H1.5V13.4926C1.5 12.8959 1.73705 12.3236 2.15901 11.9016ZM9 16H16V14.5H9V16Z",fill:"currentColor"})}),u=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.75 2.75C6.75 2.05964 7.30964 1.5 8 1.5C8.69036 1.5 9.25 2.05964 9.25 2.75V3H6.75V2.75ZM5.25 3V2.75C5.25 1.23122 6.48122 0 8 0C9.51878 0 10.75 1.23122 10.75 2.75V3H12.9201H14.25H15V4.5H14.25H13.8846L13.1776 13.6917C13.0774 14.9942 11.9913 16 10.6849 16H5.31508C4.00874 16 2.92263 14.9942 2.82244 13.6917L2.11538 4.5H1.75H1V3H1.75H3.07988H5.25ZM4.31802 13.5767L3.61982 4.5H12.3802L11.682 13.5767C11.6419 14.0977 11.2075 14.5 10.6849 14.5H5.31508C4.79254 14.5 4.3581 14.0977 4.31802 13.5767Z",fill:"currentColor"})}),x=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8ZM6.25002 7H7.00002H7.75C8.30229 7 8.75 7.44772 8.75 8V11.5V12.25H7.25V11.5V8.5H7.00002H6.25002V7ZM8 6C8.55229 6 9 5.55228 9 5C9 4.44772 8.55229 4 8 4C7.44772 4 7 4.44772 7 5C7 5.55228 7.44772 6 8 6Z",fill:"currentColor"})}),h=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.70711 1.39644C8.31659 1.00592 7.68342 1.00592 7.2929 1.39644L2.21968 6.46966L1.68935 6.99999L2.75001 8.06065L3.28034 7.53032L7.25001 3.56065V14.25V15H8.75001V14.25V3.56065L12.7197 7.53032L13.25 8.06065L14.3107 6.99999L13.7803 6.46966L8.70711 1.39644Z",fill:"currentColor"})}),p=({size:e=16})=>(0,a.jsx)("svg",{height:e,viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 3H13V13H3V3Z",fill:"currentColor"})}),f=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},className:"-rotate-45",children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.8591 1.70735C10.3257 1.70735 9.81417 1.91925 9.437 2.29643L3.19455 8.53886C2.56246 9.17095 2.20735 10.0282 2.20735 10.9222C2.20735 11.8161 2.56246 12.6734 3.19455 13.3055C3.82665 13.9376 4.68395 14.2927 5.57786 14.2927C6.47178 14.2927 7.32908 13.9376 7.96117 13.3055L14.2036 7.06304L14.7038 6.56287L15.7041 7.56321L15.204 8.06337L8.96151 14.3058C8.06411 15.2032 6.84698 15.7074 5.57786 15.7074C4.30875 15.7074 3.09162 15.2032 2.19422 14.3058C1.29682 13.4084 0.792664 12.1913 0.792664 10.9222C0.792664 9.65305 1.29682 8.43592 2.19422 7.53852L8.43666 1.29609C9.07914 0.653606 9.95054 0.292664 10.8591 0.292664C11.7678 0.292664 12.6392 0.653606 13.2816 1.29609C13.9241 1.93857 14.2851 2.80997 14.2851 3.71857C14.2851 4.62718 13.9241 5.49858 13.2816 6.14106L13.2814 6.14133L7.0324 12.3835C7.03231 12.3836 7.03222 12.3837 7.03213 12.3838C6.64459 12.7712 6.11905 12.9888 5.57107 12.9888C5.02297 12.9888 4.49731 12.7711 4.10974 12.3835C3.72217 11.9959 3.50444 11.4703 3.50444 10.9222C3.50444 10.3741 3.72217 9.8484 4.10974 9.46084L4.11004 9.46054L9.877 3.70039L10.3775 3.20051L11.3772 4.20144L10.8767 4.70131L5.11008 10.4612C5.11005 10.4612 5.11003 10.4612 5.11 10.4613C4.98779 10.5835 4.91913 10.7493 4.91913 10.9222C4.91913 11.0951 4.98782 11.2609 5.11008 11.3832C5.23234 11.5054 5.39817 11.5741 5.57107 11.5741C5.74398 11.5741 5.9098 11.5054 6.03206 11.3832L6.03233 11.3829L12.2813 5.14072C12.2814 5.14063 12.2815 5.14054 12.2816 5.14045C12.6586 4.7633 12.8704 4.25185 12.8704 3.71857C12.8704 3.18516 12.6585 2.6736 12.2813 2.29643C11.9041 1.91925 11.3926 1.70735 10.8591 1.70735Z",fill:"currentColor"})}),g=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 8C4 8.82843 3.32843 9.5 2.5 9.5C1.67157 9.5 1 8.82843 1 8C1 7.17157 1.67157 6.5 2.5 6.5C3.32843 6.5 4 7.17157 4 8ZM9.5 8C9.5 8.82843 8.82843 9.5 8 9.5C7.17157 9.5 6.5 8.82843 6.5 8C6.5 7.17157 7.17157 6.5 8 6.5C8.82843 6.5 9.5 7.17157 9.5 8ZM13.5 9.5C14.3284 9.5 15 8.82843 15 8C15 7.17157 14.3284 6.5 13.5 6.5C12.6716 6.5 12 7.17157 12 8C12 8.82843 12.6716 9.5 13.5 9.5Z",fill:"currentColor"})}),j=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.8914 10.4028L2.98327 10.6318C3.22909 11.2445 3.5 12.1045 3.5 13C3.5 13.3588 3.4564 13.7131 3.38773 14.0495C3.69637 13.9446 4.01409 13.8159 4.32918 13.6584C4.87888 13.3835 5.33961 13.0611 5.70994 12.7521L6.22471 12.3226L6.88809 12.4196C7.24851 12.4724 7.61994 12.5 8 12.5C11.7843 12.5 14.5 9.85569 14.5 7C14.5 4.14431 11.7843 1.5 8 1.5C4.21574 1.5 1.5 4.14431 1.5 7C1.5 8.18175 1.94229 9.29322 2.73103 10.2153L2.8914 10.4028ZM2.8135 15.7653C1.76096 16 1 16 1 16C1 16 1.43322 15.3097 1.72937 14.4367C1.88317 13.9834 2 13.4808 2 13C2 12.3826 1.80733 11.7292 1.59114 11.1903C0.591845 10.0221 0 8.57152 0 7C0 3.13401 3.58172 0 8 0C12.4183 0 16 3.13401 16 7C16 10.866 12.4183 14 8 14C7.54721 14 7.10321 13.9671 6.67094 13.9038C6.22579 14.2753 5.66881 14.6656 5 15C4.23366 15.3832 3.46733 15.6195 2.8135 15.7653Z",fill:"currentColor"})}),v=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8ZM11.5303 6.53033L12.0607 6L11 4.93934L10.4697 5.46967L6.5 9.43934L5.53033 8.46967L5 7.93934L3.93934 9L4.46967 9.53033L5.96967 11.0303C6.26256 11.3232 6.73744 11.3232 7.03033 11.0303L11.5303 6.53033Z",fill:"currentColor"})})},58464:(e,t,s)=>{"use strict";s.d(t,{NavbarClient:()=>w});var a=s(20149),r=s(63606),n=s(73286),i=s(56598),l=s(70968),o=s(15834),d=s(24318),c=s(26166),m=s(47357);let u={auth:{icon:"\uD83D\uDD10",color:"border-red-500 bg-red-50",titleColor:"text-red-800",textColor:"text-red-700"},database:{icon:"\uD83D\uDDC4️",color:"border-orange-500 bg-orange-50",titleColor:"text-orange-800",textColor:"text-orange-700"},upload:{icon:"\uD83D\uDCC1",color:"border-blue-500 bg-blue-50",titleColor:"text-blue-800",textColor:"text-blue-700"},network:{icon:"\uD83C\uDF10",color:"border-purple-500 bg-purple-50",titleColor:"text-purple-800",textColor:"text-purple-700"},validation:{icon:"⚠️",color:"border-yellow-500 bg-yellow-50",titleColor:"text-yellow-800",textColor:"text-yellow-700"},system:{icon:"⚙️",color:"border-gray-500 bg-gray-50",titleColor:"text-gray-800",textColor:"text-gray-700"}};function x({error:e,onRetry:t,onReport:s,onDismiss:n,isVisible:l}){let[o,d]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),p=u[e.type],f=async()=>{let t={title:e.title,message:e.message,type:e.type,details:e.details,technicalInfo:e.technicalInfo,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href};try{await navigator.clipboard.writeText(JSON.stringify(t,null,2)),h(!0),setTimeout(()=>h(!1),2e3)}catch(e){console.error("Failed to copy error details:",e)}};return(0,a.jsx)(c.M,{children:l&&(0,a.jsxs)(m.E.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:`border-2 rounded-lg p-4 mb-4 ${p.color}`,children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("span",{className:"text-2xl",children:p.icon}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:`font-semibold text-lg ${p.titleColor}`,children:e.title}),(0,a.jsx)("p",{className:`mt-1 ${p.textColor}`,children:e.message})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.details&&(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>d(!o),className:"text-xs",children:o?"Hide Details":"Show Details"}),n&&(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:n,className:"text-xs",children:"✕"})]})]}),e.suggestions&&e.suggestions.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:`font-medium text-sm ${p.titleColor} mb-2`,children:"\uD83D\uDCA1 What you can do:"}),(0,a.jsx)("ul",{className:`text-sm ${p.textColor} space-y-1`,children:e.suggestions.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-xs mt-0.5",children:"•"}),(0,a.jsx)("span",{children:e})]},t))})]}),(0,a.jsx)(c.M,{children:o&&e.details&&(0,a.jsxs)(m.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"mt-4 border-t pt-4",children:[(0,a.jsx)("h4",{className:`font-medium text-sm ${p.titleColor} mb-3`,children:"\uD83D\uDD0D Technical Details:"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[e.details.code&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Error Code:"}),(0,a.jsx)("div",{className:"font-mono bg-white/50 px-2 py-1 rounded mt-1",children:e.details.code})]}),e.details.timestamp&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Timestamp:"}),(0,a.jsx)("div",{className:"font-mono bg-white/50 px-2 py-1 rounded mt-1",children:e.details.timestamp})]}),e.details.userId&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"User ID:"}),(0,a.jsx)("div",{className:"font-mono bg-white/50 px-2 py-1 rounded mt-1",children:e.details.userId})]}),e.details.endpoint&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Endpoint:"}),(0,a.jsx)("div",{className:"font-mono bg-white/50 px-2 py-1 rounded mt-1",children:e.details.endpoint})]})]}),e.technicalInfo&&e.technicalInfo.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h5",{className:`font-medium text-xs ${p.titleColor} mb-2`,children:"System Information:"}),(0,a.jsx)("div",{className:"space-y-2",children:e.technicalInfo.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.label,":"]}),(0,a.jsx)("span",{className:"font-mono text-right",children:e.value})]},t))})]}),e.details.stack&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h5",{className:`font-medium text-xs ${p.titleColor} mb-2`,children:"Stack Trace:"}),(0,a.jsx)("pre",{className:"text-xs bg-white/50 p-2 rounded overflow-x-auto max-h-32",children:e.details.stack})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[e.canRetry&&t&&(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:t,className:"text-xs",children:"\uD83D\uDD04 Retry"}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:f,className:"text-xs",children:x?"✅ Copied":"\uD83D\uDCCB Copy Details"}),e.canReport&&s&&(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:s,className:"text-xs",children:"\uD83D\uDCE4 Report Issue"})]})]})})}function h({title:e,icon:t,status:s,duration:r,isProcessing:n=!1,children:i}){return(0,a.jsxs)(m.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`border rounded-lg p-4 ${(()=>{switch(s){case"pending":default:return"border-muted-foreground/20";case"processing":return"border-blue-500/50";case"completed":return"border-green-500/50";case"error":return"border-red-500/50"}})()} ${(()=>{switch(s){case"pending":default:return"bg-muted/10";case"processing":return"bg-blue-50/50 dark:bg-blue-950/20";case"completed":return"bg-green-50/50 dark:bg-green-950/20";case"error":return"bg-red-50/50 dark:bg-red-950/20"}})()}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-xl",children:t}),(0,a.jsx)("h3",{className:"font-semibold",children:e}),n&&(0,a.jsx)(m.E.div,{className:"w-2 h-2 bg-blue-500 rounded-full",animate:{scale:[1,1.2,1]},transition:{duration:1,repeat:1/0}})]}),r&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["⚡ ",r,"ms"]})]}),(0,a.jsx)("div",{className:"pl-8",children:i})]})}function p({step:e,config:t}){return(0,a.jsx)(h,{title:"Query Embedding",icon:(()=>{switch(e.status){case"pending":default:return"⏳";case"processing":return"\uD83E\uDDE0";case"completed":return"✅";case"error":return"❌"}})(),status:e.status,duration:e.duration,isProcessing:"processing"===e.status,children:(0,a.jsxs)("div",{className:"space-y-3",children:[e.data?.originalQuery&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Original Query"}),(0,a.jsxs)("div",{className:"bg-muted/30 rounded p-2 text-sm font-mono",children:['"',e.data.originalQuery,'"']})]}),e.data.processedQuery&&e.data.processedQuery!==e.data.originalQuery&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Processed Query"}),(0,a.jsxs)("div",{className:"bg-muted/30 rounded p-2 text-sm font-mono",children:['"',e.data.processedQuery,'"']})]})]}),e.data?.embeddingModel&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Model:"}),(0,a.jsx)("span",{className:"font-medium",children:e.data.embeddingModel})]}),e.data.embeddingDimensions&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Dimensions:"}),(0,a.jsx)("span",{className:"font-medium",children:e.data.embeddingDimensions})]})]}),t.showEmbeddingVectors&&e.data?.embeddingPreview&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Embedding Vector (preview)"}),(0,a.jsxs)("div",{className:"bg-muted/30 rounded p-3",children:[(0,a.jsxs)("div",{className:"font-mono text-xs break-all text-muted-foreground",children:["[",e.data.embeddingPreview,"...]"]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Showing first 8 dimensions of ",e.data.embeddingDimensions," total"]})]})]}),"processing"===e.status&&(0,a.jsxs)(m.E.div,{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400",initial:{opacity:0},animate:{opacity:1},children:[(0,a.jsx)(m.E.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full"}),(0,a.jsx)("span",{children:"Generating embedding vector..."})]}),"error"===e.status&&e.error&&(0,a.jsx)("div",{className:"bg-red-50 dark:bg-red-950/50 border border-red-200 dark:border-red-800 rounded p-3",children:(0,a.jsxs)("div",{className:"text-sm text-red-600 dark:text-red-400",children:[(0,a.jsx)("strong",{children:"Error:"})," ",e.error]})})]})})}function f({step:e,config:t}){return(0,a.jsx)(h,{title:"Document Retrieval",icon:(()=>{switch(e.status){case"pending":default:return"⏳";case"processing":return"\uD83D\uDD0D";case"completed":return"\uD83D\uDCDA";case"error":return"❌"}})(),status:e.status,duration:e.duration,isProcessing:"processing"===e.status,children:(0,a.jsxs)("div",{className:"space-y-3",children:[e.data?.searchParams&&(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Top K:"}),(0,a.jsx)("span",{className:"font-medium",children:e.data.searchParams.topK})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Threshold:"}),(0,a.jsx)("span",{className:"font-medium",children:e.data.searchParams.threshold})]}),e.data.namespace&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Namespace:"}),(0,a.jsx)("span",{className:"font-medium font-mono text-xs",children:e.data.namespace})]}),void 0!==e.data.totalResults&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Found:"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.data.totalResults," docs"]})]})]}),e.data?.documents&&e.data.documents.length>0&&(0,a.jsxs)("div",{className:"bg-muted/30 rounded p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Retrieved Documents"}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.data.filteredResults||e.data.documents.length," relevant documents"]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[e.data.documents.slice(0,t.maxDocumentsDisplay).map((e,s)=>(0,a.jsxs)(m.E.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1*s},className:"bg-background rounded p-2 border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("span",{className:"text-sm font-medium truncate flex-1",children:["[",s+1,"] ",e.source]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-2",children:[(0,a.jsxs)("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded",children:[(100*e.relevanceScore).toFixed(1),"%"]}),e.metadata.page&&(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["p.",e.metadata.page]})]})]}),t.showDocumentContent&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:e.snippet})]},e.id)),e.data.documents.length>t.maxDocumentsDisplay&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground text-center py-1",children:["... and ",e.data.documents.length-t.maxDocumentsDisplay," more documents"]})]})]}),"processing"===e.status&&(0,a.jsxs)(m.E.div,{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400",initial:{opacity:0},animate:{opacity:1},children:[(0,a.jsx)(m.E.div,{animate:{scale:[1,1.2,1]},transition:{duration:1.5,repeat:1/0},className:"w-4 h-4 bg-current rounded-full opacity-60"}),(0,a.jsx)("span",{children:"Searching vector database..."})]}),"completed"===e.status&&(!e.data?.documents||0===e.data.documents.length)&&(0,a.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-950/50 border border-yellow-200 dark:border-yellow-800 rounded p-3",children:(0,a.jsxs)("div",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:[(0,a.jsx)("strong",{children:"No documents found"})," - No relevant documents matched the similarity threshold"]})}),"error"===e.status&&e.error&&(0,a.jsx)("div",{className:"bg-red-50 dark:bg-red-950/50 border border-red-200 dark:border-red-800 rounded p-3",children:(0,a.jsxs)("div",{className:"text-sm text-red-600 dark:text-red-400",children:[(0,a.jsx)("strong",{children:"Retrieval Error:"})," ",e.error]})})]})})}function g({step:e,config:t}){return(0,a.jsx)(h,{title:"Context Assembly",icon:(()=>{switch(e.status){case"pending":default:return"⏳";case"processing":return"\uD83D\uDD17";case"completed":return"\uD83D\uDCDD";case"error":return"❌"}})(),status:e.status,duration:e.duration,isProcessing:"processing"===e.status,children:(0,a.jsxs)("div",{className:"space-y-3",children:[e.data?.assemblyStrategy&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Strategy:"}),(0,a.jsx)("span",{className:"font-medium",children:e.data.assemblyStrategy})]}),e.data&&(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[e.data.selectedDocuments&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Documents:"}),(0,a.jsx)("span",{className:"font-medium",children:e.data.selectedDocuments.length})]}),e.data.contextLength&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Context Size:"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.data.contextLength.toLocaleString()," chars"]})]}),e.data.contextLength&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Est. Tokens:"}),(0,a.jsxs)("span",{className:"font-medium",children:["~",Math.ceil(e.data.contextLength/4).toLocaleString()]})]})]}),e.data?.selectedDocuments&&e.data.selectedDocuments.length>0&&(0,a.jsxs)("div",{className:"bg-muted/30 rounded p-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Selected for Context"}),(0,a.jsx)("div",{className:"space-y-2",children:e.data.selectedDocuments.map((e,t)=>(0,a.jsxs)(m.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.05*t},className:"flex items-center justify-between bg-background rounded p-2 border",children:[(0,a.jsxs)("span",{className:"text-sm truncate flex-1",children:["[",t+1,"] ",e.source]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-2",children:[(0,a.jsxs)("span",{className:"text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 px-2 py-1 rounded",children:[e.content.length," chars"]}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[(100*e.relevanceScore).toFixed(1),"%"]})]})]},e.id))})]}),t.showDocumentContent&&e.data?.contextPreview&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Context Preview"}),(0,a.jsx)("div",{className:"bg-muted/30 rounded p-3 max-h-32 overflow-y-auto",children:(0,a.jsxs)("div",{className:"font-mono text-xs text-muted-foreground whitespace-pre-wrap",children:[e.data.contextPreview,e.data.contextPreview.length<(e.data.contextLength||0)&&(0,a.jsxs)("span",{className:"text-primary",children:["\\n\\n... (",((e.data.contextLength||0)-e.data.contextPreview.length).toLocaleString()," more characters)"]})]})})]}),"processing"===e.status&&(0,a.jsxs)(m.E.div,{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400",initial:{opacity:0},animate:{opacity:1},children:[(0,a.jsx)(m.E.div,{className:"flex gap-1",initial:{opacity:.3},animate:{opacity:1},children:[0,1,2].map(e=>(0,a.jsx)(m.E.div,{className:"w-2 h-2 bg-current rounded-full",animate:{scale:[1,1.3,1]},transition:{duration:1.2,repeat:1/0,delay:.2*e}},e))}),(0,a.jsx)("span",{children:"Assembling context from selected documents..."})]}),"error"===e.status&&e.error&&(0,a.jsx)("div",{className:"bg-red-50 dark:bg-red-950/50 border border-red-200 dark:border-red-800 rounded p-3",children:(0,a.jsxs)("div",{className:"text-sm text-red-600 dark:text-red-400",children:[(0,a.jsx)("strong",{children:"Assembly Error:"})," ",e.error]})})]})})}function j({step:e,config:t}){return(0,a.jsx)(h,{title:"Response Generation",icon:(()=>{switch(e.status){case"pending":default:return"⏳";case"processing":return"✨";case"completed":return"\uD83C\uDFAF";case"error":return"❌"}})(),status:e.status,duration:e.duration,isProcessing:"processing"===e.status,children:(0,a.jsxs)("div",{className:"space-y-3",children:[e.data?.model&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Model:"}),(0,a.jsx)("span",{className:"font-medium",children:e.data.model})]}),t.showDetailedMetrics&&e.data&&(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.data.promptLength&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Prompt:"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.data.promptLength.toLocaleString()," chars"]})]}),e.data.contextLength&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Context:"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.data.contextLength.toLocaleString()," chars"]})]}),e.data.responseLength&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Response:"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.data.responseLength.toLocaleString()," chars"]})]}),e.data.tokenUsage?.total&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Tokens:"}),(0,a.jsx)("span",{className:"font-medium",children:e.data.tokenUsage.total.toLocaleString()})]})]}),t.showDetailedMetrics&&e.data?.tokenUsage&&(0,a.jsxs)("div",{className:"bg-muted/30 rounded p-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Token Usage Breakdown"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Prompt"}),(0,a.jsx)("div",{className:"font-medium text-blue-600 dark:text-blue-400",children:e.data.tokenUsage.prompt?.toLocaleString()||"N/A"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Completion"}),(0,a.jsx)("div",{className:"font-medium text-green-600 dark:text-green-400",children:e.data.tokenUsage.completion?.toLocaleString()||"N/A"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Total"}),(0,a.jsx)("div",{className:"font-medium",children:e.data.tokenUsage.total?.toLocaleString()||"N/A"})]})]})]}),t.showDocumentContent&&e.data?.prompt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium mb-2",children:"System Prompt Preview"}),(0,a.jsx)("div",{className:"bg-muted/30 rounded p-3 max-h-32 overflow-y-auto",children:(0,a.jsx)("div",{className:"font-mono text-xs text-muted-foreground whitespace-pre-wrap",children:e.data.prompt.length>500?`${e.data.prompt.substring(0,500)}...

(${(e.data.prompt.length-500).toLocaleString()} more characters)`:e.data.prompt})})]}),"processing"===e.status&&(0,a.jsxs)(m.E.div,{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400",initial:{opacity:0},animate:{opacity:1},children:[(0,a.jsx)(m.E.div,{className:"flex gap-1",children:["✨","\uD83E\uDD16","\uD83D\uDCAD"].map((e,t)=>(0,a.jsx)(m.E.span,{animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0,delay:.3*t},children:e},t))}),(0,a.jsx)("span",{children:"Generating AI response with context..."})]}),"completed"===e.status&&(0,a.jsxs)(m.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-green-50 dark:bg-green-950/50 border border-green-200 dark:border-green-800 rounded p-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-700 dark:text-green-300",children:[(0,a.jsx)("span",{children:"\uD83C\uDF89"}),(0,a.jsx)("strong",{children:"Response Generated Successfully!"})]}),(0,a.jsx)("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:"The AI has processed your query with the retrieved context and generated a comprehensive response."})]}),"error"===e.status&&e.error&&(0,a.jsx)("div",{className:"bg-red-50 dark:bg-red-950/50 border border-red-200 dark:border-red-800 rounded p-3",children:(0,a.jsxs)("div",{className:"text-sm text-red-600 dark:text-red-400",children:[(0,a.jsx)("strong",{children:"Generation Error:"})," ",e.error]})})]})})}function v({session:e}){let t=[{label:"Query Embedding",value:e.steps.queryEmbedding.duration||0,unit:"ms",color:"text-blue-600 dark:text-blue-400"},{label:"Document Retrieval",value:e.steps.documentRetrieval.duration||0,unit:"ms",color:"text-purple-600 dark:text-purple-400"},{label:"Context Assembly",value:e.steps.contextAssembly.duration||0,unit:"ms",color:"text-orange-600 dark:text-orange-400"},{label:"Response Generation",value:e.steps.responseGeneration.duration||0,unit:"ms",color:"text-green-600 dark:text-green-400"}],s=Object.values(e.steps).some(e=>"error"===e.status)?"error":Object.values(e.steps).every(e=>"completed"===e.status)?"completed":Object.values(e.steps).some(e=>"processing"===e.status)?"processing":"pending",r=Object.values(e.steps).filter(e=>"completed"===e.status).length;return(0,a.jsxs)(m.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-muted/30 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"font-medium text-sm",children:"Pipeline Metrics"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[r,"/4 steps completed"]}),"completed"===s&&(0,a.jsx)("span",{className:"text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 px-2 py-1 rounded",children:"✅ Complete"}),"processing"===s&&(0,a.jsx)("span",{className:"text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 px-2 py-1 rounded",children:"⏳ Processing"}),"error"===s&&(0,a.jsx)("span",{className:"text-xs bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 px-2 py-1 rounded",children:"❌ Error"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.map((e,t)=>(0,a.jsxs)(m.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1*t},className:"text-center",children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:e.label}),(0,a.jsx)("div",{className:`font-medium ${e.color}`,children:e.value>0?`${e.value}${e.unit}`:"-"})]},e.label))}),e.totalDuration&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-muted-foreground/20",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Total Pipeline Duration:"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.totalDuration,"ms"]})]})}),(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-1",children:[(0,a.jsx)("span",{children:"Progress"}),(0,a.jsxs)("span",{children:[Math.round(r/4*100),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-muted-foreground/20 rounded-full h-2",children:(0,a.jsx)(m.E.div,{className:"bg-primary rounded-full h-2",initial:{width:0},animate:{width:`${r/4*100}%`},transition:{duration:.5}})})]})]})}function y({isVisible:e,onClose:t}){let[s,n]=(0,r.useState)(null),[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)({showEmbeddingVectors:!0,showDetailedMetrics:!0,showDocumentContent:!0,maxDocumentsDisplay:5,updateInterval:100,enableRealTimeUpdates:!0});(0,r.useEffect)(()=>{let t;if(!e||!d.enableRealTimeUpdates)return;let s=null,a=()=>{try{(s=new EventSource("/api/rag-demonstration/events")).onopen=()=>{console.log("\uD83D\uDD17 RAG Demonstration SSE connected"),o(!0)},s.onmessage=e=>{try{let t=JSON.parse(e.data);if("connection"===t.type||"heartbeat"===t.type)return;u(t)}catch(e){console.error("Error parsing SSE event:",e)}},s.onerror=e=>{console.log("\uD83D\uDD0C RAG Demonstration SSE disconnected"),o(!1),s?.close(),t=setTimeout(a,3e3)}}catch(e){console.error("Failed to create SSE connection:",e),o(!1),t=setTimeout(a,5e3)}};return a(),()=>{s&&s.close(),t&&clearTimeout(t)}},[e,d.enableRealTimeUpdates]);let u=(0,r.useCallback)(e=>{switch(e.type){case"session_start":n(e.data);break;case"step_start":case"step_progress":case"step_complete":n(t=>{if(!t||t.sessionId!==e.sessionId)return t;let s={...t},a=e.stepId;return s.steps[a]&&(s.steps[a]={...s.steps[a],...e.data}),s});break;case"session_complete":n(t=>t&&t.sessionId===e.sessionId?{...t,status:"completed",totalDuration:e.data.totalDuration,citations:e.data.citations}:t);break;case"error":n(t=>t&&t.sessionId===e.sessionId?{...t,status:"error"}:t)}},[]);return e?(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",children:(0,a.jsxs)(m.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-background rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"RAG Pipeline Demonstration"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:`w-2 h-2 rounded-full ${l?"bg-green-500":"bg-red-500"}`}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:l?"Live":"Disconnected"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s&&(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>{n(null)},children:"\uD83D\uDDD1️ Clear"}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:t,children:"✕"})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto",children:s?(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-muted/50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Current Query"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:["Session: ",s.sessionId.slice(-8)]}),s.totalDuration&&(0,a.jsxs)("span",{children:["• Total: ",s.totalDuration,"ms"]})]})]}),(0,a.jsxs)("p",{className:"text-sm bg-background rounded p-2 font-mono",children:['"',s.query,'"']})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(p,{step:s.steps.queryEmbedding,config:d}),(0,a.jsx)(f,{step:s.steps.documentRetrieval,config:d}),(0,a.jsx)(g,{step:s.steps.contextAssembly,config:d}),(0,a.jsx)(j,{step:s.steps.responseGeneration,config:d})]}),s.citations&&s.citations.length>0&&(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-3",children:"\uD83D\uDCCE Citations & Sources"}),(0,a.jsx)("div",{className:"grid gap-3",children:s.citations.slice(0,d.maxDocumentsDisplay).map((e,t)=>(0,a.jsxs)("div",{className:"bg-muted/30 rounded p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"font-medium text-sm",children:["[",t+1,"] ",e.source]}),(0,a.jsxs)("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded",children:[(100*e.relevanceScore).toFixed(1),"% match"]})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.snippet})]},e.id))})]})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD0D"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"RAG Pipeline Ready"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4 max-w-md",children:"Start a conversation in the chat to see the real-time RAG pipeline in action. Watch how your queries are embedded, documents are retrieved, and responses are generated."}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,a.jsx)("div",{className:"font-medium",children:"\uD83E\uDDE0 Query Embedding"}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Vector generation"})]}),(0,a.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,a.jsx)("div",{className:"font-medium",children:"\uD83D\uDCDA Document Retrieval"}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Similarity search"})]}),(0,a.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,a.jsx)("div",{className:"font-medium",children:"\uD83D\uDD17 Context Assembly"}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"Information fusion"})]}),(0,a.jsxs)("div",{className:"p-3 border rounded-lg",children:[(0,a.jsx)("div",{className:"font-medium",children:"✨ Response Generation"}),(0,a.jsx)("div",{className:"text-muted-foreground",children:"AI completion"})]})]})]})}),s&&(0,a.jsx)("div",{className:"border-t p-4",children:(0,a.jsx)(v,{session:s})})]})}):null}let b=e=>fetch(e).then(e=>e.json());function N({isOpen:e,onClose:t}){let[s,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),[f,g]=(0,r.useState)(!1),j=(0,r.useRef)(null),{data:v,error:N,isLoading:w}=(0,o.ZP)(e?"/api/documents/upload":null,b,{refreshInterval:0}),C=v?.documents||[],k=async e=>{if(!e||0===e.length)return;let t=e[0];if(!["text/plain","text/markdown","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(t.type)){l.A.error("Unsupported file type. Please upload TXT, MD, PDF, or DOCX files.");return}if(t.size>10485760){l.A.error("File size must be less than 10MB.");return}c(!0);try{let e=new FormData;e.append("file",t);let s=await fetch("/api/documents/upload",{method:"POST",body:e}),a=await s.json();if(!s.ok){a.errorDetails?p(a.errorDetails):l.A.error(a.error||"Upload failed");return}a.success?(l.A.success(`${t.name} uploaded and indexed successfully!`),p(null),(0,d.j)("/api/documents/upload"),j.current&&(j.current.value="")):l.A.error("Upload failed")}catch(e){console.error("Upload error:",e),p({type:"network",title:"Network Error",message:"Failed to connect to the server",details:{code:"NETWORK_ERROR",timestamp:new Date().toISOString()},suggestions:["Check your internet connection","Try again in a few moments","Refresh the page and retry"],technicalInfo:[{label:"Error",value:e instanceof Error?e.message:"Unknown error"}],canRetry:!0,canReport:!1})}finally{c(!1)}},D=async(e,t)=>{if(!e){l.A.error("Invalid document ID");return}try{console.log(`🗑️ Attempting to delete document: ${e} (${t})`);let s=await fetch(`/api/documents/${e}`,{method:"DELETE"}),a=await s.json();if(console.log("Delete response:",a),!s.ok)throw Error(a.error||`Delete failed with status ${s.status}`);l.A.success(`${t} deleted successfully`),(0,d.j)("/api/documents/upload")}catch(e){console.error("Delete error:",e),l.A.error(e instanceof Error?e.message:"Delete failed")}},L=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?u(!0):"dragleave"===e.type&&u(!1)},R=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["B","KB","MB","GB"][t]},H=e=>{if(!e)return"Unknown date";let t=new Date(e);return isNaN(t.getTime())?"Invalid date":t.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})};return e?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",children:[(0,a.jsxs)("div",{className:"bg-background rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Document Manager"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>g(!0),title:"View RAG Pipeline Demonstration",children:"\uD83D\uDD0D RAG Demo"}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:t,children:"✕"})]})]}),(0,a.jsxs)("div",{className:"p-6",children:[h&&(0,a.jsx)(x,{error:h,isVisible:!!h,onRetry:()=>{p(null);let e=j.current;e?.files&&e.files.length>0&&k(e.files)},onDismiss:()=>p(null),onReport:()=>{console.log("Error reported:",h),l.A.success("Error report sent to development team")}}),(0,a.jsx)("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${m?"border-primary bg-primary/5":"border-gray-300 hover:border-gray-400"} ${s?"opacity-50 pointer-events-none":""}`,onDragEnter:L,onDragLeave:L,onDragOver:L,onDrop:e=>{e.preventDefault(),e.stopPropagation(),u(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&k(e.dataTransfer.files)},children:s?(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)("div",{className:"animate-spin",children:(0,a.jsx)(n.c0,{size:24})}),(0,a.jsx)("p",{children:"Uploading and indexing..."})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)(n.rG,{size:32}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"Drop files here or click to upload"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Supports TXT, MD, PDF, DOCX (max 10MB)"})]}),(0,a.jsxs)(i.z,{onClick:()=>j.current?.click(),disabled:s,className:"flex items-center gap-2",children:[(0,a.jsx)(n.rG,{size:16}),(0,a.jsx)("span",{children:"Choose Files"})]})]})}),(0,a.jsx)("input",{ref:j,type:"file",className:"hidden",accept:".txt,.md,.pdf,.docx,text/plain,text/markdown,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:e=>e.target.files&&k(e.target.files)}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("h3",{className:"font-medium mb-4",children:["Your Documents (",C.length,")"]}),w?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin",children:(0,a.jsx)(n.c0,{size:24})}),(0,a.jsx)("span",{className:"ml-2",children:"Loading documents..."})]}):N?(0,a.jsx)("div",{className:"text-center py-8 text-red-500",children:"Failed to load documents"}):0===C.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No documents uploaded yet"}):(0,a.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:C.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,a.jsx)(n.aA,{size:20}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"font-medium truncate",title:e.displayTitle||e.originalName,children:e.displayTitle||e.originalName}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,a.jsx)("span",{children:R(e.fileSize)}),(0,a.jsxs)("span",{children:[e.chunkCount||0," chunks"]}),(0,a.jsx)("span",{children:H(e.createdAt)})]})]})]}),(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>D(e.id,e.originalName),className:"text-red-500 hover:text-red-700",children:(0,a.jsx)(n.XH,{size:16})})]},e.id))})]})]})]}),(0,a.jsx)(y,{isVisible:f,onClose:()=>g(!1)})]}):null}function w({isAuthenticated:e}){let[t,s]=(0,r.useState)(!1);return e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:()=>s(!0),className:"flex items-center gap-2",title:"Manage Documents",children:[(0,a.jsx)(n.aA,{size:16}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Documents"})]}),(0,a.jsx)(N,{isOpen:t,onClose:()=>s(!1)})]}):null}},58929:(e,t,s)=>{"use strict";s.d(t,{ThemeProvider:()=>n});var a=s(20149),r=s(85805);function n({children:e,...t}){return(0,a.jsx)(r.f,{...t,children:e})}s(63606)},7622:(e,t,s)=>{"use strict";s.d(t,{ThemeToggle:()=>i});var a=s(20149),r=s(85805),n=s(63606);function i(){let{setTheme:e,theme:t}=(0,r.F)(),[s,i]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{i(!0)},[]),s)?(0,a.jsx)("div",{className:"cursor-pointer",onClick:()=>{e("dark"===t?"light":"dark")},children:`Toggle ${"light"===t?"dark":"light"} mode`}):null}},56598:(e,t,s)=>{"use strict";s.d(t,{d:()=>o,z:()=>d});var a=s(20149),r=s(63606),n=s(96245),i=s(9285),l=s(24219);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef(({className:e,variant:t,size:s,asChild:r=!1,...i},d)=>{let c=r?n.g7:"button";return(0,a.jsx)(c,{className:(0,l.cn)(o({variant:t,size:s,className:e})),ref:d,...i})});d.displayName="Button"},7482:(e,t,s)=>{"use strict";s.d(t,{DropdownMenu:()=>c,DropdownMenuContent:()=>u,DropdownMenuItem:()=>x,DropdownMenuTrigger:()=>m});var a=s(20149),r=s(63606),n=s(51494),i=s(8863),l=s(1552),o=s(52364),d=s(24219);let c=n.fC,m=n.xz;n.ZA,n.Uv,n.Tr,n.Ee,r.forwardRef(({className:e,inset:t,children:s,...r},l)=>(0,a.jsxs)(n.fF,{ref:l,className:(0,d.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...r,children:[s,(0,a.jsx)(i.Z,{className:"ml-auto h-4 w-4"})]})).displayName=n.fF.displayName,r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(n.tu,{ref:s,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})).displayName=n.tu.displayName;let u=r.forwardRef(({className:e,sideOffset:t=4,...s},r)=>(0,a.jsx)(n.Uv,{children:(0,a.jsx)(n.VY,{ref:r,sideOffset:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})}));u.displayName=n.VY.displayName;let x=r.forwardRef(({className:e,inset:t,...s},r)=>(0,a.jsx)(n.ck,{ref:r,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...s}));x.displayName=n.ck.displayName,r.forwardRef(({className:e,children:t,checked:s,...r},i)=>(0,a.jsxs)(n.oC,{ref:i,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:s,...r,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),t]})).displayName=n.oC.displayName,r.forwardRef(({className:e,children:t,...s},r)=>(0,a.jsxs)(n.Rk,{ref:r,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(o.Z,{className:"h-2 w-2 fill-current"})})}),t]})).displayName=n.Rk.displayName,r.forwardRef(({className:e,inset:t,...s},r)=>(0,a.jsx)(n.__,{ref:r,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...s})).displayName=n.__.displayName,r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(n.Z0,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=n.Z0.displayName},24219:(e,t,s)=>{"use strict";s.d(t,{_i:()=>l,cn:()=>i,lG:()=>o});var a=s(87873),r=s(96307),n=s(88132);function i(...e){return(0,n.m6)((0,r.W)(e))}let l=async e=>{let t=await fetch(e);if(!t.ok){let e=Error("An error occurred while fetching the data.");throw e.info=await t.json(),e.status=t.status,e}return t.json()};function o(e){let t=e.messages.reduce((e,t)=>{if("tool"===t.role)return function({toolMessage:e,messages:t}){return t.map(t=>t.toolInvocations?{...t,toolInvocations:t.toolInvocations.map(t=>{let s=e.content.find(e=>e.toolCallId===t.toolCallId);return s?{...t,state:"result",result:s.result}:t})}:t)}({toolMessage:t,messages:e});let s="",r=[];if("string"==typeof t.content)s=t.content;else if(Array.isArray(t.content))for(let e of t.content)"text"===e.type?s+=e.text:"tool-call"===e.type&&r.push({state:"call",toolCallId:e.toolCallId,toolName:e.toolName,args:e.args});return e.push({id:(0,a.Ox)(),role:t.role,content:s,toolInvocations:r,ragSources:t.experimental_attachments?.find(e=>"rag-sources"===e.name)?(()=>{try{let e=t.experimental_attachments.find(e=>"rag-sources"===e.name);if(e?.url.startsWith("data:application/json;base64,")){let t=e.url.split(",")[1],s=Buffer.from(t,"base64").toString("utf-8");return JSON.parse(s)}}catch(e){console.error("Error parsing RAG sources in convertToUIMessages:",e)}})():void 0}),e},[])[0];return t?t.content:"Untitled"}},89228:(e,t,s)=>{"use strict";s.d(t,{HT:()=>l,a4:()=>o,I8:()=>d,w7:()=>m});var a=s(75032),r=s(81218),n=s(45807),i=s(21080);let{handlers:{GET:l,POST:o},auth:d,signIn:c,signOut:m}=(0,r.ZP)({pages:{signIn:"/login",newUser:"/"},providers:[],callbacks:{authorized({auth:e,request:{nextUrl:t}}){let s=!!e?.user,a=t.pathname.startsWith("/"),r=t.pathname.startsWith("/register"),n=t.pathname.startsWith("/login");return s&&(n||r)?Response.redirect(new URL("/",t)):!!r||!!n||(a?!!s:!s||Response.redirect(new URL("/",t)))}},providers:[(0,n.Z)({credentials:{},async authorize({email:e,password:t}){if(!e||!t)return null;let s=await (0,i.PR)(e);if(0===s.length)return null;let r=s[0];return r.password&&await (0,a.qu)(t,r.password)?r:null}})],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id),e),session:async({session:e,token:t})=>(e.user&&(e.user.id=t.id),e)}})},3701:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>d,metadata:()=>c});var r=s(57543),n=s(28162),i=s(46918),l=s(11951);s(67272);var o=e([n,i,l]);[n,i,l]=o.then?(await o)():o;let c={metadataBase:new URL("https://rag.duynguy.com"),title:"RAG Chatbot",description:"Experimental RAG chatbot."};async function d({children:e}){return(0,r.jsx)("html",{lang:"en",suppressHydrationWarning:!0,children:(0,r.jsx)("body",{className:"antialiased",children:(0,r.jsxs)(l.f,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:[(0,r.jsx)(n.x7,{position:"top-center"}),(0,r.jsx)(i.Navbar,{}),e]})})})}a()}catch(e){a(e)}})},71682:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{A:()=>e});var r=s(3571);let e=(await (0,r.createProxy)(String.raw`/Users/duy/Documents/build/rag/components/custom/history.tsx`)).History;a()}catch(e){a(e)}},1)},58923:(e,t,s)=>{"use strict";s.d(t,{XZ:()=>r});var a=s(57543);let r=({size:e=16})=>(0,a.jsx)("svg",{height:e,strokeLinejoin:"round",viewBox:"0 0 16 16",width:e,style:{color:"currentcolor"},children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.01526 15.3939L4.3107 14.7046L10.3107 0.704556L10.6061 0.0151978L11.9849 0.606077L11.6894 1.29544L5.68942 15.2954L5.39398 15.9848L4.01526 15.3939Z",fill:"currentColor"})})},162:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{C:()=>n});var r=s(3571);let e=await (0,r.createProxy)(String.raw`/Users/duy/Documents/build/rag/components/custom/navbar-client.tsx`),n=e.NavbarClient;e.default,a()}catch(e){a(e)}},1)},46918:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{$$ACTION_0:()=>f,Navbar:()=>g});var r=s(57543),n=s(32832);s(9440);var i=s(6422),l=s(63830),o=s(89228),d=s(71682),c=s(58923),m=s(162),u=s(53840),x=s(83188),h=s(36),p=e([d,m,u,h]);[d,m,u,h]=p.then?(await p)():p;let g=async()=>{let e=await (0,o.I8)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"bg-background absolute top-0 left-0 w-dvw py-2 px-3 justify-between flex flex-row items-center z-30",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,r.jsx)(d.A,{user:e?.user}),(0,r.jsx)(m.C,{isAuthenticated:!!e}),(0,r.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,r.jsx)(i.default,{src:"/images/gemini-logo.png",height:20,width:20,alt:"gemini logo"}),(0,r.jsx)("div",{className:"text-zinc-500",children:(0,r.jsx)(c.XZ,{size:16})}),(0,r.jsx)("div",{className:"text-sm dark:text-zinc-300 truncate w-28 md:w-fit",children:"RAG Chatbot"})]})]}),e?(0,r.jsxs)(h.h_,{children:[(0,r.jsx)(h.$F,{asChild:!0,children:(0,r.jsx)(x.z,{className:"py-1.5 px-2 h-fit font-normal",variant:"secondary",children:e.user?.email})}),(0,r.jsxs)(h.AW,{align:"end",children:[(0,r.jsx)(h.Xi,{children:(0,r.jsx)(u.T,{})}),(0,r.jsx)(h.Xi,{className:"p-1 z-50",children:(0,r.jsx)("form",{className:"w-full",action:(0,n.j)("079af391027f515e6b475721fe8bdb2e8ebc1912",f),children:(0,r.jsx)("button",{type:"submit",className:"w-full text-left px-1 py-0.5 text-red-500",children:"Sign out"})})})]})]}):(0,r.jsx)(x.z,{className:"py-1.5 px-2 h-fit font-normal text-white",asChild:!0,children:(0,r.jsx)(l.default,{href:"/login",children:"Login"})})]})})};async function f(){await (0,o.w7)({redirectTo:"/"})}a()}catch(e){a(e)}})},11951:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{f:()=>e});var r=s(3571);let e=(await (0,r.createProxy)(String.raw`/Users/duy/Documents/build/rag/components/custom/theme-provider.tsx`)).ThemeProvider;a()}catch(e){a(e)}},1)},53840:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{T:()=>e});var r=s(3571);let e=(await (0,r.createProxy)(String.raw`/Users/duy/Documents/build/rag/components/custom/theme-toggle.tsx`)).ThemeToggle;a()}catch(e){a(e)}},1)},83188:(e,t,s)=>{"use strict";s.d(t,{z:()=>d});var a=s(57543),r=s(49024),n=s(11320),i=s(2848),l=s(87930);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef(({className:e,variant:t,size:s,asChild:r=!1,...i},d)=>{let c=r?n.g7:"button";return(0,a.jsx)(c,{className:(0,l.cn)(o({variant:t,size:s,className:e})),ref:d,...i})});d.displayName="Button"},36:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{$F:()=>i,AW:()=>l,Xi:()=>o,h_:()=>n});var r=s(3571);let e=await (0,r.createProxy)(String.raw`/Users/duy/Documents/build/rag/components/ui/dropdown-menu.tsx`),n=e.DropdownMenu,i=e.DropdownMenuTrigger,l=e.DropdownMenuContent,o=e.DropdownMenuItem;e.DropdownMenuCheckboxItem,e.DropdownMenuRadioItem,e.DropdownMenuLabel,e.DropdownMenuSeparator,e.DropdownMenuShortcut,e.DropdownMenuGroup,e.DropdownMenuPortal,e.DropdownMenuSub,e.DropdownMenuSubContent,e.DropdownMenuSubTrigger,e.DropdownMenuRadioGroup,a()}catch(e){a(e)}},1)},21080:(e,t,s)=>{"use strict";s.d(t,{OE:()=>R,LT:()=>k,g6:()=>S,T:()=>L,AN:()=>D,cQ:()=>M,te:()=>H,PR:()=>w,l_:()=>C,xd:()=>V}),s(75032);var a=s(40986),r=s(6931),n=s(19975),i=s(32219),l=s(49141),o=s(85332),d=s(45220),c=s(17714),m=s(33866),u=s(62746),x=s(80346),h=s(27883),p=s(78367),f=s(73977);let g=(0,l.af)("User",{id:(0,o.Vj)("id").primaryKey().notNull().defaultRandom(),email:(0,d.L7)("email",{length:64}).notNull(),password:(0,d.L7)("password",{length:128})},e=>({uniqueEmail:(0,c.Tw)().on(e.email)})),j=(0,l.af)("Chat",{id:(0,o.Vj)("id").primaryKey().notNull().defaultRandom(),createdAt:(0,m.AB)("createdAt").notNull(),messages:(0,u.AV)("messages").notNull(),userId:(0,o.Vj)("userId").notNull().references(()=>g.id)});(0,l.af)("Reservation",{id:(0,o.Vj)("id").primaryKey().notNull().defaultRandom(),createdAt:(0,m.AB)("createdAt").notNull(),details:(0,u.AV)("details").notNull(),hasCompletedPayment:(0,x.O7)("hasCompletedPayment").notNull().default(!1),userId:(0,o.Vj)("userId").notNull().references(()=>g.id)});let v=(0,l.af)("Document",{id:(0,o.Vj)("id").primaryKey().notNull().defaultRandom(),filename:(0,d.L7)("filename",{length:255}).notNull(),originalName:(0,d.L7)("originalName",{length:255}).notNull(),fileType:(0,d.L7)("fileType",{length:50}).notNull(),fileSize:(0,h._L)("fileSize").notNull(),content:(0,p.fL)("content").notNull(),status:(0,d.L7)("status",{length:20}).notNull().default("indexed"),chunkCount:(0,h._L)("chunkCount").notNull().default(0),createdAt:(0,m.AB)("createdAt").notNull().default((0,f.i6)`CURRENT_TIMESTAMP`),updatedAt:(0,m.AB)("updatedAt").notNull().default((0,f.i6)`CURRENT_TIMESTAMP`),userId:(0,o.Vj)("userId").notNull().references(()=>g.id,{onDelete:"cascade"})}),y=process.env.POSTGRES_URL?(()=>{let e=new URL(process.env.POSTGRES_URL);return e.searchParams.set("sslmode","require"),e.toString()})():"postgres://dummy:dummy@localhost:5432/dummy",b=(0,i.Z)(y,{max:1,transform:process.env.POSTGRES_URL?i.Z.camel:void 0}),N=(0,n.t)(b);async function w(e){try{return await N.select().from(g).where((0,a.eq)(g.email,e))}catch(e){throw console.error("Failed to get user from database"),e}}async function C({id:e,messages:t,userId:s}){try{if((await N.select().from(j).where((0,a.eq)(j.id,e))).length>0)return await N.update(j).set({messages:JSON.stringify(t)}).where((0,a.eq)(j.id,e));return await N.insert(j).values({id:e,createdAt:new Date,messages:JSON.stringify(t),userId:s})}catch(e){throw console.error("Failed to save chat in database"),e}}async function k({id:e}){try{return await N.delete(j).where((0,a.eq)(j.id,e))}catch(e){throw console.error("Failed to delete chat by id from database"),e}}async function D({id:e}){try{return await N.select().from(j).where((0,a.eq)(j.userId,e)).orderBy((0,r.C)(j.createdAt))}catch(e){throw console.error("Failed to get chats by user from database"),e}}async function L({id:e}){try{let[t]=await N.select().from(j).where((0,a.eq)(j.id,e));return t}catch(e){throw console.error("Failed to get chat by id from database"),e}}async function R({filename:e,originalName:t,fileType:s,fileSize:a,content:r,userId:n}){try{let[i]=await N.insert(v).values({filename:e,originalName:t,fileType:s,fileSize:a,content:r,userId:n,status:"indexed",chunkCount:0}).returning();return i}catch(e){throw console.error("Failed to create document in database"),e}}async function H({userId:e}){try{return await N.select().from(v).where((0,a.eq)(v.userId,e)).orderBy((0,r.C)(v.createdAt))}catch(e){throw console.error("Failed to get documents by user from database:",e),e}}async function M({id:e}){try{let[t]=await N.select().from(v).where((0,a.eq)(v.id,e));return t}catch(e){throw console.error("Failed to get document by id from database"),e}}async function V({id:e,chunkCount:t}){try{return await N.update(v).set({chunkCount:t,updatedAt:new Date}).where((0,a.eq)(v.id,e))}catch(e){throw console.error("Failed to update document chunk count"),e}}async function S({id:e}){try{return await N.delete(v).where((0,a.eq)(v.id,e))}catch(e){throw console.error("Failed to delete document by id from database"),e}}},87930:(e,t,s)=>{"use strict";s.d(t,{DO:()=>l,Ty:()=>o,cn:()=>i});var a=s(30006),r=s(57119),n=s(80106);function i(...e){return(0,n.m6)((0,r.W)(e))}function l(){if("undefined"!=typeof crypto&&crypto.randomUUID)return crypto.randomUUID();if("undefined"!=typeof crypto&&crypto.getRandomValues){let e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=15&e[6]|64,e[8]=63&e[8]|128;let t=Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("");return[t.slice(0,8),t.slice(8,12),t.slice(12,16),t.slice(16,20),t.slice(20,32)].join("-")}return console.warn("Using Math.random() for UUID generation - not cryptographically secure"),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function o(e){return e.reduce((e,t)=>{if("tool"===t.role)return function({toolMessage:e,messages:t}){return t.map(t=>t.toolInvocations?{...t,toolInvocations:t.toolInvocations.map(t=>{let s=e.content.find(e=>e.toolCallId===t.toolCallId);return s?{...t,state:"result",result:s.result}:t})}:t)}({toolMessage:t,messages:e});let s="",r=[];if("string"==typeof t.content)s=t.content;else if(Array.isArray(t.content))for(let e of t.content)"text"===e.type?s+=e.text:"tool-call"===e.type&&r.push({state:"call",toolCallId:e.toolCallId,toolName:e.toolName,args:e.args});return e.push({id:(0,a.Ox)(),role:t.role,content:s,toolInvocations:r,ragSources:t.experimental_attachments?.find(e=>"rag-sources"===e.name)?(()=>{try{let e=t.experimental_attachments.find(e=>"rag-sources"===e.name);if(e?.url.startsWith("data:application/json;base64,")){let t=e.url.split(",")[1],s=Buffer.from(t,"base64").toString("utf-8");return JSON.parse(s)}}catch(e){console.error("Error parsing RAG sources in convertToUIMessages:",e)}})():void 0}),e},[])}},67272:()=>{}};