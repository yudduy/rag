exports.id=503,exports.ids=[503],exports.modules={50479:(e,t)=>{"use strict";t.Q=function(e,t){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var r={},i=(t||{}).decode||n,s=0;s<e.length;){var o=e.indexOf("=",s);if(-1===o)break;var a=e.indexOf(";",s);if(-1===a)a=e.length;else if(a<o){s=e.lastIndexOf(";",o-1)+1;continue}var l=e.slice(s,o).trim();if(void 0===r[l]){var c=e.slice(o+1,a).trim();34===c.charCodeAt(0)&&(c=c.slice(1,-1)),r[l]=function(e,t){try{return t(e)}catch(t){return e}}(c,i)}s=a+1}return r},t.q=function(e,t,n){var o=n||{},a=o.encode||s;if("function"!=typeof a)throw TypeError("option encode is invalid");if(!i.test(e))throw TypeError("argument name is invalid");var l=a(t);if(l&&!i.test(l))throw TypeError("argument val is invalid");var c=e+"="+l;if(null!=o.maxAge){var u=o.maxAge-0;if(isNaN(u)||!isFinite(u))throw TypeError("option maxAge is invalid");c+="; Max-Age="+Math.floor(u)}if(o.domain){if(!i.test(o.domain))throw TypeError("option domain is invalid");c+="; Domain="+o.domain}if(o.path){if(!i.test(o.path))throw TypeError("option path is invalid");c+="; Path="+o.path}if(o.expires){var d=o.expires;if("[object Date]"!==r.call(d)&&!(d instanceof Date)||isNaN(d.valueOf()))throw TypeError("option expires is invalid");c+="; Expires="+d.toUTCString()}if(o.httpOnly&&(c+="; HttpOnly"),o.secure&&(c+="; Secure"),o.partitioned&&(c+="; Partitioned"),o.priority)switch("string"==typeof o.priority?o.priority.toLowerCase():o.priority){case"low":c+="; Priority=Low";break;case"medium":c+="; Priority=Medium";break;case"high":c+="; Priority=High";break;default:throw TypeError("option priority is invalid")}if(o.sameSite)switch("string"==typeof o.sameSite?o.sameSite.toLowerCase():o.sameSite){case!0:case"strict":c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"none":c+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return c};var r=Object.prototype.toString,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function n(e){return -1!==e.indexOf("%")?decodeURIComponent(e):e}function s(e){return encodeURIComponent(e)}},69319:(e,t,r)=>{"use strict";var i=r(4293);r.o(i,"notFound")&&r.d(t,{notFound:function(){return i.notFound}}),r.o(i,"redirect")&&r.d(t,{redirect:function(){return i.redirect}})},49588:(e,t,r)=>{"use strict";var i=r(1239);r.o(i,"NextRequest")&&r.d(t,{NextRequest:function(){return i.NextRequest}}),r.o(i,"NextResponse")&&r.d(t,{NextResponse:function(){return i.NextResponse}})},67552:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraftMode",{enumerable:!0,get:function(){return s}});let i=r(45869),n=r(38826);class s{get isEnabled(){return this._provider.isEnabled}enable(){let e=i.staticGenerationAsyncStorage.getStore();return e&&(0,n.trackDynamicDataAccessed)(e,"draftMode().enable()"),this._provider.enable()}disable(){let e=i.staticGenerationAsyncStorage.getStore();return e&&(0,n.trackDynamicDataAccessed)(e,"draftMode().disable()"),this._provider.disable()}constructor(e){this._provider=e}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4742:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{cookies:function(){return p},draftMode:function(){return f},headers:function(){return d}});let i=r(61928),n=r(88393),s=r(32718),o=r(72934),a=r(67552),l=r(38826),c=r(45869),u=r(54580);function d(){let e="headers",t=c.staticGenerationAsyncStorage.getStore();if(t){if(t.forceStatic)return n.HeadersAdapter.seal(new Headers({}));(0,l.trackDynamicDataAccessed)(t,e)}return(0,u.getExpectedRequestStore)(e).headers}function p(){let e="cookies",t=c.staticGenerationAsyncStorage.getStore();if(t){if(t.forceStatic)return i.RequestCookiesAdapter.seal(new s.RequestCookies(new Headers({})));(0,l.trackDynamicDataAccessed)(t,e)}let r=(0,u.getExpectedRequestStore)(e),n=o.actionAsyncStorage.getStore();return(null==n?void 0:n.isAction)||(null==n?void 0:n.isAppRoute)?r.mutableCookies:r.cookies}function f(){let e=(0,u.getExpectedRequestStore)("draftMode");return new a.DraftMode(e.draftMode)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},64872:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isNextRouterError",{enumerable:!0,get:function(){return s}});let i=r(41671),n=r(49925);function s(e){return(0,n.isRedirectError)(e)||(0,i.isNotFoundError)(e)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4293:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ReadonlyURLSearchParams:function(){return a},RedirectType:function(){return i.RedirectType},notFound:function(){return n.notFound},permanentRedirect:function(){return i.permanentRedirect},redirect:function(){return i.redirect},unstable_rethrow:function(){return s.unstable_rethrow}});let i=r(49925),n=r(41671),s=r(7850);class o extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class a extends URLSearchParams{append(){throw new o}delete(){throw new o}set(){throw new o}sort(){throw new o}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},41671:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isNotFoundError:function(){return n},notFound:function(){return i}});let r="NEXT_NOT_FOUND";function i(){let e=Error(r);throw e.digest=r,e}function n(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===r}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},52041:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RedirectStatusCode",{enumerable:!0,get:function(){return r}}),function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(r||(r={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},49925:(e,t,r)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RedirectType:function(){return i},getRedirectError:function(){return l},getRedirectStatusCodeFromError:function(){return h},getRedirectTypeFromError:function(){return f},getURLFromRedirectError:function(){return p},isRedirectError:function(){return d},permanentRedirect:function(){return u},redirect:function(){return c}});let n=r(54580),s=r(72934),o=r(52041),a="NEXT_REDIRECT";function l(e,t,r){void 0===r&&(r=o.RedirectStatusCode.TemporaryRedirect);let i=Error(a);i.digest=a+";"+t+";"+e+";"+r+";";let s=n.requestAsyncStorage.getStore();return s&&(i.mutableCookies=s.mutableCookies),i}function c(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?o.RedirectStatusCode.SeeOther:o.RedirectStatusCode.TemporaryRedirect)}function u(e,t){void 0===t&&(t="replace");let r=s.actionAsyncStorage.getStore();throw l(e,t,(null==r?void 0:r.isAction)?o.RedirectStatusCode.SeeOther:o.RedirectStatusCode.PermanentRedirect)}function d(e){if("object"!=typeof e||null===e||!("digest"in e)||"string"!=typeof e.digest)return!1;let t=e.digest.split(";"),[r,i]=t,n=t.slice(2,-2).join(";"),s=Number(t.at(-2));return r===a&&("replace"===i||"push"===i)&&"string"==typeof n&&!isNaN(s)&&s in o.RedirectStatusCode}function p(e){return d(e)?e.digest.split(";").slice(2,-2).join(";"):null}function f(e){if(!d(e))throw Error("Not a redirect error");return e.digest.split(";",2)[1]}function h(e){if(!d(e))throw Error("Not a redirect error");return Number(e.digest.split(";").at(-2))}(function(e){e.push="push",e.replace="replace"})(i||(i={})),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7850:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"unstable_rethrow",{enumerable:!0,get:function(){return function e(t){if((0,o.isNextRouterError)(t)||(0,s.isBailoutToCSRError)(t)||(0,i.isDynamicUsageError)(t)||(0,n.isPostpone)(t))throw t;t instanceof Error&&"cause"in t&&e(t.cause)}}});let i=r(22548),n=r(6866),s=r(76909),o=r(64872);("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},75656:(e,t,r)=>{var i;(()=>{var n={226:function(n,s){!function(o,a){"use strict";var l="function",c="undefined",u="object",d="string",p="major",f="model",h="name",m="type",y="vendor",g="version",w="architecture",b="console",v="mobile",_="tablet",S="smarttv",k="wearable",A="embedded",x="Amazon",E="Apple",T="ASUS",P="BlackBerry",C="Browser",$="Chrome",O="Firefox",j="Google",R="Huawei",U="Microsoft",N="Motorola",I="Opera",D="Samsung",L="Sharp",Q="Sony",B="Xiaomi",q="Zebra",M="Facebook",z="Chromium OS",H="Mac OS",K=function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r},W=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},F=function(e,t){return typeof e===d&&-1!==J(t).indexOf(J(e))},J=function(e){return e.toLowerCase()},V=function(e,t){if(typeof e===d)return e=e.replace(/^\s\s*/,""),typeof t===c?e:e.substring(0,350)},G=function(e,t){for(var r,i,n,s,o,c,d=0;d<t.length&&!o;){var p=t[d],f=t[d+1];for(r=i=0;r<p.length&&!o&&p[r];)if(o=p[r++].exec(e))for(n=0;n<f.length;n++)c=o[++i],typeof(s=f[n])===u&&s.length>0?2===s.length?typeof s[1]==l?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3===s.length?typeof s[1]!==l||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):void 0:this[s[0]]=c?s[1].call(this,c,s[2]):void 0:4===s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):void 0):this[s]=c||a;d+=2}},Z=function(e,t){for(var r in t)if(typeof t[r]===u&&t[r].length>0){for(var i=0;i<t[r].length;i++)if(F(t[r][i],e))return"?"===r?a:r}else if(F(t[r],e))return"?"===r?a:r;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Y={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[g,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[g,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,g],[/opios[\/ ]+([\w\.]+)/i],[g,[h,I+" Mini"]],[/\bopr\/([\w\.]+)/i],[g,[h,I]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,g],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[g,[h,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[g,[h,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[g,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[g,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[g,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[g,[h,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+C],g],[/\bfocus\/([\w\.]+)/i],[g,[h,O+" Focus"]],[/\bopt\/([\w\.]+)/i],[g,[h,I+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[g,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[g,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[g,[h,I+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[g,[h,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[g,[h,O]],[/\bqihu|(qi?ho?o?|360)browser/i],[[h,"360 "+C]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1 "+C],g],[/(comodo_dragon)\/([\w\.]+)/i],[[h,/_/g," "],g],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[h,g],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,M],g],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[h,g],[/\bgsa\/([\w\.]+) .*safari\//i],[g,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[g,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[g,[h,$+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,$+" WebView"],g],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[g,[h,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,g],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[g,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[g,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[g,Z,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,g],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],g],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[g,[h,O+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[h,g],[/(cobalt)\/([\w\.]+)/i],[h,[g,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[w,"amd64"]],[/(ia32(?=;))/i],[[w,J]],[/((?:i[346]|x)86)[;\)]/i],[[w,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[w,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[w,"armhf"]],[/windows (ce|mobile); ppc;/i],[[w,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[w,/ower/,"",J]],[/(sun4\w)[;\)]/i],[[w,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[w,J]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[f,[y,D],[m,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[f,[y,D],[m,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[f,[y,E],[m,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[f,[y,E],[m,_]],[/(macintosh);/i],[f,[y,E]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[f,[y,L],[m,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[f,[y,R],[m,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[f,[y,R],[m,v]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[f,/_/g," "],[y,B],[m,v]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[f,/_/g," "],[y,B],[m,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[f,[y,"OPPO"],[m,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[f,[y,"Vivo"],[m,v]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[f,[y,"Realme"],[m,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[f,[y,N],[m,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[f,[y,N],[m,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[f,[y,"LG"],[m,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[f,[y,"LG"],[m,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[f,[y,"Lenovo"],[m,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[f,/_/g," "],[y,"Nokia"],[m,v]],[/(pixel c)\b/i],[f,[y,j],[m,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[f,[y,j],[m,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[f,[y,Q],[m,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[f,"Xperia Tablet"],[y,Q],[m,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[f,[y,"OnePlus"],[m,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[f,[y,x],[m,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[f,/(.+)/g,"Fire Phone $1"],[y,x],[m,v]],[/(playbook);[-\w\),; ]+(rim)/i],[f,y,[m,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[f,[y,P],[m,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[f,[y,T],[m,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[f,[y,T],[m,v]],[/(nexus 9)/i],[f,[y,"HTC"],[m,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[y,[f,/_/g," "],[m,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[f,[y,"Acer"],[m,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[f,[y,"Meizu"],[m,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[y,f,[m,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[y,f,[m,_]],[/(surface duo)/i],[f,[y,U],[m,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[f,[y,"Fairphone"],[m,v]],[/(u304aa)/i],[f,[y,"AT&T"],[m,v]],[/\bsie-(\w*)/i],[f,[y,"Siemens"],[m,v]],[/\b(rct\w+) b/i],[f,[y,"RCA"],[m,_]],[/\b(venue[\d ]{2,7}) b/i],[f,[y,"Dell"],[m,_]],[/\b(q(?:mv|ta)\w+) b/i],[f,[y,"Verizon"],[m,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[f,[y,"Barnes & Noble"],[m,_]],[/\b(tm\d{3}\w+) b/i],[f,[y,"NuVision"],[m,_]],[/\b(k88) b/i],[f,[y,"ZTE"],[m,_]],[/\b(nx\d{3}j) b/i],[f,[y,"ZTE"],[m,v]],[/\b(gen\d{3}) b.+49h/i],[f,[y,"Swiss"],[m,v]],[/\b(zur\d{3}) b/i],[f,[y,"Swiss"],[m,_]],[/\b((zeki)?tb.*\b) b/i],[f,[y,"Zeki"],[m,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[y,"Dragon Touch"],f,[m,_]],[/\b(ns-?\w{0,9}) b/i],[f,[y,"Insignia"],[m,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[f,[y,"NextBook"],[m,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[y,"Voice"],f,[m,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[y,"LvTel"],f,[m,v]],[/\b(ph-1) /i],[f,[y,"Essential"],[m,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[f,[y,"Envizen"],[m,_]],[/\b(trio[-\w\. ]+) b/i],[f,[y,"MachSpeed"],[m,_]],[/\btu_(1491) b/i],[f,[y,"Rotor"],[m,_]],[/(shield[\w ]+) b/i],[f,[y,"Nvidia"],[m,_]],[/(sprint) (\w+)/i],[y,f,[m,v]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[y,U],[m,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[f,[y,q],[m,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[f,[y,q],[m,v]],[/smart-tv.+(samsung)/i],[y,[m,S]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[y,D],[m,S]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[y,"LG"],[m,S]],[/(apple) ?tv/i],[y,[f,E+" TV"],[m,S]],[/crkey/i],[[f,$+"cast"],[y,j],[m,S]],[/droid.+aft(\w)( bui|\))/i],[f,[y,x],[m,S]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[f,[y,L],[m,S]],[/(bravia[\w ]+)( bui|\))/i],[f,[y,Q],[m,S]],[/(mitv-\w{5}) bui/i],[f,[y,B],[m,S]],[/Hbbtv.*(technisat) (.*);/i],[y,f,[m,S]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[y,V],[f,V],[m,S]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,S]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[y,f,[m,b]],[/droid.+; (shield) bui/i],[f,[y,"Nvidia"],[m,b]],[/(playstation [345portablevi]+)/i],[f,[y,Q],[m,b]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[f,[y,U],[m,b]],[/((pebble))app/i],[y,f,[m,k]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[f,[y,E],[m,k]],[/droid.+; (glass) \d/i],[f,[y,j],[m,k]],[/droid.+; (wt63?0{2,3})\)/i],[f,[y,q],[m,k]],[/(quest( 2| pro)?)/i],[f,[y,M],[m,k]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[y,[m,A]],[/(aeobc)\b/i],[f,[y,x],[m,A]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[f,[m,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[f,[m,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,v]],[/(android[-\w\. ]{0,9});.+buil/i],[f,[y,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[g,[h,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[g,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,g],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[g,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,g],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[h,[g,Z,X]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[h,"Windows"],[g,Z,X]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[g,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,H],[g,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[g,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,g],[/\(bb(10);/i],[g,[h,P]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[g,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[g,[h,O+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[g,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[g,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[g,[h,$+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,z],g],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,g],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],g],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,g]]},ee=function(e,t){if(typeof e===u&&(t=e,e=a),!(this instanceof ee))return new ee(e,t).getResult();var r=typeof o!==c&&o.navigator?o.navigator:a,i=e||(r&&r.userAgent?r.userAgent:""),n=r&&r.userAgentData?r.userAgentData:a,s=t?K(Y,t):Y,b=r&&r.userAgent==i;return this.getBrowser=function(){var e,t={};return t[h]=a,t[g]=a,G.call(t,i,s.browser),t[p]=typeof(e=t[g])===d?e.replace(/[^\d\.]/g,"").split(".")[0]:a,b&&r&&r.brave&&typeof r.brave.isBrave==l&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[w]=a,G.call(e,i,s.cpu),e},this.getDevice=function(){var e={};return e[y]=a,e[f]=a,e[m]=a,G.call(e,i,s.device),b&&!e[m]&&n&&n.mobile&&(e[m]=v),b&&"Macintosh"==e[f]&&r&&typeof r.standalone!==c&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[f]="iPad",e[m]=_),e},this.getEngine=function(){var e={};return e[h]=a,e[g]=a,G.call(e,i,s.engine),e},this.getOS=function(){var e={};return e[h]=a,e[g]=a,G.call(e,i,s.os),b&&!e[h]&&n&&"Unknown"!=n.platform&&(e[h]=n.platform.replace(/chrome os/i,z).replace(/macos/i,H)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===d&&e.length>350?V(e,350):e,this},this.setUA(i),this};ee.VERSION="1.0.35",ee.BROWSER=W([h,g,p]),ee.CPU=W([w]),ee.DEVICE=W([f,y,m,b,v,S,_,k,A]),ee.ENGINE=ee.OS=W([h,g]),typeof s!==c?(n.exports&&(s=n.exports=ee),s.UAParser=ee):r.amdO?void 0!==(i=(function(){return ee}).call(t,r,t,e))&&(e.exports=i):typeof o!==c&&(o.UAParser=ee);var et=typeof o!==c&&(o.jQuery||o.Zepto);if(et&&!et.ua){var er=new ee;et.ua=er.getResult(),et.ua.get=function(){return er.getUA()},et.ua.set=function(e){er.setUA(e);var t=er.getResult();for(var r in t)et.ua[r]=t[r]}}}("object"==typeof window?window:this)}},s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={exports:{}},i=!0;try{n[e].call(r.exports,r,r.exports,o),i=!1}finally{i&&delete s[e]}return r.exports}o.ab=__dirname+"/";var a=o(226);e.exports=a})()},22548:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isDynamicUsageError",{enumerable:!0,get:function(){return a}});let i=r(57378),n=r(76909),s=r(64872),o=r(38826),a=e=>(0,i.isDynamicServerError)(e)||(0,n.isBailoutToCSRError)(e)||(0,s.isNextRouterError)(e)||(0,o.isDynamicPostpone)(e)},98901:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"unstable_after",{enumerable:!0,get:function(){return a}});let i=r(54580),n=r(45869),s=r(21913),o=r(38826);function a(e){let t="unstable_after",{afterContext:r}=(0,i.getExpectedRequestStore)(t);if(!r)throw Error("`unstable_after()` must be explicitly enabled by setting `experimental.after: true` in your next.config.js.");let a=n.staticGenerationAsyncStorage.getStore();if(a){if(a.forceStatic)throw new s.StaticGenBailoutError(`Route ${a.route} with \`dynamic = "force-static"\` couldn't be rendered statically because it used \`${t}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`);(0,o.markCurrentScopeAsDynamic)(a,t)}return r.after(e)}},78172:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){Object.keys(e).forEach(function(r){"default"===r||Object.prototype.hasOwnProperty.call(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[r]}})})}(r(98901),t)},6866:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isPostpone",{enumerable:!0,get:function(){return i}});let r=Symbol.for("react.postpone");function i(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}},1239:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{ImageResponse:function(){return i.ImageResponse},NextRequest:function(){return n.NextRequest},NextResponse:function(){return s.NextResponse},URLPattern:function(){return a.URLPattern},unstable_after:function(){return l.unstable_after},userAgent:function(){return o.userAgent},userAgentFromString:function(){return o.userAgentFromString}});let i=r(61709),n=r(87169),s=r(99847),o=r(2429),a=r(70398),l=r(78172)},88393:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{HeadersAdapter:function(){return s},ReadonlyHeadersError:function(){return n}});let i=r(18140);class n extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new n}}class s extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,n){if("symbol"==typeof r)return i.ReflectAdapter.get(t,r,n);let s=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===s);if(void 0!==o)return i.ReflectAdapter.get(t,o,n)},set(t,r,n,s){if("symbol"==typeof r)return i.ReflectAdapter.set(t,r,n,s);let o=r.toLowerCase(),a=Object.keys(e).find(e=>e.toLowerCase()===o);return i.ReflectAdapter.set(t,a??r,n,s)},has(t,r){if("symbol"==typeof r)return i.ReflectAdapter.has(t,r);let n=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0!==s&&i.ReflectAdapter.has(t,s)},deleteProperty(t,r){if("symbol"==typeof r)return i.ReflectAdapter.deleteProperty(t,r);let n=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0===s||i.ReflectAdapter.deleteProperty(t,s)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return n.callable;default:return i.ReflectAdapter.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new s(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,i]of this.entries())e.call(t,i,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}},18140:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(e,t,r){let i=Reflect.get(e,t,r);return"function"==typeof i?i.bind(e):i}static set(e,t,r,i){return Reflect.set(e,t,r,i)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},61928:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{MutableRequestCookiesAdapter:function(){return d},ReadonlyRequestCookiesError:function(){return o},RequestCookiesAdapter:function(){return a},appendMutableCookies:function(){return u},getModifiedCookieValues:function(){return c}});let i=r(32718),n=r(18140),s=r(45869);class o extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new o}}class a{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return o.callable;default:return n.ReflectAdapter.get(e,t,r)}}})}}let l=Symbol.for("next.mutated.cookies");function c(e){let t=e[l];return t&&Array.isArray(t)&&0!==t.length?t:[]}function u(e,t){let r=c(t);if(0===r.length)return!1;let n=new i.ResponseCookies(e),s=n.getAll();for(let e of r)n.set(e);for(let e of s)n.set(e);return!0}class d{static wrap(e,t){let r=new i.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let o=[],a=new Set,c=()=>{let e=s.staticGenerationAsyncStorage.getStore();if(e&&(e.pathWasRevalidated=!0),o=r.getAll().filter(e=>a.has(e.name)),t){let e=[];for(let t of o){let r=new i.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}};return new Proxy(r,{get(e,t,r){switch(t){case l:return o;case"delete":return function(...t){a.add("string"==typeof t[0]?t[0]:t[0].name);try{e.delete(...t)}finally{c()}};case"set":return function(...t){a.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t)}finally{c()}};default:return n.ReflectAdapter.get(e,t,r)}}})}}},61709:(e,t)=>{"use strict";function r(){throw Error('ImageResponse moved from "next/server" to "next/og" since Next.js 14, please import from "next/og" instead')}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ImageResponse",{enumerable:!0,get:function(){return r}})},99847:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextResponse",{enumerable:!0,get:function(){return d}});let i=r(32718),n=r(70089),s=r(56859),o=r(18140),a=r(32718),l=Symbol("internal response"),c=new Set([301,302,303,307,308]);function u(e,t){var r;if(null==e?void 0:null==(r=e.request)?void 0:r.headers){if(!(e.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let r=[];for(let[i,n]of e.request.headers)t.set("x-middleware-request-"+i,n),r.push(i);t.set("x-middleware-override-headers",r.join(","))}}class d extends Response{constructor(e,t={}){super(e,t);let r=this.headers,c=new Proxy(new a.ResponseCookies(r),{get(e,n,s){switch(n){case"delete":case"set":return(...s)=>{let o=Reflect.apply(e[n],e,s),l=new Headers(r);return o instanceof a.ResponseCookies&&r.set("x-middleware-set-cookie",o.getAll().map(e=>(0,i.stringifyCookie)(e)).join(",")),u(t,l),o};default:return o.ReflectAdapter.get(e,n,s)}}});this[l]={cookies:c,url:t.url?new n.NextURL(t.url,{headers:(0,s.toNodeOutgoingHttpHeaders)(r),nextConfig:t.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[l].cookies}static json(e,t){let r=Response.json(e,t);return new d(r.body,r)}static redirect(e,t){let r="number"==typeof t?t:(null==t?void 0:t.status)??307;if(!c.has(r))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let i="object"==typeof t?t:{},n=new Headers(null==i?void 0:i.headers);return n.set("Location",(0,s.validateURL)(e)),new d(null,{...i,headers:n,status:r})}static rewrite(e,t){let r=new Headers(null==t?void 0:t.headers);return r.set("x-middleware-rewrite",(0,s.validateURL)(e)),u(t,r),new d(null,{...t,headers:r})}static next(e){let t=new Headers(null==e?void 0:e.headers);return t.set("x-middleware-next","1"),u(e,t),new d(null,{...e,headers:t})}}},70398:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"URLPattern",{enumerable:!0,get:function(){return r}});let r="undefined"==typeof URLPattern?void 0:URLPattern},2429:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{isBot:function(){return n},userAgent:function(){return o},userAgentFromString:function(){return s}});let i=function(e){return e&&e.__esModule?e:{default:e}}(r(75656));function n(e){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Google-InspectionTool|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(e)}function s(e){return{...(0,i.default)(e),isBot:void 0!==e&&n(e)}}function o({headers:e}){return s(e.get("user-agent")||void 0)}},76909:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{BailoutToCSRError:function(){return i},isBailoutToCSRError:function(){return n}});let r="BAILOUT_TO_CLIENT_SIDE_RENDERING";class i extends Error{constructor(e){super("Bail out to client-side rendering: "+e),this.reason=e,this.digest=r}}function n(e){return"object"==typeof e&&null!==e&&"digest"in e&&e.digest===r}},45807:(e,t,r)=>{"use strict";function i(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}r.d(t,{Z:()=>i})},75032:(e,t,r)=>{"use strict";r.d(t,{qu:()=>P});var i=r(6005);let n=10,s="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),o=Array.from({length:64},(e,t)=>t),a=e=>Array(e).fill(-1),l=[...a(46),0,1,...o.slice(54,64),...a(7),...o.slice(2,28),...a(6),...o.slice(28,54),...a(5)],c=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],u=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],d=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892],p=(e,t)=>{if(t<=0||t>e.length)throw Error(`Illegal len: ${t}`);let r=0,i,n,o=[];for(;r<t;){if(i=255&e[r++],o.push(s[i>>2&63]),i=(3&i)<<4,r>=t||(i|=(n=255&e[r++])>>4&15,o.push(s[63&i]),i=(15&n)<<2,r>=t)){o.push(s[63&i]);break}i|=(n=255&e[r++])>>6&3,o.push(s[63&i]),o.push(s[63&n])}return o.join("")},f=(e,t)=>{let r=e.length,i=0,n=0,s,o,a,c,u=[];for(;i<r-1&&n<t&&(s=(c=e.charCodeAt(i++))<l.length?l[c]:-1,o=(c=e.charCodeAt(i++))<l.length?l[c]:-1,!(-1==s||-1==o||(u.push(String.fromCharCode(s<<2>>>0|(48&o)>>4)),++n>=t||i>=r)||-1==(a=(c=e.charCodeAt(i++))<l.length?l[c]:-1)||(u.push(String.fromCharCode((15&o)<<4>>>0|(60&a)>>2)),++n>=t||i>=r)));)u.push(String.fromCharCode((3&a)<<6>>>0|((c=e.charCodeAt(i++))<l.length?l[c]:-1))),++n;return u.map(e=>e.charCodeAt(0))},h=(e,t)=>{let r=null;for("number"==typeof e&&(r=e,e=()=>null);null!==r||null!==(r=e());)r<128?t(127&r):(r<2048?t(r>>6&31|192):(r<65536?t(r>>12&15|224):(t(r>>18&7|240),t(r>>12&63|128)),t(r>>6&63|128)),t(63&r|128)),r=null},m=(e,t)=>{let r,i=null;for(;null!==(r=null!==i?i:e());){if(r>=55296&&r<=57343&&null!==(i=e())&&i>=56320&&i<=57343){t((r-55296)*1024+i-56320+65536),i=null;continue}t(r)}null!==i&&t(i)},y=(e,t)=>m(e,e=>{h(e,t)}),g="function"==typeof setImmediate?setImmediate:"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:setTimeout,w=e=>{let t=0,r=[];return y(()=>t<e.length?e.charCodeAt(t++):null,e=>{r.push(e)}),r},b=(e,t,r,i)=>{let n=e[t],s=e[t+1];return n^=r[0],s^=(i[n>>>24]+i[256|n>>16&255]^i[512|n>>8&255])+i[768|255&n]^r[1],n^=(i[s>>>24]+i[256|s>>16&255]^i[512|s>>8&255])+i[768|255&s]^r[2],s^=(i[n>>>24]+i[256|n>>16&255]^i[512|n>>8&255])+i[768|255&n]^r[3],n^=(i[s>>>24]+i[256|s>>16&255]^i[512|s>>8&255])+i[768|255&s]^r[4],s^=(i[n>>>24]+i[256|n>>16&255]^i[512|n>>8&255])+i[768|255&n]^r[5],n^=(i[s>>>24]+i[256|s>>16&255]^i[512|s>>8&255])+i[768|255&s]^r[6],s^=(i[n>>>24]+i[256|n>>16&255]^i[512|n>>8&255])+i[768|255&n]^r[7],n^=(i[s>>>24]+i[256|s>>16&255]^i[512|s>>8&255])+i[768|255&s]^r[8],s^=(i[n>>>24]+i[256|n>>16&255]^i[512|n>>8&255])+i[768|255&n]^r[9],n^=(i[s>>>24]+i[256|s>>16&255]^i[512|s>>8&255])+i[768|255&s]^r[10],s^=(i[n>>>24]+i[256|n>>16&255]^i[512|n>>8&255])+i[768|255&n]^r[11],n^=(i[s>>>24]+i[256|s>>16&255]^i[512|s>>8&255])+i[768|255&s]^r[12],s^=(i[n>>>24]+i[256|n>>16&255]^i[512|n>>8&255])+i[768|255&n]^r[13],n^=(i[s>>>24]+i[256|s>>16&255]^i[512|s>>8&255])+i[768|255&s]^r[14],s^=(i[n>>>24]+i[256|n>>16&255]^i[512|n>>8&255])+i[768|255&n]^r[15],n^=(i[s>>>24]+i[256|s>>16&255]^i[512|s>>8&255])+i[768|255&s]^r[16],e[t]=s^r[17],e[t+1]=n,e},v=(e,t)=>{let r=0;for(let i=0;i<4;++i)r=r<<8|255&e[t],t=(t+1)%e.length;return{key:r,offp:t}},_=(e,t,r)=>{let i=t.length,n=r.length,s=0,o=[0,0],a;for(let r=0;r<i;r++)s=(a=v(e,s)).offp,t[r]=t[r]^a.key;for(let e=0;e<i;e+=2)o=b(o,0,t,r),t[e]=o[0],t[e+1]=o[1];for(let e=0;e<n;e+=2)o=b(o,0,t,r),r[e]=o[0],r[e+1]=o[1]},S=(e,t,r,i)=>{let n=r.length,s=i.length,o=0,a=[0,0],l;for(let e=0;e<n;e++)o=(l=v(t,o)).offp,r[e]=r[e]^l.key;o=0;for(let t=0;t<n;t+=2)o=(l=v(e,o)).offp,a[0]^=l.key,o=(l=v(e,o)).offp,a[1]^=l.key,a=b(a,0,r,i),r[t]=a[0],r[t+1]=a[1];for(let t=0;t<s;t+=2)o=(l=v(e,o)).offp,a[0]^=l.key,o=(l=v(e,o)).offp,a[1]^=l.key,a=b(a,0,r,i),i[t]=a[0],i[t+1]=a[1]},k=(e,t,r,i,n)=>{let s=d.slice(),o=s.length;if(r<4||r>31){let e=Error(`Illegal number of rounds (4-31): ${r}`);if(!1===i)return Promise.reject(e);throw e}if(16!==t.length){let e=Error(`Illegal salt length: ${t.length} != 16`);if(!1===i)return Promise.reject(e);throw e}r=1<<r>>>0;let a,l,p=0,f;Int32Array?(a=new Int32Array(c),l=new Int32Array(u)):(a=c.slice(),l=u.slice()),S(t,e,a,l);let h=()=>{if(n&&n(p/r),p<r){let i=Date.now();for(;p<r&&(p+=1,_(e,a,l),_(t,a,l),!(Date.now()-i>100)););}else{for(p=0;p<64;p++)for(f=0;f<o>>1;f++)b(s,f<<1,a,l);let e=[];for(p=0;p<o;p++)e.push((s[p]>>24&255)>>>0),e.push((s[p]>>16&255)>>>0),e.push((s[p]>>8&255)>>>0),e.push((255&s[p])>>>0);return!1===i?Promise.resolve(e):e}if(!1===i)return new Promise(e=>g(()=>{h().then(e)}))};if(!1===i)return h();{let e;for(;;)if("u">typeof(e=h()))return e||[]}},A=e=>(0,i.randomBytes)(e),x=(e=n)=>{if("number"!=typeof e)throw Error("Illegal arguments: "+typeof e);e<4?e=4:e>31&&(e=31);let t=[];return t.push("$2a$"),e<10&&t.push("0"),t.push(e.toString()),t.push("$"),t.push(p(A(16),16)),t.join("")},E=(e=n)=>{if("number"!=typeof e)throw Error("illegal arguments: "+typeof e);return new Promise((t,r)=>g(()=>{try{t(x(e))}catch(e){r(e)}}))};function T(e,t,r,i){let n,s;if("string"!=typeof e||"string"!=typeof t){let e=Error("Invalid string / salt: Not a string");if(!1===r)return Promise.reject(e);throw e}if("$"!==t.charAt(0)||"2"!==t.charAt(1)){let e=Error("Invalid salt version: "+t.substring(0,2));if(!1===r)return Promise.reject(e);throw e}if("$"===t.charAt(2))n="\0",s=3;else{if("a"!==(n=t.charAt(2))&&"b"!==n&&"y"!==n||"$"!==t.charAt(3)){let e=Error("Invalid salt revision: "+t.substring(2,4));if(!1===r)return Promise.reject(e);throw e}s=4}if(t.charAt(s+2)>"$"){let e=Error("Missing salt rounds");if(!1===r)return Promise.reject(e);throw e}let o=10*parseInt(t.substring(s,s+1),10)+parseInt(t.substring(s+1,s+2),10),a=t.substring(s+3,s+25),l=w(e+=n>="a"?"\0":""),c=f(a,16),u=e=>{let t=[];return t.push("$2"),n>="a"&&t.push(n),t.push("$"),o<10&&t.push("0"),t.push(o.toString()),t.push("$"),t.push(p(c,c.length)),t.push(p(e,4*d.length-1)),t.join("")};return!1===r?k(l,c,o,!1,i).then(e=>u(e)):u(k(l,c,o,!0,i))}let P=(e,t,r)=>new Promise((i,n)=>{if("string"!=typeof e||"string"!=typeof t){g(()=>n(Error(`Illegal arguments: ${typeof e}, ${typeof t}`)));return}if(60!==t.length){g(()=>n(Error("Illegal hash: hash length should be 60")));return}(function(e,t,r){return"string"==typeof e&&"number"==typeof t?E(t).then(t=>T(e,t,!1,r)):"string"==typeof e&&"string"==typeof t?T(e,t,!1,r):Promise.reject(Error(`Illegal arguments: ${typeof e}, ${typeof t}`))})(e,t.substring(0,29),r).then(e=>i(e===t)).catch(e=>n(e))})},99534:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});var i=r(77910);class n{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static [i.Q]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}},77910:(e,t,r)=>{"use strict";r.d(t,{Q:()=>i,is:()=>n});let i=Symbol.for("drizzle:entityKind");function n(e,t){if(!e||"object"!=typeof e)return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,i))throw Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=e.constructor;if(r)for(;r;){if(i in r&&r[i]===t[i])return!0;r=Object.getPrototypeOf(r)}return!1}Symbol.for("drizzle:hasOwnEntityKind")},80346:(e,t,r)=>{"use strict";r.d(t,{O7:()=>a});var i=r(77910),n=r(88246);class s extends n.b1{static [i.Q]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new o(e,this.config)}}class o extends n.df{static [i.Q]="PgBoolean";getSQLType(){return"boolean"}}function a(e){return new s(e??"")}},88246:(e,t,r)=>{"use strict";r.d(t,{df:()=>f,b1:()=>p});var i=r(77910);class n{static [i.Q]="ColumnBuilder";config;constructor(e,t,r){this.config={name:e,keyAsName:""===e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){""===this.config.name&&(this.config.name=e)}}var s=r(99534),o=r(76378);class a{static [i.Q]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:t,columns:r,foreignColumns:i}=e();return{name:t,columns:r,foreignTable:i[0].table,foreignColumns:i}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=void 0===e?"no action":e,this}onDelete(e){return this._onDelete=void 0===e?"no action":e,this}build(e){return new l(e,this)}}class l{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [i.Q]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:r}=this.reference(),i=t.map(e=>e.name),n=r.map(e=>e.name),s=[this.table[o.m],...i,r[0].table[o.m],...n];return e??`${s.join("_")}_fk`}}var c=r(47589),u=r(17714);function d(e,t,r){for(let i=t;i<e.length;i++){let n=e[i];if("\\"===n){i++;continue}if('"'===n)return[e.slice(t,i).replace(/\\/g,""),i+1];if(!r&&(","===n||"}"===n))return[e.slice(t,i).replace(/\\/g,""),i]}return[e.slice(t).replace(/\\/g,""),e.length]}class p extends n{foreignKeyConfigs=[];static [i.Q]="PgColumnBuilder";array(e){return new y(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:r,actions:i})=>(0,c.t)((r,i)=>{let n=new a(()=>({columns:[e],foreignColumns:[r()]}));return i.onUpdate&&n.onUpdate(i.onUpdate),i.onDelete&&n.onDelete(i.onDelete),n.build(t)},r,i))}buildExtraConfigColumn(e){return new h(e,this.config)}}class f extends s.s{constructor(e,t){t.uniqueName||(t.uniqueName=(0,u.C$)(e,[t.name])),super(e,t),this.table=e}static [i.Q]="PgColumn"}class h extends f{static [i.Q]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}}class m{static [i.Q]=null;constructor(e,t,r,i){this.name=e,this.keyAsName=t,this.type=r,this.indexConfig=i}name;keyAsName;type;indexConfig}class y extends p{static [i.Q]="PgArrayBuilder";constructor(e,t,r){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=r}build(e){let t=this.config.baseBuilder.build(e);return new g(e,this.config,t)}}class g extends f{constructor(e,t,r,i){super(e,t),this.baseColumn=r,this.range=i,this.size=t.size}size;static [i.Q]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(e){return"string"==typeof e&&(e=function(e){let[t]=function e(t,r=0){let i=[],n=r,s=!1;for(;n<t.length;){let o=t[n];if(","===o){(s||n===r)&&i.push(""),s=!0,n++;continue}if(s=!1,"\\"===o){n+=2;continue}if('"'===o){let[e,r]=d(t,n+1,!0);i.push(e),n=r;continue}if("}"===o)return[i,n+1];if("{"===o){let[r,s]=e(t,n+1);i.push(r),n=s;continue}let[a,l]=d(t,n,!1);i.push(a),n=l}return[i,n]}(e,1);return t}(e)),e.map(e=>this.baseColumn.mapFromDriverValue(e))}mapToDriverValue(e,t=!1){let r=e.map(e=>null===e?null:(0,i.is)(this.baseColumn,g)?this.baseColumn.mapToDriverValue(e,!0):this.baseColumn.mapToDriverValue(e));return t?r:function e(t){return`{${t.map(t=>Array.isArray(t)?e(t):"string"==typeof t?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}(r)}}},82527:(e,t,r)=>{"use strict";r.d(t,{M:()=>o});var i=r(77910),n=r(73977),s=r(88246);class o extends s.b1{static [i.Q]="PgDateColumnBaseBuilder";defaultNow(){return this.default((0,n.i6)`now()`)}}},3514:(e,t,r)=>{"use strict";r.d(t,{Ec:()=>u,ch:()=>l,hT:()=>d});var i=r(77910),n=r(51101),s=r(88246),o=r(82527);class a extends o.M{static [i.Q]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new l(e,this.config)}}class l extends s.df{static [i.Q]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}class c extends o.M{static [i.Q]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new u(e,this.config)}}class u extends s.df{static [i.Q]="PgDateString";getSQLType(){return"date"}}function d(e,t){let{name:r,config:i}=(0,n.An)(e,t);return i?.mode==="date"?new a(r):new c(r)}},7261:(e,t,r)=>{"use strict";r.d(t,{O:()=>s});var i=r(77910),n=r(88246);class s extends n.b1{static [i.Q]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...r}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}},27883:(e,t,r)=>{"use strict";r.d(t,{_L:()=>l});var i=r(77910),n=r(88246),s=r(7261);class o extends s.O{static [i.Q]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new a(e,this.config)}}class a extends n.df{static [i.Q]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return"string"==typeof e?Number.parseInt(e):e}}function l(e){return new o(e??"")}},62746:(e,t,r)=>{"use strict";r.d(t,{AV:()=>a,y2:()=>o});var i=r(77910),n=r(88246);class s extends n.b1{static [i.Q]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new o(e,this.config)}}class o extends n.df{static [i.Q]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function a(e){return new s(e??"")}},33742:(e,t,r)=>{"use strict";r.d(t,{B2:()=>o,JB:()=>a});var i=r(77910),n=r(88246);class s extends n.b1{static [i.Q]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new o(e,this.config)}}class o extends n.df{static [i.Q]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function a(e){return new s(e??"")}},73649:(e,t,r)=>{"use strict";r.d(t,{OJ:()=>a,uR:()=>l});var i=r(77910),n=r(51101),s=r(88246);class o extends s.b1{static [i.Q]="PgNumericBuilder";constructor(e,t,r){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=r}build(e){return new a(e,this.config)}}class a extends s.df{static [i.Q]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function l(e,t){let{name:r,config:i}=(0,n.An)(e,t);return new o(r,i?.precision,i?.scale)}},78367:(e,t,r)=>{"use strict";r.d(t,{fL:()=>l});var i=r(77910),n=r(51101),s=r(88246);class o extends s.b1{static [i.Q]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new a(e,this.config)}}class a extends s.df{static [i.Q]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function l(e,t={}){let{name:r,config:i}=(0,n.An)(e,t);return new o(r,i)}},90659:(e,t,r)=>{"use strict";r.d(t,{XV:()=>c,vu:()=>l});var i=r(77910),n=r(51101),s=r(88246),o=r(82527);class a extends o.M{constructor(e,t,r){super(e,"string","PgTime"),this.withTimezone=t,this.precision=r,this.config.withTimezone=t,this.config.precision=r}static [i.Q]="PgTimeBuilder";build(e){return new l(e,this.config)}}class l extends s.df{static [i.Q]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`time${e}${this.withTimezone?" with time zone":""}`}}function c(e,t={}){let{name:r,config:i}=(0,n.An)(e,t);return new a(r,i.withTimezone??!1,i.precision)}},33866:(e,t,r)=>{"use strict";r.d(t,{AB:()=>d,bf:()=>u,sC:()=>l});var i=r(77910),n=r(51101),s=r(88246),o=r(82527);class a extends o.M{static [i.Q]="PgTimestampBuilder";constructor(e,t,r){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=r}build(e){return new l(e,this.config)}}class l extends s.df{static [i.Q]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":` (${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()}class c extends o.M{static [i.Q]="PgTimestampStringBuilder";constructor(e,t,r){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=r}build(e){return new u(e,this.config)}}class u extends s.df{static [i.Q]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}}function d(e,t={}){let{name:r,config:i}=(0,n.An)(e,t);return i?.mode==="string"?new c(r,i.withTimezone??!1,i.precision):new a(r,i?.withTimezone??!1,i?.precision)}},85332:(e,t,r)=>{"use strict";r.d(t,{RX:()=>a,Vj:()=>l});var i=r(77910),n=r(73977),s=r(88246);class o extends s.b1{static [i.Q]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default((0,n.i6)`gen_random_uuid()`)}build(e){return new a(e,this.config)}}class a extends s.df{static [i.Q]="PgUUID";getSQLType(){return"uuid"}}function l(e){return new o(e??"")}},45220:(e,t,r)=>{"use strict";r.d(t,{L7:()=>l});var i=r(77910),n=r(51101),s=r(88246);class o extends s.b1{static [i.Q]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new a(e,this.config)}}class a extends s.df{static [i.Q]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function l(e,t={}){let{name:r,config:i}=(0,n.An)(e,t);return new o(r,i)}},49141:(e,t,r)=>{"use strict";r.d(t,{YA:()=>eq,af:()=>eM});var i=r(77910),n=r(65702),s=r(51101),o=r(88246),a=r(7261);class l extends a.O{static [i.Q]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new c(e,this.config)}}class c extends o.df{static [i.Q]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class u extends a.O{static [i.Q]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new d(e,this.config)}}class d extends o.df{static [i.Q]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}function p(e,t){let{name:r,config:i}=(0,s.An)(e,t);return"number"===i.mode?new l(r):new u(r)}class f extends o.b1{static [i.Q]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new h(e,this.config)}}class h extends o.df{static [i.Q]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class m extends o.b1{static [i.Q]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new y(e,this.config)}}class y extends o.df{static [i.Q]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}function g(e,t){let{name:r,config:i}=(0,s.An)(e,t);return"number"===i.mode?new f(r):new m(r)}var w=r(80346);class b extends o.b1{static [i.Q]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new v(e,this.config)}}class v extends o.df{static [i.Q]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function _(e,t={}){let{name:r,config:i}=(0,s.An)(e,t);return new b(r,i)}class S extends o.b1{static [i.Q]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new k(e,this.config)}}class k extends o.df{static [i.Q]="PgCidr";getSQLType(){return"cidr"}}function A(e){return new S(e??"")}class x extends o.b1{static [i.Q]="PgCustomColumnBuilder";constructor(e,t,r){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new E(e,this.config)}}class E extends o.df{static [i.Q]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return"function"==typeof this.mapFrom?this.mapFrom(e):e}mapToDriverValue(e){return"function"==typeof this.mapTo?this.mapTo(e):e}}function T(e){return(t,r)=>{let{name:i,config:n}=(0,s.An)(t,r);return new x(i,n,e)}}var P=r(3514);class C extends o.b1{static [i.Q]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new $(e,this.config)}}class $ extends o.df{static [i.Q]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return"string"==typeof e?Number.parseFloat(e):e}}function O(e){return new C(e??"")}class j extends o.b1{static [i.Q]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new R(e,this.config)}}class R extends o.df{static [i.Q]="PgInet";getSQLType(){return"inet"}}function U(e){return new j(e??"")}var N=r(27883);class I extends o.b1{static [i.Q]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new D(e,this.config)}}class D extends o.df{static [i.Q]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}function L(e,t={}){let{name:r,config:i}=(0,s.An)(e,t);return new I(r,i)}var Q=r(62746),B=r(33742);class q extends o.b1{static [i.Q]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new M(e,this.config)}}class M extends o.df{static [i.Q]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,i]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r),Number.parseFloat(i)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}class z extends o.b1{static [i.Q]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new H(e,this.config)}}class H extends o.df{static [i.Q]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,r,i]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(r),c:Number.parseFloat(i)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}function K(e,t){let{name:r,config:i}=(0,s.An)(e,t);return i?.mode&&"tuple"!==i.mode?new z(r):new q(r)}class W extends o.b1{static [i.Q]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new F(e,this.config)}}class F extends o.df{static [i.Q]="PgMacaddr";getSQLType(){return"macaddr"}}function J(e){return new W(e??"")}class V extends o.b1{static [i.Q]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new G(e,this.config)}}class G extends o.df{static [i.Q]="PgMacaddr8";getSQLType(){return"macaddr8"}}function Z(e){return new V(e??"")}var X=r(73649);class Y extends o.b1{static [i.Q]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new ee(e,this.config)}}class ee extends o.df{static [i.Q]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,r]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(r)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}class et extends o.b1{static [i.Q]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new er(e,this.config)}}class er extends o.df{static [i.Q]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,r]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(r)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}function ei(e,t){let{name:r,config:i}=(0,s.An)(e,t);return i?.mode&&"tuple"!==i.mode?new et(r):new Y(r)}function en(e,t){let r=new DataView(new ArrayBuffer(8));for(let i=0;i<8;i++)r.setUint8(i,e[t+i]);return r.getFloat64(0,!0)}function es(e){let t=function(e){let t=[];for(let r=0;r<e.length;r+=2)t.push(Number.parseInt(e.slice(r,r+2),16));return new Uint8Array(t)}(e),r=0,i=t[0];r+=1;let n=new DataView(t.buffer),s=n.getUint32(r,1===i);if(r+=4,536870912&s&&(n.getUint32(r,1===i),r+=4),(65535&s)==1){let e=en(t,r),i=en(t,r+=8);return r+=8,[e,i]}throw Error("Unsupported geometry type")}class eo extends o.b1{static [i.Q]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new ea(e,this.config)}}class ea extends o.df{static [i.Q]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return es(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}class el extends o.b1{static [i.Q]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new ec(e,this.config)}}class ec extends o.df{static [i.Q]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=es(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}function eu(e,t){let{name:r,config:i}=(0,s.An)(e,t);return i?.mode&&"tuple"!==i.mode?new el(r):new eo(r)}class ed extends o.b1{static [i.Q]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new ep(e,this.config)}}class ep extends o.df{static [i.Q]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>"string"==typeof e?Number.parseFloat(e):e}function ef(e){return new ed(e??"")}class eh extends o.b1{static [i.Q]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new em(e,this.config)}}class em extends o.df{static [i.Q]="PgSerial";getSQLType(){return"serial"}}function ey(e){return new eh(e??"")}class eg extends a.O{static [i.Q]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new ew(e,this.config)}}class ew extends o.df{static [i.Q]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>"string"==typeof e?Number(e):e}function eb(e){return new eg(e??"")}class ev extends o.b1{static [i.Q]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new e_(e,this.config)}}class e_ extends o.df{static [i.Q]="PgSmallSerial";getSQLType(){return"smallserial"}}function eS(e){return new ev(e??"")}var ek=r(78367),eA=r(90659),ex=r(33866),eE=r(85332),eT=r(45220);class eP extends o.b1{static [i.Q]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new eC(e,this.config)}}class eC extends o.df{static [i.Q]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function e$(e,t){let{name:r,config:i}=(0,s.An)(e,t);return new eP(r,i)}class eO extends o.b1{static [i.Q]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new ej(e,this.config)}}class ej extends o.df{static [i.Q]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function eR(e,t){let{name:r,config:i}=(0,s.An)(e,t);return new eO(r,i)}class eU extends o.b1{static [i.Q]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new eN(e,this.config)}}class eN extends o.df{static [i.Q]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function eI(e,t){let{name:r,config:i}=(0,s.An)(e,t);return new eU(r,i)}class eD extends o.b1{static [i.Q]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new eL(e,this.config)}}class eL extends o.df{static [i.Q]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function eQ(e,t){let{name:r,config:i}=(0,s.An)(e,t);return new eD(r,i)}let eB=Symbol.for("drizzle:PgInlineForeignKeys");class eq extends n.iA{static [i.Q]="PgTable";static Symbol=Object.assign({},n.iA.Symbol,{InlineForeignKeys:eB});[eB]=[];[n.iA.Symbol.ExtraConfigBuilder]=void 0}let eM=(e,t,r)=>(function(e,t,r,i,s=e){let o=new eq(e,i,s),a="function"==typeof t?t({bigint:p,bigserial:g,boolean:w.O7,char:_,cidr:A,customType:T,date:P.hT,doublePrecision:O,inet:U,integer:N._L,interval:L,json:Q.AV,jsonb:B.JB,line:K,macaddr:J,macaddr8:Z,numeric:X.uR,point:ei,geometry:eu,real:ef,serial:ey,smallint:eb,smallserial:eS,text:ek.fL,time:eA.XV,timestamp:ex.AB,uuid:eE.Vj,varchar:eT.L7,bit:e$,halfvec:eR,sparsevec:eI,vector:eQ}):t,l=Object.fromEntries(Object.entries(a).map(([e,t])=>{t.setName(e);let r=t.build(o);return o[eB].push(...t.buildForeignKeys(r,o)),[e,r]})),c=Object.fromEntries(Object.entries(a).map(([e,t])=>(t.setName(e),[e,t.buildExtraConfigColumn(o)]))),u=Object.assign(o,l);return u[n.iA.Symbol.Columns]=l,u[n.iA.Symbol.ExtraConfigColumns]=c,r&&(u[eq.Symbol.ExtraConfigBuilder]=r),u})(e,t,r,void 0)},17714:(e,t,r)=>{"use strict";r.d(t,{C$:()=>o,Tw:()=>s});var i=r(77910),n=r(76378);function s(e){return new l(e)}function o(e,t){return`${e[n.m]}_${t.join("_")}_unique`}class a{constructor(e,t){this.name=t,this.columns=e}static [i.Q]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new c(e,this.columns,this.nullsNotDistinctConfig,this.name)}}class l{static [i.Q]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new a(e,this.name)}}class c{constructor(e,t,r,i){this.table=e,this.columns=t,this.name=i??o(this.table,this.columns.map(e=>e.name)),this.nullsNotDistinct=r}static [i.Q]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}},19975:(e,t,r)=>{"use strict";r.d(t,{t:()=>eE});var i=r(77910);class n{static [i.Q]="ConsoleLogWriter";write(e){console.log(e)}}class s{static [i.Q]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new n}logQuery(e,t){let r=t.map(e=>{try{return JSON.stringify(e)}catch{return String(e)}}),i=r.length?` -- params: [${r.join(", ")}]`:"";this.writer.write(`Query: ${e}${i}`)}}class o{static [i.Q]="NoopLogger";logQuery(){}}var a=r(99534),l=r(73977),c=r(65702),u=r(7155);class d{constructor(e){this.table=e}static [i.Q]="ColumnAliasProxyHandler";get(e,t){return"table"===t?this.table:e[t]}}class p{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static [i.Q]="TableAliasProxyHandler";get(e,t){if(t===c.iA.Symbol.IsAlias)return!0;if(t===c.iA.Symbol.Name||this.replaceOriginalName&&t===c.iA.Symbol.OriginalName)return this.alias;if(t===u.d)return{...e[u.d],name:this.alias,isAlias:!0};if(t===c.iA.Symbol.Columns){let t=e[c.iA.Symbol.Columns];if(!t)return t;let r={};return Object.keys(t).map(i=>{r[i]=new Proxy(t[i],new d(new Proxy(e,this)))}),r}let r=e[t];return(0,i.is)(r,a.s)?new Proxy(r,new d(new Proxy(e,this))):r}}class f{constructor(e){this.alias=e}static [i.Q]=null;get(e,t){return"sourceTable"===t?h(e.sourceTable,this.alias):e[t]}}function h(e,t){return new Proxy(e,new p(t,!1))}function m(e,t){return new Proxy(e,new d(new Proxy(e.table,new p(t,!1))))}function y(e,t){return new l.$s.Aliased(g(e.sql,t),e.fieldAlias)}function g(e,t){return l.i6.join(e.queryChunks.map(e=>(0,i.is)(e,a.s)?m(e,t):(0,i.is)(e,l.$s)?g(e,t):(0,i.is)(e,l.$s.Aliased)?y(e,t):e))}function w(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(e=>e.toLowerCase()).join("_")}function b(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((e,t,r)=>e+(0===r?t.toLowerCase():`${t[0].toUpperCase()}${t.slice(1)}`),"")}function v(e){return e}class _{static [i.Q]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert="snake_case"===e?w:"camelCase"===e?b:v}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[c.iA.Symbol.Schema]??"public",r=e.table[c.iA.Symbol.OriginalName],i=`${t}.${r}.${e.name}`;return this.cache[i]||this.cacheTable(e.table),this.cache[i]}cacheTable(e){let t=e[c.iA.Symbol.Schema]??"public",r=e[c.iA.Symbol.OriginalName],i=`${t}.${r}`;if(!this.cachedTables[i]){for(let t of Object.values(e[c.iA.Symbol.Columns])){let e=`${i}.${t.name}`;this.cache[e]=this.convert(t.name)}this.cachedTables[i]=!0}}clearCache(){this.cache={},this.cachedTables={}}}class S extends Error{static [i.Q]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}}class k extends S{static [i.Q]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}var A=r(88246),x=r(33742),E=r(62746),T=r(73649),P=r(90659),C=r(33866),$=r(3514),O=r(85332),j=r(49141);class R{static [i.Q]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new U(e,this.columns,this.name)}}class U{constructor(e,t,r){this.table=e,this.columns=t,this.name=r}static [i.Q]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[j.YA.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}var N=r(40986),I=r(6931);class D{constructor(e,t,r){this.sourceTable=e,this.referencedTable=t,this.relationName=r,this.referencedTableName=t[c.iA.Symbol.Name]}static [i.Q]="Relation";referencedTableName;fieldName}class L{constructor(e,t){this.table=e,this.config=t}static [i.Q]="Relations"}class Q extends D{constructor(e,t,r,i){super(e,t,r?.relationName),this.config=r,this.isNullable=i}static [i.Q]="One";withFieldName(e){let t=new Q(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}}class B extends D{constructor(e,t,r){super(e,t,r?.relationName),this.config=r}static [i.Q]="Many";withFieldName(e){let t=new B(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}}function q(e){return{one:function(t,r){return new Q(e,t,r,r?.fields.reduce((e,t)=>e&&t.notNull,!0)??!1)},many:function(t,r){return new B(e,t,r)}}}var M=r(77805),z=r(51101);class H extends l.G7{static [i.Q]="PgViewBase"}class K{static [i.Q]="PgDialect";casing;constructor(e){this.casing=new _(e?.casing)}async migrate(e,t,r){let i="string"==typeof r?"__drizzle_migrations":r.migrationsTable??"__drizzle_migrations",n="string"==typeof r?"drizzle":r.migrationsSchema??"drizzle",s=(0,l.i6)`
			CREATE TABLE IF NOT EXISTS ${l.i6.identifier(n)}.${l.i6.identifier(i)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute((0,l.i6)`CREATE SCHEMA IF NOT EXISTS ${l.i6.identifier(n)}`),await t.execute(s);let o=(await t.all((0,l.i6)`select id, hash, created_at from ${l.i6.identifier(n)}.${l.i6.identifier(i)} order by created_at desc limit 1`))[0];await t.transaction(async t=>{for await(let r of e)if(!o||Number(o.created_at)<r.folderMillis){for(let e of r.sql)await t.execute(l.i6.raw(e));await t.execute((0,l.i6)`insert into ${l.i6.identifier(n)}.${l.i6.identifier(i)} ("hash", "created_at") values(${r.hash}, ${r.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[(0,l.i6)`with `];for(let[r,i]of e.entries())t.push((0,l.i6)`${l.i6.identifier(i._.alias)} as (${i._.sql})`),r<e.length-1&&t.push((0,l.i6)`, `);return t.push((0,l.i6)` `),l.i6.join(t)}buildDeleteQuery({table:e,where:t,returning:r,withList:i}){let n=this.buildWithCTE(i),s=r?(0,l.i6)` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,o=t?(0,l.i6)` where ${t}`:void 0;return(0,l.i6)`${n}delete from ${e}${o}${s}`}buildUpdateSet(e,t){let r=e[c.iA.Symbol.Columns],i=Object.keys(r).filter(e=>void 0!==t[e]||r[e]?.onUpdateFn!==void 0),n=i.length;return l.i6.join(i.flatMap((e,i)=>{let s=r[e],o=t[e]??l.i6.param(s.onUpdateFn(),s),a=(0,l.i6)`${l.i6.identifier(this.casing.getColumnCasing(s))} = ${o}`;return i<n-1?[a,l.i6.raw(", ")]:[a]}))}buildUpdateQuery({table:e,set:t,where:r,returning:i,withList:n}){let s=this.buildWithCTE(n),o=this.buildUpdateSet(e,t),a=i?(0,l.i6)` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,c=r?(0,l.i6)` where ${r}`:void 0;return(0,l.i6)`${s}update ${e} set ${o}${c}${a}`}buildSelection(e,{isSingleTable:t=!1}={}){let r=e.length,n=e.flatMap(({field:e},n)=>{let s=[];if((0,i.is)(e,l.$s.Aliased)&&e.isSelectionField)s.push(l.i6.identifier(e.fieldAlias));else if((0,i.is)(e,l.$s.Aliased)||(0,i.is)(e,l.$s)){let r=(0,i.is)(e,l.$s.Aliased)?e.sql:e;t?s.push(new l.$s(r.queryChunks.map(e=>(0,i.is)(e,A.df)?l.i6.identifier(this.casing.getColumnCasing(e)):e))):s.push(r),(0,i.is)(e,l.$s.Aliased)&&s.push((0,l.i6)` as ${l.i6.identifier(e.fieldAlias)}`)}else(0,i.is)(e,a.s)&&(t?s.push(l.i6.identifier(this.casing.getColumnCasing(e))):s.push(e));return n<r-1&&s.push((0,l.i6)`, `),s});return l.i6.join(n)}buildSelectQuery({withList:e,fields:t,fieldsFlat:r,where:n,having:s,table:o,joins:d,orderBy:p,groupBy:f,limit:h,offset:m,lockingClause:y,distinct:g,setOperators:w}){let b,v,_;let S=r??(0,z.ZS)(t);for(let e of S){let t;if((0,i.is)(e.field,a.s)&&(0,c.SP)(e.field.table)!==((0,i.is)(o,M.k)?o._.alias:(0,i.is)(o,H)?o[u.d].name:(0,i.is)(o,l.$s)?void 0:(0,c.SP)(o))&&(t=e.field.table,!d?.some(({alias:e})=>e===(t[c.iA.Symbol.IsAlias]?c.SP(t):t[c.iA.Symbol.BaseName])))){let t=(0,c.SP)(e.field.table);throw Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}}let k=!d||0===d.length,A=this.buildWithCTE(e);g&&(b=!0===g?(0,l.i6)` distinct`:(0,l.i6)` distinct on (${l.i6.join(g.on,(0,l.i6)`, `)})`);let x=this.buildSelection(S,{isSingleTable:k}),E=(()=>{if((0,i.is)(o,c.iA)&&o[c.iA.Symbol.OriginalName]!==o[c.iA.Symbol.Name]){let e=(0,l.i6)`${l.i6.identifier(o[c.iA.Symbol.OriginalName])}`;return o[c.iA.Symbol.Schema]&&(e=(0,l.i6)`${l.i6.identifier(o[c.iA.Symbol.Schema])}.${e}`),(0,l.i6)`${e} ${l.i6.identifier(o[c.iA.Symbol.Name])}`}return o})(),T=[];if(d)for(let[e,t]of d.entries()){0===e&&T.push((0,l.i6)` `);let r=t.table,n=t.lateral?(0,l.i6)` lateral`:void 0;if((0,i.is)(r,j.YA)){let e=r[j.YA.Symbol.Name],i=r[j.YA.Symbol.Schema],s=r[j.YA.Symbol.OriginalName],o=e===s?void 0:t.alias;T.push((0,l.i6)`${l.i6.raw(t.joinType)} join${n} ${i?(0,l.i6)`${l.i6.identifier(i)}.`:void 0}${l.i6.identifier(s)}${o&&(0,l.i6)` ${l.i6.identifier(o)}`} on ${t.on}`)}else if((0,i.is)(r,l.G7)){let e=r[u.d].name,i=r[u.d].schema,s=r[u.d].originalName,o=e===s?void 0:t.alias;T.push((0,l.i6)`${l.i6.raw(t.joinType)} join${n} ${i?(0,l.i6)`${l.i6.identifier(i)}.`:void 0}${l.i6.identifier(s)}${o&&(0,l.i6)` ${l.i6.identifier(o)}`} on ${t.on}`)}else T.push((0,l.i6)`${l.i6.raw(t.joinType)} join${n} ${r} on ${t.on}`);e<d.length-1&&T.push((0,l.i6)` `)}let P=l.i6.join(T),C=n?(0,l.i6)` where ${n}`:void 0,$=s?(0,l.i6)` having ${s}`:void 0;p&&p.length>0&&(v=(0,l.i6)` order by ${l.i6.join(p,(0,l.i6)`, `)}`),f&&f.length>0&&(_=(0,l.i6)` group by ${l.i6.join(f,(0,l.i6)`, `)}`);let O="object"==typeof h||"number"==typeof h&&h>=0?(0,l.i6)` limit ${h}`:void 0,R=m?(0,l.i6)` offset ${m}`:void 0,U=l.i6.empty();if(y){let e=(0,l.i6)` for ${l.i6.raw(y.strength)}`;y.config.of&&e.append((0,l.i6)` of ${l.i6.join(Array.isArray(y.config.of)?y.config.of:[y.config.of],(0,l.i6)`, `)}`),y.config.noWait?e.append((0,l.i6)` no wait`):y.config.skipLocked&&e.append((0,l.i6)` skip locked`),U.append(e)}let N=(0,l.i6)`${A}select${b} ${x} from ${E}${P}${C}${_}${$}${v}${O}${R}${U}`;return w.length>0?this.buildSetOperations(N,w):N}buildSetOperations(e,t){let[r,...i]=t;if(!r)throw Error("Cannot pass undefined values to any set operator");return 0===i.length?this.buildSetOperationQuery({leftSelect:e,setOperator:r}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:r}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:r,rightSelect:n,limit:s,orderBy:o,offset:a}}){let c;let u=(0,l.i6)`(${e.getSQL()}) `,d=(0,l.i6)`(${n.getSQL()})`;if(o&&o.length>0){let e=[];for(let t of o)if((0,i.is)(t,A.df))e.push(l.i6.identifier(t.name));else if((0,i.is)(t,l.$s)){for(let e=0;e<t.queryChunks.length;e++){let r=t.queryChunks[e];(0,i.is)(r,A.df)&&(t.queryChunks[e]=l.i6.identifier(r.name))}e.push((0,l.i6)`${t}`)}else e.push((0,l.i6)`${t}`);c=(0,l.i6)` order by ${l.i6.join(e,(0,l.i6)`, `)} `}let p="object"==typeof s||"number"==typeof s&&s>=0?(0,l.i6)` limit ${s}`:void 0,f=l.i6.raw(`${t} ${r?"all ":""}`),h=a?(0,l.i6)` offset ${a}`:void 0;return(0,l.i6)`${u}${f}${d}${c}${p}${h}`}buildInsertQuery({table:e,values:t,onConflict:r,returning:n,withList:s}){let o=[],a=Object.entries(e[c.iA.Symbol.Columns]).filter(([e,t])=>!t.shouldDisableInsert()),u=a.map(([,e])=>l.i6.identifier(this.casing.getColumnCasing(e)));for(let[e,r]of t.entries()){let n=[];for(let[e,t]of a){let s=r[e];if(void 0===s||(0,i.is)(s,l.dO)&&void 0===s.value){if(void 0!==t.defaultFn){let e=t.defaultFn(),r=(0,i.is)(e,l.$s)?e:l.i6.param(e,t);n.push(r)}else if(t.default||void 0===t.onUpdateFn)n.push((0,l.i6)`default`);else{let e=t.onUpdateFn(),r=(0,i.is)(e,l.$s)?e:l.i6.param(e,t);n.push(r)}}else n.push(s)}o.push(n),e<t.length-1&&o.push((0,l.i6)`, `)}let d=this.buildWithCTE(s),p=l.i6.join(o),f=n?(0,l.i6)` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,h=r?(0,l.i6)` on conflict ${r}`:void 0;return(0,l.i6)`${d}insert into ${e} ${u} values ${p}${h}${f}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:r}){let i=t?(0,l.i6)` concurrently`:void 0,n=r?(0,l.i6)` with no data`:void 0;return(0,l.i6)`refresh materialized view${i} ${e}${n}`}prepareTyping(e){return(0,i.is)(e,x.B2)||(0,i.is)(e,E.y2)?"json":(0,i.is)(e,T.OJ)?"decimal":(0,i.is)(e,P.vu)?"time":(0,i.is)(e,C.sC)||(0,i.is)(e,C.bf)?"timestamp":(0,i.is)(e,$.ch)||(0,i.is)(e,$.Ec)?"date":(0,i.is)(e,O.RX)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:n,tableConfig:s,queryConfig:o,tableAlias:u,nestedQueryRelation:d,joinOn:p}){let f,w=[],b,v,_=[],k,A=[];if(!0===o)w=Object.entries(s.columns).map(([e,t])=>({dbKey:t.name,tsKey:e,field:m(t,u),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let n=Object.fromEntries(Object.entries(s.columns).map(([e,t])=>[e,m(t,u)]));if(o.where){let e="function"==typeof o.where?o.where(n,{and:N.xD,between:N.vX,eq:N.eq,exists:N.Gg,gt:N.gt,gte:N.eg,ilike:N.o$,inArray:N.d3,isNull:N.Ft,isNotNull:N.K0,like:N.vL,lt:N.lt,lte:N.G,ne:N.ne,not:N.ff,notBetween:N.OL,notExists:N.UN,notLike:N.Qg,notIlike:N.mM,notInArray:N.Nl,or:N.or,sql:l.i6}):o.where;k=e&&g(e,u)}let d=[],p=[];if(o.columns){let e=!1;for(let[t,r]of Object.entries(o.columns))void 0!==r&&t in s.columns&&(e||!0!==r||(e=!0),p.push(t));p.length>0&&(p=e?p.filter(e=>o.columns?.[e]===!0):Object.keys(s.columns).filter(e=>!p.includes(e)))}else p=Object.keys(s.columns);for(let e of p){let t=s.columns[e];d.push({tsKey:e,value:t})}let f=[];if(o.with&&(f=Object.entries(o.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:s.relations[e]}))),o.extras)for(let[e,t]of Object.entries("function"==typeof o.extras?o.extras(n,{sql:l.i6}):o.extras))d.push({tsKey:e,value:y(t,u)});for(let{tsKey:e,value:t}of d)w.push({dbKey:(0,i.is)(t,l.$s.Aliased)?t.fieldAlias:s.columns[e].name,tsKey:e,field:(0,i.is)(t,a.s)?m(t,u):t,relationTableTsKey:void 0,isJson:!1,selection:[]});let h="function"==typeof o.orderBy?o.orderBy(n,{sql:l.i6,asc:I.d,desc:I.C}):o.orderBy??[];for(let{tsKey:n,queryConfig:s,relation:d}of(Array.isArray(h)||(h=[h]),_=h.map(e=>(0,i.is)(e,a.s)?m(e,u):g(e,u)),b=o.limit,v=o.offset,f)){let o=function(e,t,r){if((0,i.is)(r,Q)&&r.config)return{fields:r.config.fields,references:r.config.references};let n=t[(0,c.Q0)(r.referencedTable)];if(!n)throw Error(`Table "${r.referencedTable[c.iA.Symbol.Name]}" not found in schema`);let s=e[n];if(!s)throw Error(`Table "${n}" not found in schema`);let o=r.sourceTable,a=t[(0,c.Q0)(o)];if(!a)throw Error(`Table "${o[c.iA.Symbol.Name]}" not found in schema`);let l=[];for(let e of Object.values(s.relations))(r.relationName&&r!==e&&e.relationName===r.relationName||!r.relationName&&e.referencedTable===r.sourceTable)&&l.push(e);if(l.length>1)throw r.relationName?Error(`There are multiple relations with name "${r.relationName}" in table "${n}"`):Error(`There are multiple relations between "${n}" and "${r.sourceTable[c.iA.Symbol.Name]}". Please specify relation name`);if(l[0]&&(0,i.is)(l[0],Q)&&l[0].config)return{fields:l[0].config.references,references:l[0].config.fields};throw Error(`There is not enough information to infer relation "${a}.${r.fieldName}"`)}(t,r,d),a=r[(0,c.Q0)(d.referencedTable)],p=`${u}_${n}`,f=(0,N.xD)(...o.fields.map((e,t)=>(0,N.eq)(m(o.references[t],p),m(e,u)))),h=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:r,table:e[a],tableConfig:t[a],queryConfig:(0,i.is)(d,Q)?!0===s?{limit:1}:{...s,limit:1}:s,tableAlias:p,joinOn:f,nestedQueryRelation:d}),y=(0,l.i6)`${l.i6.identifier(p)}.${l.i6.identifier("data")}`.as(n);A.push({on:(0,l.i6)`true`,table:new M.k(h.sql,{},p),alias:p,joinType:"left",lateral:!0}),w.push({dbKey:n,tsKey:n,field:y,relationTableTsKey:a,isJson:!0,selection:h.selection})}}if(0===w.length)throw new S({message:`No fields selected for table "${s.tsName}" ("${u}")`});if(k=(0,N.xD)(p,k),d){let e=(0,l.i6)`json_build_array(${l.i6.join(w.map(({field:e,tsKey:t,isJson:r})=>r?(0,l.i6)`${l.i6.identifier(`${u}_${t}`)}.${l.i6.identifier("data")}`:(0,i.is)(e,l.$s.Aliased)?e.sql:e),(0,l.i6)`, `)})`;(0,i.is)(d,B)&&(e=(0,l.i6)`coalesce(json_agg(${e}${_.length>0?(0,l.i6)` order by ${l.i6.join(_,(0,l.i6)`, `)}`:void 0}), '[]'::json)`);let t=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:s.tsName,selection:w}];void 0!==b||void 0!==v||_.length>0?(f=this.buildSelectQuery({table:h(n,u),fields:{},fieldsFlat:[{path:[],field:l.i6.raw("*")}],where:k,limit:b,offset:v,orderBy:_,setOperators:[]}),k=void 0,b=void 0,v=void 0,_=[]):f=h(n,u),f=this.buildSelectQuery({table:(0,i.is)(f,j.YA)?f:new M.k(f,{},u),fields:{},fieldsFlat:t.map(({field:e})=>({path:[],field:(0,i.is)(e,a.s)?m(e,u):e})),joins:A,where:k,limit:b,offset:v,orderBy:_,setOperators:[]})}else f=this.buildSelectQuery({table:h(n,u),fields:{},fieldsFlat:w.map(({field:e})=>({path:[],field:(0,i.is)(e,a.s)?m(e,u):e})),joins:A,where:k,limit:b,offset:v,orderBy:_,setOperators:[]});return{tableTsKey:s.tsName,sql:f,selection:w}}}class W{static [i.Q]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if("_"===t)return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===u.d)return{...e[u.d],selectedFields:new Proxy(e[u.d].selectedFields,this)};if("symbol"==typeof t)return e[t];let r=((0,i.is)(e,M.k)?e._.selectedFields:(0,i.is)(e,l.G7)?e[u.d].selectedFields:e)[t];if((0,i.is)(r,l.$s.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!r.isSelectionField)return r.sql;let e=r.clone();return e.isSelectionField=!0,e}if((0,i.is)(r,l.$s)){if("sql"===this.config.sqlBehavior)return r;throw Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return(0,i.is)(r,a.s)?this.config.alias?new Proxy(r,new d(new Proxy(r.table,new p(this.config.alias,this.config.replaceOriginalName??!1)))):r:"object"!=typeof r||null===r?r:new Proxy(r,new W(this.config))}}class F{static [i.Q]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class J{static [i.Q]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}var V=r(23111);class G{static [i.Q]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}from(e){let t;let r=!!this.fields;return t=this.fields?this.fields:(0,i.is)(e,M.k)?Object.fromEntries(Object.keys(e._.selectedFields).map(t=>[t,e[t]])):(0,i.is)(e,H)?e[u.d].selectedFields:(0,i.is)(e,l.$s)?{}:(0,z.SS)(e),new X({table:e,fields:t,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class Z extends F{static [i.Q]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:r,session:i,dialect:n,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...t},distinct:o,setOperators:[]},this.isPartialSelect=r,this.session=i,this.dialect=n,this._={selectedFields:t},this.tableName=(0,z.dP)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(e){return(t,r)=>{let n=this.tableName,s=(0,z.dP)(t);if("string"==typeof s&&this.config.joins?.some(e=>e.alias===s))throw Error(`Alias "${s}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof n&&(this.config.fields={[n]:this.config.fields}),"string"==typeof s&&!(0,i.is)(t,l.$s))){let e=(0,i.is)(t,M.k)?t._.selectedFields:(0,i.is)(t,l.G7)?t[u.d].selectedFields:t[c.iA.Symbol.Columns];this.config.fields[s]=e}if("function"==typeof r&&(r=r(new Proxy(this.config.fields,new W({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:r,table:t,joinType:e,alias:s}),"string"==typeof s)switch(e){case"left":this.joinsNotNullableMap[s]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[s]=!0;break;case"inner":this.joinsNotNullableMap[s]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[s]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return r=>{let i="function"==typeof r?r(ee()):r;if(!(0,z.ux)(this.getSelectedFields(),i.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:i}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new W({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new W({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new W({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new W({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),r=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=e:this.config.orderBy=e;return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new M.k(this.getSQL(),this.config.fields,e),new W({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new W({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class X extends Z{static [i.Q]="PgSelect";_prepare(e){let{session:t,config:r,dialect:i,joinsNotNullableMap:n}=this;if(!t)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");return V.Z.startActiveSpan("drizzle.prepareQuery",()=>{let s=(0,z.ZS)(r.fields),o=t.prepareQuery(i.sqlToQuery(this.getSQL()),s,e,!0);return o.joinsNotNullableMap=n,o})}prepare(e){return this._prepare(e)}execute=e=>V.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))}function Y(e,t){return(r,i,...n)=>{let s=[i,...n].map(r=>({type:e,isAll:t,rightSelect:r}));for(let e of s)if(!(0,z.ux)(r.getSelectedFields(),e.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(s)}}(0,z.ef)(X,[J]);let ee=()=>({union:et,unionAll:er,intersect:ei,intersectAll:en,except:es,exceptAll:eo}),et=Y("union",!1),er=Y("union",!0),ei=Y("intersect",!1),en=Y("intersect",!0),es=Y("except",!1),eo=Y("except",!0);class ea{static [i.Q]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=(0,i.is)(e,K)?e:void 0,this.dialectConfig=(0,i.is)(e,K)?void 0:e}$with(e){let t=this;return{as:r=>("function"==typeof r&&(r=r(t)),new Proxy(new M.S(r.getSQL(),r.getSelectedFields(),e,!0),new W({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...e){let t=this;return{select:function(r){return new G({fields:r??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(e){return new G({fields:e??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})},selectDistinctOn:function(e,r){return new G({fields:r??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:e}})}}}select(e){return new G({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new G({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new G({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new K(this.dialectConfig)),this.dialect}}class el{constructor(e,t,r,i){this.table=e,this.session=t,this.dialect=r,this.withList=i}static [i.Q]="PgUpdateBuilder";set(e){return new ec(this.table,(0,z.M6)(this.table,e),this.session,this.dialect,this.withList)}}class ec extends J{constructor(e,t,r,i,n){super(),this.session=r,this.dialect=i,this.config={set:t,table:e,withList:n}}static [i.Q]="PgUpdate";config;where(e){return this.config.where=e,this}returning(e=this.config.table[c.iA.Symbol.Columns]){return this.config.returning=(0,z.ZS)(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0)}prepare(e){return this._prepare(e)}execute=e=>this._prepare().execute(e);$dynamic(){return this}}class eu{constructor(e,t,r,i){this.table=e,this.session=t,this.dialect=r,this.withList=i}static [i.Q]="PgInsertBuilder";values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw Error("values() must be called with at least one value");let t=e.map(e=>{let t={},r=this.table[c.iA.Symbol.Columns];for(let n of Object.keys(e)){let s=e[n];t[n]=(0,i.is)(s,l.$s)?s:new l.dO(s,r[n])}return t});return new ed(this.table,t,this.session,this.dialect,this.withList)}}class ed extends J{constructor(e,t,r,i,n){super(),this.session=r,this.dialect=i,this.config={table:e,values:t,withList:n}}static [i.Q]="PgInsert";config;returning(e=this.config.table[c.iA.Symbol.Columns]){return this.config.returning=(0,z.ZS)(e),this}onConflictDoNothing(e={}){if(void 0===e.target)this.config.onConflict=(0,l.i6)`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let r=e.where?(0,l.i6)` where ${e.where}`:void 0;this.config.onConflict=(0,l.i6)`(${l.i6.raw(t)})${r} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?(0,l.i6)` where ${e.where}`:void 0,r=e.targetWhere?(0,l.i6)` where ${e.targetWhere}`:void 0,i=e.setWhere?(0,l.i6)` where ${e.setWhere}`:void 0,n=this.dialect.buildUpdateSet(this.config.table,(0,z.M6)(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=(0,l.i6)`(${l.i6.raw(s)})${r} do update set ${n}${t}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return V.Z.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}execute=e=>V.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e));$dynamic(){return this}}class ep extends J{constructor(e,t,r,i){super(),this.session=t,this.dialect=r,this.config={table:e,withList:i}}static [i.Q]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[c.iA.Symbol.Columns]){return this.config.returning=(0,z.ZS)(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return V.Z.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}execute=e=>V.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e));$dynamic(){return this}}class ef extends l.$s{constructor(e){super(ef.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=ef.buildCount(e.source,e.filters)}sql;static [i.Q]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return(0,l.i6)`(select count(*) from ${e}${l.i6.raw(" where ").if(t)}${t})`}static buildCount(e,t){return(0,l.i6)`select count(*) as count from ${e}${l.i6.raw(" where ").if(t)}${t};`}then(e,t){return Promise.resolve(this.session.count(this.sql)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}}class eh{constructor(e,t,r,i,n,s,o){this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=i,this.tableConfig=n,this.dialect=s,this.session=o}static [i.Q]="PgRelationalQueryBuilder";findMany(e){return new em(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new em(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class em extends J{constructor(e,t,r,i,n,s,o,a,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=r,this.table=i,this.tableConfig=n,this.dialect=s,this.session=o,this.config=a,this.mode=l}static [i.Q]="PgRelationalQuery";_prepare(e){return V.Z.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:r}=this._toSQL();return this.session.prepareQuery(r,void 0,e,!0,(e,r)=>{let n=e.map(e=>(function e(t,r,n,s,o=e=>e){let c={};for(let[u,d]of s.entries())if(d.isJson){let s=r.relations[d.tsKey],a=n[u],l="string"==typeof a?JSON.parse(a):a;c[d.tsKey]=(0,i.is)(s,Q)?l&&e(t,t[d.relationTableTsKey],l,d.selection,o):l.map(r=>e(t,t[d.relationTableTsKey],r,d.selection,o))}else{let e;let t=o(n[u]),r=d.field;e=(0,i.is)(r,a.s)?r:(0,i.is)(r,l.$s)?r.decoder:r.sql.decoder,c[d.tsKey]=null===t?null:e.mapFromDriverValue(t)}return c})(this.schema,this.tableConfig,e,t.selection,r));return"first"===this.mode?n[0]:n})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}execute(){return V.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute())}}class ey extends J{constructor(e,t,r,i){super(),this.execute=e,this.sql=t,this.query=r,this.mapBatchResult=i}static [i.Q]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}class eg extends J{constructor(e,t,r){super(),this.session=t,this.dialect=r,this.config={view:e}}static [i.Q]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return V.Z.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}execute=e=>V.Z.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))}class ew{constructor(e,t,r){if(this.dialect=e,this.session=t,this._=r?{schema:r.schema,fullSchema:r.fullSchema,tableNamesMap:r.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(let[i,n]of Object.entries(this._.schema))this.query[i]=new eh(r.fullSchema,this._.schema,this._.tableNamesMap,r.fullSchema[i],n,e,t)}static [i.Q]="PgDatabase";query;$with(e){let t=this;return{as:r=>("function"==typeof r&&(r=r(new ea(t.dialect))),new Proxy(new M.S(r.getSQL(),r.getSelectedFields(),e,!0),new W({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}$count(e,t){return new ef({source:e,filters:t,session:this.session})}with(...e){let t=this;return{select:function(r){return new G({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(r){return new G({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},selectDistinctOn:function(r,i){return new G({fields:i??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:r}})},update:function(r){return new el(r,t.session,t.dialect,e)},insert:function(r){return new eu(r,t.session,t.dialect,e)},delete:function(r){return new ep(r,t.session,t.dialect,e)}}}select(e){return new G({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new G({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new G({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new el(e,this.session,this.dialect)}insert(e){return new eu(e,this.session,this.dialect)}delete(e){return new ep(e,this.session,this.dialect)}refreshMaterializedView(e){return new eg(e,this.session,this.dialect)}execute(e){let t="string"==typeof e?l.i6.raw(e):e.getSQL(),r=this.dialect.sqlToQuery(t),i=this.session.prepareQuery(r,void 0,void 0,!1);return new ey(()=>i.execute(),t,r,e=>i.mapResult(e,!0))}transaction(e,t){return this.session.transaction(e,t)}}class eb{constructor(e){this.query=e}getQuery(){return this.query}mapResult(e,t){return e}static [i.Q]="PgPreparedQuery";joinsNotNullableMap}class ev{constructor(e){this.dialect=e}static [i.Q]="PgSession";execute(e){return V.Z.startActiveSpan("drizzle.operation",()=>V.Z.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).execute())}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e){return Number((await this.execute(e))[0].count)}}class e_ extends ew{constructor(e,t,r,i=0){super(e,t,r),this.schema=r,this.nestedIndex=i}static [i.Q]="PgTransaction";rollback(){throw new k}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),"boolean"==typeof e.deferrable&&t.push(e.deferrable?"deferrable":"not deferrable"),l.i6.raw(t.join(" "))}setTransaction(e){return this.session.execute((0,l.i6)`set transaction ${this.getTransactionConfigSQL(e)}`)}}class eS extends eb{constructor(e,t,r,i,n,s,o){super({sql:t,params:r}),this.client=e,this.queryString=t,this.params=r,this.logger=i,this.fields=n,this._isResponseInArrayMode=s,this.customResultMapper=o}static [i.Q]="PostgresJsPreparedQuery";async execute(e={}){return V.Z.startActiveSpan("drizzle.execute",async t=>{let r=(0,l.Pr)(this.params,e);t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.logger.logQuery(this.queryString,r);let{fields:i,queryString:n,client:s,joinsNotNullableMap:o,customResultMapper:a}=this;if(!i&&!a)return V.Z.startActiveSpan("drizzle.driver.execute",()=>s.unsafe(n,r));let c=await V.Z.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":n,"drizzle.query.params":JSON.stringify(r)}),s.unsafe(n,r).values()));return V.Z.startActiveSpan("drizzle.mapResponse",()=>a?a(c):c.map(e=>(0,z.M4)(i,e,o)))})}all(e={}){return V.Z.startActiveSpan("drizzle.execute",async t=>{let r=(0,l.Pr)(this.params,e);return t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.logger.logQuery(this.queryString,r),V.Z.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(r)}),this.client.unsafe(this.queryString,r)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}}class ek extends ev{constructor(e,t,r,i={}){super(t),this.client=e,this.schema=r,this.options=i,this.logger=i.logger??new o}static [i.Q]="PostgresJsSession";logger;prepareQuery(e,t,r,i,n){return new eS(this.client,e.sql,e.params,this.logger,t,i,n)}query(e,t){return this.logger.logQuery(e,t),this.client.unsafe(e,t).values()}queryObjects(e,t){return this.client.unsafe(e,t)}transaction(e,t){return this.client.begin(async r=>{let i=new ek(r,this.dialect,this.schema,this.options),n=new eA(this.dialect,i,this.schema);return t&&await n.setTransaction(t),e(n)})}}class eA extends e_{constructor(e,t,r,i=0){super(e,t,r,i),this.session=t}static [i.Q]="PostgresJsTransaction";transaction(e){return this.session.client.savepoint(t=>{let r=new ek(t,this.dialect,this.schema,this.session.options);return e(new eA(this.dialect,r,this.schema))})}}class ex extends ew{static [i.Q]="PostgresJsDatabase"}function eE(e,t={}){let r,n;let o=e=>e;for(let t of["1184","1082","1083","1114"])e.options.parsers[t]=o,e.options.serializers[t]=o;e.options.serializers["114"]=o,e.options.serializers["3802"]=o;let a=new K({casing:t.casing});if(!0===t.logger?r=new s:!1!==t.logger&&(r=t.logger),t.schema){let e=function(e,t){1===Object.keys(e).length&&"default"in e&&!(0,i.is)(e.default,c.iA)&&(e=e.default);let r={},n={},s={};for(let[o,a]of Object.entries(e))if((0,i.is)(a,c.iA)){let e=(0,c.Q0)(a),t=n[e];for(let i of(r[e]=o,s[o]={tsName:o,dbName:a[c.iA.Symbol.Name],schema:a[c.iA.Symbol.Schema],columns:a[c.iA.Symbol.Columns],relations:t?.relations??{},primaryKey:t?.primaryKey??[]},Object.values(a[c.iA.Symbol.Columns])))i.primary&&s[o].primaryKey.push(i);let l=a[c.iA.Symbol.ExtraConfigBuilder]?.(a[c.iA.Symbol.ExtraConfigColumns]);if(l)for(let e of Object.values(l))(0,i.is)(e,R)&&s[o].primaryKey.push(...e.columns)}else if((0,i.is)(a,L)){let e;let i=(0,c.Q0)(a.table),o=r[i];for(let[r,l]of Object.entries(a.config(t(a.table))))if(o){let t=s[o];t.relations[r]=l,e&&t.primaryKey.push(...e)}else i in n||(n[i]={relations:{},primaryKey:e}),n[i].relations[r]=l}return{tables:s,tableNamesMap:r}}(t.schema,q);n={fullSchema:t.schema,schema:e.tables,tableNamesMap:e.tableNamesMap}}let l=new ek(e,a,n,{logger:r}),u=new ex(a,l,n);return u.$client=e,u}},40986:(e,t,r)=>{"use strict";r.d(t,{Ft:()=>b,G:()=>y,Gg:()=>_,K0:()=>v,Nl:()=>w,OL:()=>A,Qg:()=>E,UN:()=>S,d3:()=>g,eg:()=>h,eq:()=>l,ff:()=>p,gt:()=>f,lt:()=>m,mM:()=>P,ne:()=>c,o$:()=>T,or:()=>d,vL:()=>x,vX:()=>k,xD:()=>u});var i=r(99534),n=r(77910),s=r(65702),o=r(73977);function a(e,t){return!(0,o._B)(t)||(0,o.zl)(e)||(0,n.is)(e,o.dO)||(0,n.is)(e,o.Vm)||(0,n.is)(e,i.s)||(0,n.is)(e,s.iA)||(0,n.is)(e,o.G7)?e:new o.dO(e,t)}let l=(e,t)=>(0,o.i6)`${e} = ${a(t,e)}`,c=(e,t)=>(0,o.i6)`${e} <> ${a(t,e)}`;function u(...e){let t=e.filter(e=>void 0!==e);return 0===t.length?void 0:new o.$s(1===t.length?t:[new o.Zm("("),o.i6.join(t,new o.Zm(" and ")),new o.Zm(")")])}function d(...e){let t=e.filter(e=>void 0!==e);return 0===t.length?void 0:new o.$s(1===t.length?t:[new o.Zm("("),o.i6.join(t,new o.Zm(" or ")),new o.Zm(")")])}function p(e){return(0,o.i6)`not ${e}`}let f=(e,t)=>(0,o.i6)`${e} > ${a(t,e)}`,h=(e,t)=>(0,o.i6)`${e} >= ${a(t,e)}`,m=(e,t)=>(0,o.i6)`${e} < ${a(t,e)}`,y=(e,t)=>(0,o.i6)`${e} <= ${a(t,e)}`;function g(e,t){return Array.isArray(t)?0===t.length?(0,o.i6)`false`:(0,o.i6)`${e} in ${t.map(t=>a(t,e))}`:(0,o.i6)`${e} in ${a(t,e)}`}function w(e,t){return Array.isArray(t)?0===t.length?(0,o.i6)`true`:(0,o.i6)`${e} not in ${t.map(t=>a(t,e))}`:(0,o.i6)`${e} not in ${a(t,e)}`}function b(e){return(0,o.i6)`${e} is null`}function v(e){return(0,o.i6)`${e} is not null`}function _(e){return(0,o.i6)`exists ${e}`}function S(e){return(0,o.i6)`not exists ${e}`}function k(e,t,r){return(0,o.i6)`${e} between ${a(t,e)} and ${a(r,e)}`}function A(e,t,r){return(0,o.i6)`${e} not between ${a(t,e)} and ${a(r,e)}`}function x(e,t){return(0,o.i6)`${e} like ${t}`}function E(e,t){return(0,o.i6)`${e} not like ${t}`}function T(e,t){return(0,o.i6)`${e} ilike ${t}`}function P(e,t){return(0,o.i6)`${e} not ilike ${t}`}},6931:(e,t,r)=>{"use strict";r.d(t,{C:()=>s,d:()=>n});var i=r(73977);function n(e){return(0,i.i6)`${e} asc`}function s(e){return(0,i.i6)`${e} desc`}},73977:(e,t,r)=>{"use strict";r.d(t,{dO:()=>_,Vm:()=>k,$s:()=>y,Zm:()=>m,G7:()=>x,Pr:()=>A,_B:()=>w,zl:()=>h,i6:()=>S});var i=r(77910),n=r(88246);let s=Symbol.for("drizzle:isPgEnum");class o extends n.b1{static [i.Q]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new a(e,this.config)}}class a extends n.df{static [i.Q]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}var l=r(77805),c=r(23111),u=r(7155),d=r(99534),p=r(65702);class f{static [i.Q]=null}function h(e){return null!=e&&"function"==typeof e.getSQL}class m{static [i.Q]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new y([this])}}class y{constructor(e){this.queryChunks=e}static [i.Q]="SQL";decoder=b;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return c.Z.startActiveSpan("drizzle.buildSQL",t=>{let r=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(e,t){let r=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:n,escapeName:o,escapeParam:a,prepareTyping:c,inlineParams:f,paramStartIndex:w}=r;return function(e){let t={sql:"",params:[]};for(let r of e)t.sql+=r.sql,t.params.push(...r.params),r.typings?.length&&(t.typings||(t.typings=[]),t.typings.push(...r.typings));return t}(e.map(e=>{if((0,i.is)(e,m))return{sql:e.value.join(""),params:[]};if((0,i.is)(e,g))return{sql:o(e.value),params:[]};if(void 0===e)return{sql:"",params:[]};if(Array.isArray(e)){let t=[new m("(")];for(let[r,i]of e.entries())t.push(i),r<e.length-1&&t.push(new m(", "));return t.push(new m(")")),this.buildQueryFromSourceParams(t,r)}if((0,i.is)(e,y))return this.buildQueryFromSourceParams(e.queryChunks,{...r,inlineParams:f||e.shouldInlineParams});if((0,i.is)(e,p.iA)){let t=e[p.iA.Symbol.Schema],r=e[p.iA.Symbol.Name];return{sql:void 0===t?o(r):o(t)+"."+o(r),params:[]}}if((0,i.is)(e,d.s)){let r=n.getColumnCasing(e);return"indexes"===t.invokeSource?{sql:o(r),params:[]}:{sql:o(e.table[p.iA.Symbol.Name])+"."+o(r),params:[]}}if((0,i.is)(e,x)){let t=e[u.d].schema,r=e[u.d].name;return{sql:void 0===t?o(r):o(t)+"."+o(r),params:[]}}if((0,i.is)(e,_)){if((0,i.is)(e.value,k))return{sql:a(w.value++,e),params:[e],typings:["none"]};let t=null===e.value?null:e.encoder.mapToDriverValue(e.value);if((0,i.is)(t,y))return this.buildQueryFromSourceParams([t],r);if(f)return{sql:this.mapInlineParam(t,r),params:[]};let n=["none"];return c&&(n=[c(e.encoder)]),{sql:a(w.value++,t),params:[t],typings:n}}return(0,i.is)(e,k)?{sql:a(w.value++,e),params:[e],typings:["none"]}:(0,i.is)(e,y.Aliased)&&void 0!==e.fieldAlias?{sql:o(e.fieldAlias),params:[]}:(0,i.is)(e,l.k)?e._.isWith?{sql:o(e._.alias),params:[]}:this.buildQueryFromSourceParams([new m("("),e._.sql,new m(") "),new g(e._.alias)],r):e&&"function"==typeof e&&s in e&&!0===e[s]?e.schema?{sql:o(e.schema)+"."+o(e.enumName),params:[]}:{sql:o(e.enumName),params:[]}:h(e)?e.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([e.getSQL()],r):this.buildQueryFromSourceParams([new m("("),e.getSQL(),new m(")")],r):f?{sql:this.mapInlineParam(e,r),params:[]}:{sql:a(w.value++,e),params:[e],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(null===e)return"null";if("number"==typeof e||"boolean"==typeof e)return e.toString();if("string"==typeof e)return t(e);if("object"==typeof e){let r=e.toString();return"[object Object]"===r?t(JSON.stringify(e)):t(r)}throw Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return void 0===e?this:new y.Aliased(this,e)}mapWith(e){return this.decoder="function"==typeof e?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class g{constructor(e){this.value=e}static [i.Q]="Name";brand;getSQL(){return new y([this])}}function w(e){return"object"==typeof e&&null!==e&&"mapToDriverValue"in e&&"function"==typeof e.mapToDriverValue}let b={mapFromDriverValue:e=>e},v={mapToDriverValue:e=>e};({...b,...v});class _{constructor(e,t=v){this.value=e,this.encoder=t}static [i.Q]="Param";brand;getSQL(){return new y([this])}}function S(e,...t){let r=[];for(let[i,n]of((t.length>0||e.length>0&&""!==e[0])&&r.push(new m(e[0])),t.entries()))r.push(n,new m(e[i+1]));return new y(r)}(e=>{e.empty=function(){return new y([])},e.fromList=function(e){return new y(e)},e.raw=function(e){return new y([new m(e)])},e.join=function(e,t){let r=[];for(let[i,n]of e.entries())i>0&&void 0!==t&&r.push(t),r.push(n);return new y(r)},e.identifier=function(e){return new g(e)},e.placeholder=function(e){return new k(e)},e.param=function(e,t){return new _(e,t)}})(S||(S={})),(e=>{class t{constructor(e,t){this.sql=e,this.fieldAlias=t}static [i.Q]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new t(this.sql,this.fieldAlias)}}e.Aliased=t})(y||(y={}));class k{constructor(e){this.name=e}static [i.Q]="Placeholder";getSQL(){return new y([this])}}function A(e,t){return e.map(e=>{if((0,i.is)(e,k)){if(!(e.name in t))throw Error(`No value for placeholder "${e.name}" was provided`);return t[e.name]}if((0,i.is)(e,_)&&(0,i.is)(e.value,k)){if(!(e.value.name in t))throw Error(`No value for placeholder "${e.value.name}" was provided`);return e.encoder.mapToDriverValue(t[e.value.name])}return e})}class x{static [i.Q]="View";[u.d];constructor({name:e,schema:t,selectedFields:r,query:i}){this[u.d]={name:e,originalName:e,schema:t,selectedFields:r,query:i,isExisting:!i,isAlias:!1}}getSQL(){return new y([this])}}d.s.prototype.getSQL=function(){return new y([this])},p.iA.prototype.getSQL=function(){return new y([this])},l.k.prototype.getSQL=function(){return new y([this])}},77805:(e,t,r)=>{"use strict";r.d(t,{S:()=>s,k:()=>n});var i=r(77910);class n{static [i.Q]="Subquery";constructor(e,t,r,i=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:r,isWith:i}}}class s extends n{static [i.Q]="WithSubquery"}},65702:(e,t,r)=>{"use strict";r.d(t,{Q0:()=>m,SP:()=>h,iA:()=>f});var i=r(77910),n=r(76378);let s=Symbol.for("drizzle:Schema"),o=Symbol.for("drizzle:Columns"),a=Symbol.for("drizzle:ExtraConfigColumns"),l=Symbol.for("drizzle:OriginalName"),c=Symbol.for("drizzle:BaseName"),u=Symbol.for("drizzle:IsAlias"),d=Symbol.for("drizzle:ExtraConfigBuilder"),p=Symbol.for("drizzle:IsDrizzleTable");class f{static [i.Q]="Table";static Symbol={Name:n.m,Schema:s,OriginalName:l,Columns:o,ExtraConfigColumns:a,BaseName:c,IsAlias:u,ExtraConfigBuilder:d};[n.m];[l];[s];[o];[a];[c];[u]=!1;[p]=!0;[d]=void 0;constructor(e,t,r){this[n.m]=this[l]=e,this[s]=t,this[c]=r}}function h(e){return e[n.m]}function m(e){return`${e[s]??"public"}.${e[n.m]}`}},76378:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});let i=Symbol.for("drizzle:Name")},47589:(e,t,r)=>{"use strict";function i(e,...t){return e(...t)}r.d(t,{t:()=>i})},23111:(e,t,r)=>{"use strict";let i,n;r.d(t,{Z:()=>o});var s=r(47589);let o={startActiveSpan:(e,t)=>i?(n||(n=i.trace.getTracer("drizzle-orm","0.34.1")),(0,s.t)((r,i)=>i.startActiveSpan(e,e=>{try{return t(e)}catch(t){throw e.setStatus({code:r.SpanStatusCode.ERROR,message:t instanceof Error?t.message:"Unknown error"}),t}finally{e.end()}}),i,n)):t()}},51101:(e,t,r)=>{"use strict";r.d(t,{An:()=>m,M4:()=>c,M6:()=>d,SS:()=>f,ZS:()=>function e(t,r){return Object.entries(t).reduce((t,[o,l])=>{if("string"!=typeof o)return t;let c=r?[...r,o]:[o];return(0,n.is)(l,i.s)||(0,n.is)(l,s.$s)||(0,n.is)(l,s.$s.Aliased)?t.push({path:c,field:l}):(0,n.is)(l,a.iA)?t.push(...e(l[a.iA.Symbol.Columns],c)):t.push(...e(l,c)),t},[])},dP:()=>h,ef:()=>p,ux:()=>u});var i=r(99534),n=r(77910),s=r(73977),o=r(77805),a=r(65702),l=r(7155);function c(e,t,r){let o={},l=e.reduce((e,{path:l,field:c},u)=>{let d;d=(0,n.is)(c,i.s)?c:(0,n.is)(c,s.$s)?c.decoder:c.sql.decoder;let p=e;for(let[e,s]of l.entries())if(e<l.length-1)s in p||(p[s]={}),p=p[s];else{let e=t[u],f=p[s]=null===e?null:d.mapFromDriverValue(e);if(r&&(0,n.is)(c,i.s)&&2===l.length){let e=l[0];e in o?"string"==typeof o[e]&&o[e]!==(0,a.SP)(c.table)&&(o[e]=!1):o[e]=null===f&&(0,a.SP)(c.table)}}return e},{});if(r&&Object.keys(o).length>0)for(let[e,t]of Object.entries(o))"string"!=typeof t||r[t]||(l[e]=null);return l}function u(e,t){let r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(let[e,t]of r.entries())if(t!==i[e])return!1;return!0}function d(e,t){let r=Object.entries(t).filter(([,e])=>void 0!==e).map(([t,r])=>(0,n.is)(r,s.$s)?[t,r]:[t,new s.dO(r,e[a.iA.Symbol.Columns][t])]);if(0===r.length)throw Error("No values to set");return Object.fromEntries(r)}function p(e,t){for(let r of t)for(let t of Object.getOwnPropertyNames(r.prototype))"constructor"!==t&&Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(r.prototype,t)||Object.create(null))}function f(e){return e[a.iA.Symbol.Columns]}function h(e){return(0,n.is)(e,o.k)?e._.alias:(0,n.is)(e,s.G7)?e[l.d].name:(0,n.is)(e,s.$s)?void 0:e[a.iA.Symbol.IsAlias]?e[a.iA.Symbol.Name]:e[a.iA.Symbol.BaseName]}function m(e,t){return{name:"string"==typeof e&&e.length>0?e:"",config:"object"==typeof e?e:t}}},7155:(e,t,r)=>{"use strict";r.d(t,{d:()=>i});let i=Symbol.for("drizzle:ViewBaseConfig")},81218:(e,t,r)=>{"use strict";let i,n,s,o,a;r.d(t,{ZP:()=>s_});var l=function(e,t,r,i,n){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},c=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};function u(e){let t=e?"__Secure-":"";return{sessionToken:{name:`${t}authjs.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},callbackUrl:{name:`${t}authjs.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},csrfToken:{name:`${e?"__Host-":""}authjs.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},pkceCodeVerifier:{name:`${t}authjs.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},state:{name:`${t}authjs.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},nonce:{name:`${t}authjs.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},webauthnChallenge:{name:`${t}authjs.challenge`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}}}}class d{constructor(e,t,r){if(rd.add(this),rp.set(this,{}),rf.set(this,void 0),rh.set(this,void 0),l(this,rh,r,"f"),l(this,rf,e,"f"),!t)return;let{name:i}=e;for(let[e,r]of Object.entries(t))e.startsWith(i)&&r&&(c(this,rp,"f")[e]=r)}get value(){return Object.keys(c(this,rp,"f")).sort((e,t)=>parseInt(e.split(".").pop()||"0")-parseInt(t.split(".").pop()||"0")).map(e=>c(this,rp,"f")[e]).join("")}chunk(e,t){let r=c(this,rd,"m",ry).call(this);for(let i of c(this,rd,"m",rm).call(this,{name:c(this,rf,"f").name,value:e,options:{...c(this,rf,"f").options,...t}}))r[i.name]=i;return Object.values(r)}clean(){return Object.values(c(this,rd,"m",ry).call(this))}}rp=new WeakMap,rf=new WeakMap,rh=new WeakMap,rd=new WeakSet,rm=function(e){let t=Math.ceil(e.value.length/3936);if(1===t)return c(this,rp,"f")[e.name]=e.value,[e];let r=[];for(let i=0;i<t;i++){let t=`${e.name}.${i}`,n=e.value.substr(3936*i,3936);r.push({...e,name:t,value:n}),c(this,rp,"f")[t]=n}return c(this,rh,"f").debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:160,valueSize:e.value.length,chunks:r.map(e=>e.value.length+160)}),r},ry=function(){let e={};for(let t in c(this,rp,"f"))delete c(this,rp,"f")?.[t],e[t]={name:t,value:"",options:{...c(this,rf,"f").options,maxAge:0}};return e};class p extends Error{constructor(e,t){e instanceof Error?super(void 0,{cause:{err:e,...e.cause,...t}}):"string"==typeof e?(t instanceof Error&&(t={err:t,...t.cause}),super(e,t)):super(void 0,e),this.name=this.constructor.name,this.type=this.constructor.type??"AuthError",this.kind=this.constructor.kind??"error",Error.captureStackTrace?.(this,this.constructor);let r=`https://errors.authjs.dev#${this.type.toLowerCase()}`;this.message+=`${this.message?". ":""}Read more at ${r}`}}class f extends p{}f.kind="signIn";class h extends p{}h.type="AdapterError";class m extends p{}m.type="AccessDenied";class y extends p{}y.type="CallbackRouteError";class g extends p{}g.type="ErrorPageLoop";class w extends p{}w.type="EventError";class b extends p{}b.type="InvalidCallbackUrl";class v extends f{constructor(){super(...arguments),this.code="credentials"}}v.type="CredentialsSignin";class _ extends p{}_.type="InvalidEndpoints";class S extends p{}S.type="InvalidCheck";class k extends p{}k.type="JWTSessionError";class A extends p{}A.type="MissingAdapter";class x extends p{}x.type="MissingAdapterMethods";class E extends p{}E.type="MissingAuthorize";class T extends p{}T.type="MissingSecret";class P extends f{}P.type="OAuthAccountNotLinked";class C extends f{}C.type="OAuthCallbackError";class $ extends p{}$.type="OAuthProfileParseError";class O extends p{}O.type="SessionTokenError";class j extends f{}j.type="OAuthSignInError";class R extends f{}R.type="EmailSignInError";class U extends p{}U.type="SignOutError";class N extends p{}N.type="UnknownAction";class I extends p{}I.type="UnsupportedStrategy";class D extends p{}D.type="InvalidProvider";class L extends p{}L.type="UntrustedHost";class Q extends p{}Q.type="Verification";class B extends f{}B.type="MissingCSRF";let q=new Set(["CredentialsSignin","OAuthAccountNotLinked","OAuthCallbackError","AccessDenied","Verification","MissingCSRF","AccountNotLinked","WebAuthnVerificationError"]);class M extends p{}M.type="DuplicateConditionalUI";class z extends p{}z.type="MissingWebAuthnAutocomplete";class H extends p{}H.type="WebAuthnVerificationError";class K extends f{}K.type="AccountNotLinked";class W extends p{}W.type="ExperimentalFeatureNotEnabled";let F=!1;function J(e,t){try{return/^https?:/.test(new URL(e,e.startsWith("/")?t:void 0).protocol)}catch{return!1}}let V=!1,G=!1,Z=!1,X=["createVerificationToken","useVerificationToken","getUserByEmail"],Y=["createUser","getUser","getUserByEmail","getUserByAccount","updateUser","linkAccount","createSession","getSessionAndUser","updateSession","deleteSession"],ee=["createUser","getUser","linkAccount","getAccount","getAuthenticator","createAuthenticator","listAuthenticatorsByUserId","updateAuthenticatorCounter"];var et=r(6113);let er=(e,t,r,i,n)=>{let s=parseInt(e.substr(3),10)>>3||20,o=(0,et.createHmac)(e,r.byteLength?r:new Uint8Array(s)).update(t).digest(),a=Math.ceil(n/s),l=new Uint8Array(s*a+i.byteLength+1),c=0,u=0;for(let t=1;t<=a;t++)l.set(i,u),l[u+i.byteLength]=t,l.set((0,et.createHmac)(e,o).update(l.subarray(c,u+i.byteLength+1)).digest(),u),c=u,u+=s;return l.slice(0,n)};"function"!=typeof et.hkdf||process.versions.electron||(i=async(...e)=>new Promise((t,r)=>{et.hkdf(...e,(e,i)=>{e?r(e):t(new Uint8Array(i))})}));let ei=async(e,t,r,n,s)=>(i||er)(e,t,r,n,s);function en(e,t){if("string"==typeof e)return new TextEncoder().encode(e);if(!(e instanceof Uint8Array))throw TypeError(`"${t}"" must be an instance of Uint8Array or a string`);return e}async function es(e,t,r,i,n){return ei(function(e){switch(e){case"sha256":case"sha384":case"sha512":case"sha1":return e;default:throw TypeError('unsupported "digest" value')}}(e),function(e){let t=en(e,"ikm");if(!t.byteLength)throw TypeError('"ikm" must be at least one byte in length');return t}(t),en(r,"salt"),function(e){let t=en(e,"info");if(t.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return t}(i),function(e,t){if("number"!=typeof e||!Number.isInteger(e)||e<1)throw TypeError('"keylen" must be a positive integer');if(e>255*(parseInt(t.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return e}(n,e))}var eo=r(6005);let ea=(e,t)=>(0,eo.createHash)(e).update(t).digest();var el=r(72254);let ec=new TextEncoder,eu=new TextDecoder;function ed(...e){let t=new Uint8Array(e.reduce((e,{length:t})=>e+t,0)),r=0;for(let i of e)t.set(i,r),r+=i.length;return t}function ep(e,t){return ed(ec.encode(e),new Uint8Array([0]),t)}function ef(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function eh(e){let t=new Uint8Array(4);return ef(t,e),t}function em(e){return ed(eh(e.length),e)}async function ey(e,t,r){let i=Math.ceil((t>>3)/32),n=new Uint8Array(32*i);for(let t=0;t<i;t++){let i=new Uint8Array(4+e.length+r.length);i.set(eh(t+1)),i.set(e,4),i.set(r,4+e.length),n.set(await ea("sha256",i),32*t)}return n.slice(0,t>>3)}let eg=e=>el.Buffer.from(e).toString("base64url"),ew=e=>new Uint8Array(el.Buffer.from(function(e){let t=e;return t instanceof Uint8Array&&(t=eu.decode(t)),t}(e),"base64url"));class eb extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class ev extends eb{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(e,t,r="unspecified",i="unspecified"){super(e,{cause:{claim:r,reason:i,payload:t}}),this.claim=r,this.reason=i,this.payload=t}}class e_ extends eb{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(e,t,r="unspecified",i="unspecified"){super(e,{cause:{claim:r,reason:i,payload:t}}),this.claim=r,this.reason=i,this.payload=t}}class eS extends eb{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class ek extends eb{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class eA extends eb{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(e="decryption operation failed",t){super(e,t)}}class ex extends eb{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class eE extends eb{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class eT extends eb{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class eP extends eb{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t)}}function eC(e){if(!("object"==typeof e&&null!==e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}let e$=(e,t)=>{if("string"!=typeof e||!e)throw new eT(`${t} missing or invalid`)};async function eO(e,t){let r;if(!eC(e))throw TypeError("JWK must be an object");if("sha256"!==(t??="sha256")&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(e.kty){case"EC":e$(e.crv,'"crv" (Curve) Parameter'),e$(e.x,'"x" (X Coordinate) Parameter'),e$(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":e$(e.crv,'"crv" (Subtype of Key Pair) Parameter'),e$(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":e$(e.e,'"e" (Exponent) Parameter'),e$(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":e$(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new ek('"kty" (Key Type) Parameter missing or unsupported')}let i=ec.encode(JSON.stringify(r));return eg(await ea(t,i))}let ej=Symbol();function eR(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new ek(`Unsupported JWE Algorithm: ${e}`)}}let eU=e=>(0,eo.randomFillSync)(new Uint8Array(eR(e)>>3)),eN=(e,t)=>{if(t.length<<3!==eR(e))throw new ex("Invalid Initialization Vector length")};var eI=r(47261);let eD=e=>eI.types.isKeyObject(e),eL=(e,t)=>{let r;switch(e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new ek(`Content Encryption Algorithm ${e} is not supported either by JOSE or your javascript runtime`)}if(t instanceof Uint8Array){let e=t.byteLength<<3;if(e!==r)throw new ex(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}if(eD(t)&&"secret"===t.type){let e=t.symmetricKeySize<<3;if(e!==r)throw new ex(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}throw TypeError("Invalid Content Encryption Key type")};function eQ(e,t,r,i,n,s){let o=ed(e,t,r,function(e){let t=Math.floor(e/4294967296),r=new Uint8Array(8);return ef(r,t,0),ef(r,e%4294967296,4),r}(e.length<<3)),a=(0,eo.createHmac)(`sha${i}`,n);return a.update(o),a.digest().slice(0,s>>3)}let eB=eo.webcrypto,eq=e=>eI.types.isCryptoKey(e);function eM(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function ez(e,t){return e.name===t}function eH(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!ez(e.algorithm,"AES-GCM"))throw eM("AES-GCM");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw eM(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!ez(e.algorithm,"AES-KW"))throw eM("AES-KW");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw eM(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw eM("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!ez(e.algorithm,"PBKDF2"))throw eM("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!ez(e.algorithm,"RSA-OAEP"))throw eM("RSA-OAEP");let r=parseInt(t.slice(9),10)||1;if(parseInt(e.algorithm.hash.name.slice(4),10)!==r)throw eM(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}(function(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}})(e,r)}function eK(e,t,...r){if((r=r.filter(Boolean)).length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}let eW=(e,...t)=>eK("Key must be ",e,...t);function eF(e,t,...r){return eK(`Key for the ${e} algorithm must be `,t,...r)}let eJ=e=>(n||=new Set((0,eo.getCiphers)())).has(e),eV=e=>eD(e)||eq(e),eG=["KeyObject"];(globalThis.CryptoKey||eB?.CryptoKey)&&eG.push("CryptoKey");let eZ=(e,t,r,i,n)=>{let s;if(eq(r))eH(r,e,"encrypt"),s=eo.KeyObject.from(r);else if(r instanceof Uint8Array||eD(r))s=r;else throw TypeError(eW(r,...eG,"Uint8Array"));switch(eL(e,s),i?eN(e,i):i=eU(e),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,i,n){let s=parseInt(e.slice(1,4),10);eD(r)&&(r=r.export());let o=r.subarray(s>>3),a=r.subarray(0,s>>3),l=`aes-${s}-cbc`;if(!eJ(l))throw new ek(`alg ${e} is not supported by your javascript runtime`);let c=(0,eo.createCipheriv)(l,o,i),u=ed(c.update(t),c.final()),d=eQ(n,i,u,parseInt(e.slice(-3),10),a,s);return{ciphertext:u,tag:d,iv:i}}(e,t,s,i,n);case"A128GCM":case"A192GCM":case"A256GCM":return function(e,t,r,i,n){let s=parseInt(e.slice(1,4),10),o=`aes-${s}-gcm`;if(!eJ(o))throw new ek(`alg ${e} is not supported by your javascript runtime`);let a=(0,eo.createCipheriv)(o,r,i,{authTagLength:16});n.byteLength&&a.setAAD(n,{plaintextLength:t.length});let l=a.update(t);return a.final(),{ciphertext:l,tag:a.getAuthTag(),iv:i}}(e,t,s,i,n);default:throw new ek("Unsupported JWE Content Encryption Algorithm")}};function eX(e,t){if(e.symmetricKeySize<<3!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function eY(e,t,r){if(eD(e))return e;if(e instanceof Uint8Array)return(0,eo.createSecretKey)(e);if(eq(e))return eH(e,t,r),eo.KeyObject.from(e);throw TypeError(eW(e,...eG,"Uint8Array"))}let e0=(e,t,r)=>{let i=parseInt(e.slice(1,4),10),n=`aes${i}-wrap`;if(!eJ(n))throw new ek(`alg ${e} is not supported either by JOSE or your javascript runtime`);let s=eY(t,e,"wrapKey");eX(s,e);let o=(0,eo.createCipheriv)(n,s,el.Buffer.alloc(8,166));return ed(o.update(r),o.final())},e1=(e,t,r)=>{let i=parseInt(e.slice(1,4),10),n=`aes${i}-wrap`;if(!eJ(n))throw new ek(`alg ${e} is not supported either by JOSE or your javascript runtime`);let s=eY(t,e,"unwrapKey");eX(s,e);let o=(0,eo.createDecipheriv)(n,s,el.Buffer.alloc(8,166));return ed(o.update(r),o.final())};function e2(e){return eC(e)&&"string"==typeof e.kty}new WeakMap;let e3=e=>{switch(e){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new ek("Unsupported key curve for this operation")}},e6=(e,t)=>{let r;if(eq(e))r=eo.KeyObject.from(e);else if(eD(e))r=e;else if(e2(e))return e.crv;else throw TypeError(eW(e,...eG));if("secret"===r.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(r.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${r.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${r.asymmetricKeyType.slice(1)}`;case"ec":{let e=r.asymmetricKeyDetails.namedCurve;if(t)return e;return e3(e)}default:throw TypeError("Invalid asymmetric key type for this operation")}},e5=(0,eI.promisify)(eo.generateKeyPair);async function e4(e,t,r,i,n=new Uint8Array(0),s=new Uint8Array(0)){let o,a;if(eq(e))eH(e,"ECDH"),o=eo.KeyObject.from(e);else if(eD(e))o=e;else throw TypeError(eW(e,...eG));if(eq(t))eH(t,"ECDH","deriveBits"),a=eo.KeyObject.from(t);else if(eD(t))a=t;else throw TypeError(eW(t,...eG));let l=ed(em(ec.encode(r)),em(n),em(s),eh(i));return ey((0,eo.diffieHellman)({privateKey:a,publicKey:o}),i,l)}async function e8(e){let t;if(eq(e))t=eo.KeyObject.from(e);else if(eD(e))t=e;else throw TypeError(eW(e,...eG));switch(t.asymmetricKeyType){case"x25519":return e5("x25519");case"x448":return e5("x448");case"ec":return e5("ec",{namedCurve:e6(t)});default:throw new ek("Invalid or unsupported EPK")}}let e7=e=>["P-256","P-384","P-521","X25519","X448"].includes(e6(e));function e9(e){if(!(e instanceof Uint8Array)||e.length<8)throw new ex("PBES2 Salt Input must be 8 or more octets")}let te=(0,eI.promisify)(eo.pbkdf2);function tt(e,t){if(eD(e))return e.export();if(e instanceof Uint8Array)return e;if(eq(e))return eH(e,t,"deriveBits","deriveKey"),eo.KeyObject.from(e).export();throw TypeError(eW(e,...eG,"Uint8Array"))}let tr=async(e,t,r,i=2048,n=(0,eo.randomFillSync)(new Uint8Array(16)))=>{e9(n);let s=ep(e,n),o=parseInt(e.slice(13,16),10)>>3,a=tt(t,e),l=await te(a,s,i,o,`sha${e.slice(8,11)}`);return{encryptedKey:await e0(e.slice(-6),l,r),p2c:i,p2s:eg(n)}},ti=async(e,t,r,i,n)=>{e9(n);let s=ep(e,n),o=parseInt(e.slice(13,16),10)>>3,a=tt(t,e),l=await te(a,s,i,o,`sha${e.slice(8,11)}`);return e1(e.slice(-6),l,r)},tn=(e,t)=>{let r;try{r=e instanceof eo.KeyObject?e.asymmetricKeyDetails?.modulusLength:Buffer.from(e.n,"base64url").byteLength<<3}catch{}if("number"!=typeof r||r<2048)throw TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)},ts=(e,t)=>{if("rsa"!==e.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");tn(e,t)},to=(0,eI.deprecate)(()=>eo.constants.RSA_PKCS1_PADDING,'The RSA1_5 "alg" (JWE Algorithm) is deprecated and will be removed in the next major revision.'),ta=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return eo.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return to();default:return}},tl=e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function tc(e,t,...r){if(eD(e))return e;if(eq(e))return eH(e,t,...r),eo.KeyObject.from(e);throw TypeError(eW(e,...eG))}let tu=(e,t,r)=>{let i=ta(e),n=tl(e),s=tc(t,e,"wrapKey","encrypt");return ts(s,e),(0,eo.publicEncrypt)({key:s,oaepHash:n,padding:i},r)},td=(e,t,r)=>{let i=ta(e),n=tl(e),s=tc(t,e,"unwrapKey","decrypt");return ts(s,e),(0,eo.privateDecrypt)({key:s,oaepHash:n,padding:i},r)},tp={};function tf(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new ek(`Unsupported JWE Algorithm: ${e}`)}}let th=e=>(0,eo.randomFillSync)(new Uint8Array(tf(e)>>3)),tm=e=>{let t;if(eq(e)){if(!e.extractable)throw TypeError("CryptoKey is not extractable");t=eo.KeyObject.from(e)}else if(eD(e))t=e;else if(e instanceof Uint8Array)return{kty:"oct",k:eg(e)};else throw TypeError(eW(e,...eG,"Uint8Array"));if("secret"!==t.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(t.asymmetricKeyType))throw new ek("Unsupported key asymmetricKeyType");return t.export({format:"jwk"})};async function ty(e){return tm(e)}let tg=e=>e?.[Symbol.toStringTag],tw=(e,t,r)=>{if(void 0!==t.use&&"sig"!==t.use)throw TypeError("Invalid key for this operation, when present its use must be sig");if(void 0!==t.key_ops&&t.key_ops.includes?.(r)!==!0)throw TypeError(`Invalid key for this operation, when present its key_ops must include ${r}`);if(void 0!==t.alg&&t.alg!==e)throw TypeError(`Invalid key for this operation, when present its alg must be ${e}`);return!0},tb=(e,t,r,i)=>{if(!(t instanceof Uint8Array)){if(i&&e2(t)){if(function(e){return e2(e)&&"oct"===e.kty&&"string"==typeof e.k}(t)&&tw(e,t,r))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!eV(t))throw TypeError(eF(e,t,...eG,"Uint8Array",i?"JSON Web Key":null));if("secret"!==t.type)throw TypeError(`${tg(t)} instances for symmetric algorithms must be of type "secret"`)}},tv=(e,t,r,i)=>{if(i&&e2(t))switch(r){case"sign":if(function(e){return"oct"!==e.kty&&"string"==typeof e.d}(t)&&tw(e,t,r))return;throw TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(function(e){return"oct"!==e.kty&&void 0===e.d}(t)&&tw(e,t,r))return;throw TypeError("JSON Web Key for this operation be a public JWK")}if(!eV(t))throw TypeError(eF(e,t,...eG,i?"JSON Web Key":null));if("secret"===t.type)throw TypeError(`${tg(t)} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${tg(t)} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${tg(t)} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${tg(t)} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${tg(t)} instances for asymmetric algorithm encryption must be of type "public"`)};function t_(e,t,r,i){t.startsWith("HS")||"dir"===t||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?tb(t,r,i,e):tv(t,r,i,e)}let tS=t_.bind(void 0,!1);t_.bind(void 0,!0);let tk=eo.timingSafeEqual,tA=(e,t,r,i,n,s)=>{let o;if(eq(t))eH(t,e,"decrypt"),o=eo.KeyObject.from(t);else if(t instanceof Uint8Array||eD(t))o=t;else throw TypeError(eW(t,...eG,"Uint8Array"));if(!i)throw new ex("JWE Initialization Vector missing");if(!n)throw new ex("JWE Authentication Tag missing");switch(eL(e,o),eN(e,i),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,i,n,s){let o,a;let l=parseInt(e.slice(1,4),10);eD(t)&&(t=t.export());let c=t.subarray(l>>3),u=t.subarray(0,l>>3),d=parseInt(e.slice(-3),10),p=`aes-${l}-cbc`;if(!eJ(p))throw new ek(`alg ${e} is not supported by your javascript runtime`);let f=eQ(s,i,r,d,u,l);try{o=tk(n,f)}catch{}if(!o)throw new eA;try{let e=(0,eo.createDecipheriv)(p,c,i);a=ed(e.update(r),e.final())}catch{}if(!a)throw new eA;return a}(e,o,r,i,n,s);case"A128GCM":case"A192GCM":case"A256GCM":return function(e,t,r,i,n,s){let o=parseInt(e.slice(1,4),10),a=`aes-${o}-gcm`;if(!eJ(a))throw new ek(`alg ${e} is not supported by your javascript runtime`);try{let e=(0,eo.createDecipheriv)(a,t,i,{authTagLength:16});e.setAuthTag(n),s.byteLength&&e.setAAD(s,{plaintextLength:r.length});let o=e.update(r);return e.final(),o}catch{throw new eA}}(e,o,r,i,n,s);default:throw new ek("Unsupported JWE Content Encryption Algorithm")}};async function tx(e,t,r,i){let n=e.slice(0,7),s=await eZ(n,r,t,i,new Uint8Array(0));return{encryptedKey:s.ciphertext,iv:eg(s.iv),tag:eg(s.tag)}}async function tE(e,t,r,i,n){return tA(e.slice(0,7),t,r,i,n,new Uint8Array(0))}async function tT(e,t,r,i,n={}){let s,o,a;switch(tS(e,r,"encrypt"),r=await tp.normalizePublicKey?.(r,e)||r,e){case"dir":a=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!e7(r))throw new ek("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:l,apv:c}=n,{epk:u}=n;u||=(await e8(r)).privateKey;let{x:d,y:p,crv:f,kty:h}=await ty(u),m=await e4(r,u,"ECDH-ES"===e?t:e,"ECDH-ES"===e?tf(t):parseInt(e.slice(-5,-2),10),l,c);if(o={epk:{x:d,crv:f,kty:h}},"EC"===h&&(o.epk.y=p),l&&(o.apu=eg(l)),c&&(o.apv=eg(c)),"ECDH-ES"===e){a=m;break}a=i||th(t);let y=e.slice(-6);s=await e0(y,m,a);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":a=i||th(t),s=await tu(e,r,a);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{a=i||th(t);let{p2c:l,p2s:c}=n;({encryptedKey:s,...o}=await tr(e,r,a,l,c));break}case"A128KW":case"A192KW":case"A256KW":a=i||th(t),s=await e0(e,r,a);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{a=i||th(t);let{iv:l}=n;({encryptedKey:s,...o}=await tx(e,r,a,l));break}default:throw new ek('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:a,encryptedKey:s,parameters:o}}let tP=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0},tC=function(e,t,r,i,n){let s;if(void 0!==n.crit&&i?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||void 0===i.crit)return new Set;if(!Array.isArray(i.crit)||0===i.crit.length||i.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let o of(s=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,i.crit)){if(!s.has(o))throw new ek(`Extension Header Parameter "${o}" is not recognized`);if(void 0===n[o])throw new e(`Extension Header Parameter "${o}" is missing`);if(s.get(o)&&void 0===i[o])throw new e(`Extension Header Parameter "${o}" MUST be integrity protected`)}return new Set(i.crit)};class t${_plaintext;_protectedHeader;_sharedUnprotectedHeader;_unprotectedHeader;_aad;_cek;_iv;_keyManagementParameters;constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,t){let r,i,n,s,o;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new ex("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!tP(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new ex("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let a={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(tC(ex,new Map,t?.crit,this._protectedHeader,a),void 0!==a.zip)throw new ek('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:l,enc:c}=a;if("string"!=typeof l||!l)throw new ex('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof c||!c)throw new ex('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(this._cek&&("dir"===l||"ECDH-ES"===l))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${l}`);{let n;({cek:i,encryptedKey:r,parameters:n}=await tT(l,c,e,this._cek,this._keyManagementParameters)),n&&(t&&ej in t?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...n}:this.setUnprotectedHeader(n):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...n}:this.setProtectedHeader(n))}s=this._protectedHeader?ec.encode(eg(JSON.stringify(this._protectedHeader))):ec.encode(""),this._aad?(o=eg(this._aad),n=ed(s,ec.encode("."),ec.encode(o))):n=s;let{ciphertext:u,tag:d,iv:p}=await eZ(c,this._plaintext,i,this._iv,n),f={ciphertext:eg(u)};return p&&(f.iv=eg(p)),d&&(f.tag=eg(d)),r&&(f.encrypted_key=eg(r)),o&&(f.aad=o),this._protectedHeader&&(f.protected=eu.decode(s)),this._sharedUnprotectedHeader&&(f.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(f.header=this._unprotectedHeader),f}}class tO{_flattened;constructor(e){this._flattened=new t$(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this._flattened.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}let tj=e=>Math.floor(e.getTime()/1e3),tR=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,tU=e=>{let t;let r=tR.exec(e);if(!r||r[4]&&r[1])throw TypeError("Invalid time period format");let i=parseFloat(r[2]);switch(r[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(i);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*i);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*i);break;case"day":case"days":case"d":t=Math.round(86400*i);break;case"week":case"weeks":case"w":t=Math.round(604800*i);break;default:t=Math.round(31557600*i)}return"-"===r[1]||"ago"===r[4]?-t:t};function tN(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t}class tI{_payload;constructor(e={}){if(!eC(e))throw TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:tN("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:tN("setNotBefore",tj(e))}:this._payload={...this._payload,nbf:tj(new Date)+tU(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:tN("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:tN("setExpirationTime",tj(e))}:this._payload={...this._payload,exp:tj(new Date)+tU(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:tj(new Date)}:e instanceof Date?this._payload={...this._payload,iat:tN("setIssuedAt",tj(e))}:"string"==typeof e?this._payload={...this._payload,iat:tN("setIssuedAt",tj(new Date)+tU(e))}:this._payload={...this._payload,iat:tN("setIssuedAt",e)},this}}class tD extends tI{_cek;_iv;_keyManagementParameters;_protectedHeader;_replicateIssuerAsHeader;_replicateSubjectAsHeader;_replicateAudienceAsHeader;setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,t){let r=new tO(ec.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,t)}}let tL=e=>e.d?(0,eo.createPrivateKey)({format:"jwk",key:e}):(0,eo.createPublicKey)({format:"jwk",key:e});async function tQ(e,t){if(!eC(e))throw TypeError("JWK must be an object");switch(t||=e.alg,e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');return ew(e.k);case"RSA":if("oth"in e&&void 0!==e.oth)throw new ek('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return tL({...e,alg:t});default:throw new ek('Unsupported "kty" (Key Type) Parameter value')}}async function tB(e,t,r,i,n){switch(tS(e,t,"decrypt"),t=await tp.normalizePrivateKey?.(t,e)||t,e){case"dir":if(void 0!==r)throw new ex("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new ex("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let n,s;if(!eC(i.epk))throw new ex('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!e7(t))throw new ek("ECDH with the provided key is not allowed or not supported by your javascript runtime");let o=await tQ(i.epk,e);if(void 0!==i.apu){if("string"!=typeof i.apu)throw new ex('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{n=ew(i.apu)}catch{throw new ex("Failed to base64url decode the apu")}}if(void 0!==i.apv){if("string"!=typeof i.apv)throw new ex('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{s=ew(i.apv)}catch{throw new ex("Failed to base64url decode the apv")}}let a=await e4(o,t,"ECDH-ES"===e?i.enc:e,"ECDH-ES"===e?tf(i.enc):parseInt(e.slice(-5,-2),10),n,s);if("ECDH-ES"===e)return a;if(void 0===r)throw new ex("JWE Encrypted Key missing");return e1(e.slice(-6),a,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new ex("JWE Encrypted Key missing");return td(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let s;if(void 0===r)throw new ex("JWE Encrypted Key missing");if("number"!=typeof i.p2c)throw new ex('JOSE Header "p2c" (PBES2 Count) missing or invalid');let o=n?.maxPBES2Count||1e4;if(i.p2c>o)throw new ex('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof i.p2s)throw new ex('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{s=ew(i.p2s)}catch{throw new ex("Failed to base64url decode the p2s")}return ti(e,t,r,i.p2c,s)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new ex("JWE Encrypted Key missing");return e1(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let n,s;if(void 0===r)throw new ex("JWE Encrypted Key missing");if("string"!=typeof i.iv)throw new ex('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof i.tag)throw new ex('JOSE Header "tag" (Authentication Tag) missing or invalid');try{n=ew(i.iv)}catch{throw new ex("Failed to base64url decode the iv")}try{s=ew(i.tag)}catch{throw new ex("Failed to base64url decode the tag")}return tE(e,t,r,n,s)}default:throw new ek('Invalid or unsupported "alg" (JWE Algorithm) header value')}}let tq=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function tM(e,t,r){let i,n,s,o,a,l,c;if(!eC(e))throw new ex("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new ex("JOSE Header missing");if(void 0!==e.iv&&"string"!=typeof e.iv)throw new ex("JWE Initialization Vector incorrect type");if("string"!=typeof e.ciphertext)throw new ex("JWE Ciphertext missing or incorrect type");if(void 0!==e.tag&&"string"!=typeof e.tag)throw new ex("JWE Authentication Tag incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new ex("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new ex("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new ex("JWE AAD incorrect type");if(void 0!==e.header&&!eC(e.header))throw new ex("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!eC(e.unprotected))throw new ex("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=ew(e.protected);i=JSON.parse(eu.decode(t))}catch{throw new ex("JWE Protected Header is invalid")}if(!tP(i,e.header,e.unprotected))throw new ex("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let u={...i,...e.header,...e.unprotected};if(tC(ex,new Map,r?.crit,i,u),void 0!==u.zip)throw new ek('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:d,enc:p}=u;if("string"!=typeof d||!d)throw new ex("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof p||!p)throw new ex("missing JWE Encryption Algorithm (enc) in JWE Header");let f=r&&tq("keyManagementAlgorithms",r.keyManagementAlgorithms),h=r&&tq("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(f&&!f.has(d)||!f&&d.startsWith("PBES2"))throw new eS('"alg" (Algorithm) Header Parameter value not allowed');if(h&&!h.has(p))throw new eS('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(void 0!==e.encrypted_key)try{n=ew(e.encrypted_key)}catch{throw new ex("Failed to base64url decode the encrypted_key")}let m=!1;"function"==typeof t&&(t=await t(i,e),m=!0);try{s=await tB(d,t,n,u,r)}catch(e){if(e instanceof TypeError||e instanceof ex||e instanceof ek)throw e;s=th(p)}if(void 0!==e.iv)try{o=ew(e.iv)}catch{throw new ex("Failed to base64url decode the iv")}if(void 0!==e.tag)try{a=ew(e.tag)}catch{throw new ex("Failed to base64url decode the tag")}let y=ec.encode(e.protected??"");l=void 0!==e.aad?ed(y,ec.encode("."),ec.encode(e.aad)):y;try{c=ew(e.ciphertext)}catch{throw new ex("Failed to base64url decode the ciphertext")}let g={plaintext:await tA(p,s,c,o,a,l)};if(void 0!==e.protected&&(g.protectedHeader=i),void 0!==e.aad)try{g.additionalAuthenticatedData=ew(e.aad)}catch{throw new ex("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(g.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(g.unprotectedHeader=e.header),m)?{...g,key:t}:g}async function tz(e,t,r){if(e instanceof Uint8Array&&(e=eu.decode(e)),"string"!=typeof e)throw new ex("Compact JWE must be a string or Uint8Array");let{0:i,1:n,2:s,3:o,4:a,length:l}=e.split(".");if(5!==l)throw new ex("Invalid Compact JWE");let c=await tM({ciphertext:o,iv:s||void 0,protected:i,tag:a||void 0,encrypted_key:n||void 0},t,r),u={plaintext:c.plaintext,protectedHeader:c.protectedHeader};return"function"==typeof t?{...u,key:c.key}:u}let tH=e=>e.toLowerCase().replace(/^application\//,""),tK=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e))),tW=(e,t,r={})=>{let i,n;try{i=JSON.parse(eu.decode(t))}catch{}if(!eC(i))throw new eE("JWT Claims Set must be a top-level JSON object");let{typ:s}=r;if(s&&("string"!=typeof e.typ||tH(e.typ)!==tH(s)))throw new ev('unexpected "typ" JWT header value',i,"typ","check_failed");let{requiredClaims:o=[],issuer:a,subject:l,audience:c,maxTokenAge:u}=r,d=[...o];for(let e of(void 0!==u&&d.push("iat"),void 0!==c&&d.push("aud"),void 0!==l&&d.push("sub"),void 0!==a&&d.push("iss"),new Set(d.reverse())))if(!(e in i))throw new ev(`missing required "${e}" claim`,i,e,"missing");if(a&&!(Array.isArray(a)?a:[a]).includes(i.iss))throw new ev('unexpected "iss" claim value',i,"iss","check_failed");if(l&&i.sub!==l)throw new ev('unexpected "sub" claim value',i,"sub","check_failed");if(c&&!tK(i.aud,"string"==typeof c?[c]:c))throw new ev('unexpected "aud" claim value',i,"aud","check_failed");switch(typeof r.clockTolerance){case"string":n=tU(r.clockTolerance);break;case"number":n=r.clockTolerance;break;case"undefined":n=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:p}=r,f=tj(p||new Date);if((void 0!==i.iat||u)&&"number"!=typeof i.iat)throw new ev('"iat" claim must be a number',i,"iat","invalid");if(void 0!==i.nbf){if("number"!=typeof i.nbf)throw new ev('"nbf" claim must be a number',i,"nbf","invalid");if(i.nbf>f+n)throw new ev('"nbf" claim timestamp check failed',i,"nbf","check_failed")}if(void 0!==i.exp){if("number"!=typeof i.exp)throw new ev('"exp" claim must be a number',i,"exp","invalid");if(i.exp<=f-n)throw new e_('"exp" claim timestamp check failed',i,"exp","check_failed")}if(u){let e=f-i.iat;if(e-n>("number"==typeof u?u:tU(u)))throw new e_('"iat" claim timestamp check failed (too far in the past)',i,"iat","check_failed");if(e<0-n)throw new ev('"iat" claim timestamp check failed (it should be in the past)',i,"iat","check_failed")}return i};async function tF(e,t,r){let i=await tz(e,t,r),n=tW(i.protectedHeader,i.plaintext,r),{protectedHeader:s}=i;if(void 0!==s.iss&&s.iss!==n.iss)throw new ev('replicated "iss" claim header parameter mismatch',n,"iss","mismatch");if(void 0!==s.sub&&s.sub!==n.sub)throw new ev('replicated "sub" claim header parameter mismatch',n,"sub","mismatch");if(void 0!==s.aud&&JSON.stringify(s.aud)!==JSON.stringify(n.aud))throw new ev('replicated "aud" claim header parameter mismatch',n,"aud","mismatch");let o={payload:n,protectedHeader:s};return"function"==typeof t?{...o,key:i.key}:o}var tJ=r(50479);let tV=()=>Date.now()/1e3|0,tG="A256CBC-HS512";async function tZ(e){let{token:t={},secret:r,maxAge:i=2592e3,salt:n}=e,s=Array.isArray(r)?r:[r],o=await tY(tG,s[0],n),a=await eO({kty:"oct",k:eg(o)},`sha${o.byteLength<<3}`);return await new tD(t).setProtectedHeader({alg:"dir",enc:tG,kid:a}).setIssuedAt().setExpirationTime(tV()+i).setJti(crypto.randomUUID()).encrypt(o)}async function tX(e){let{token:t,secret:r,salt:i}=e,n=Array.isArray(r)?r:[r];if(!t)return null;let{payload:s}=await tF(t,async({kid:e,enc:t})=>{for(let r of n){let n=await tY(t,r,i);if(void 0===e||e===await eO({kty:"oct",k:eg(n)},`sha${n.byteLength<<3}`))return n}throw Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:["dir"],contentEncryptionAlgorithms:[tG,"A256GCM"]});return s}async function tY(e,t,r){let i;switch(e){case"A256CBC-HS512":i=64;break;case"A256GCM":i=32;break;default:throw Error("Unsupported JWT Content Encryption Algorithm")}return await es("sha256",t,r,`Auth.js Generated Encryption Key (${r})`,i)}async function t0({options:e,paramValue:t,cookieValue:r}){let{url:i,callbacks:n}=e,s=i.origin;return t?s=await n.redirect({url:t,baseUrl:i.origin}):r&&(s=await n.redirect({url:r,baseUrl:i.origin})),{callbackUrl:s,callbackUrlCookie:s!==r?s:void 0}}let t1="\x1b[31m",t2="\x1b[0m",t3={error(e){let t=e instanceof p?e.type:e.name;if(console.error(`${t1}[auth][error]${t2} ${t}: ${e.message}`),e.cause&&"object"==typeof e.cause&&"err"in e.cause&&e.cause.err instanceof Error){let{err:t,...r}=e.cause;console.error(`${t1}[auth][cause]${t2}:`,t.stack),r&&console.error(`${t1}[auth][details]${t2}:`,JSON.stringify(r,null,2))}else e.stack&&console.error(e.stack.replace(/.*/,"").substring(1))},warn(e){let t=`https://warnings.authjs.dev#${e}`;console.warn(`\x1b[33m[auth][warn][${e}]${t2}`,`Read more: ${t}`)},debug(e,t){console.log(`\x1b[90m[auth][debug]:${t2} ${e}`,JSON.stringify(t,null,2))}};function t6(e){let t={...t3};return e.debug||(t.debug=()=>{}),e.logger?.error&&(t.error=e.logger.error),e.logger?.warn&&(t.warn=e.logger.warn),e.logger?.debug&&(t.debug=e.logger.debug),e.logger??(e.logger=t),t}let t5=["providers","session","csrf","signin","signout","callback","verify-request","error","webauthn-options"];async function t4(e){if(!("body"in e)||!e.body||"POST"!==e.method)return;let t=e.headers.get("content-type");return t?.includes("application/json")?await e.json():t?.includes("application/x-www-form-urlencoded")?Object.fromEntries(new URLSearchParams(await e.text())):void 0}async function t8(e,t){try{if("GET"!==e.method&&"POST"!==e.method)throw new N("Only GET and POST requests are supported");t.basePath??(t.basePath="/auth");let r=new URL(e.url),{action:i,providerId:n}=function(e,t){let r=e.match(RegExp(`^${t}(.+)`));if(null===r)throw new N(`Cannot parse action at ${e}`);let i=r.at(-1).replace(/^\//,"").split("/").filter(Boolean);if(1!==i.length&&2!==i.length)throw new N(`Cannot parse action at ${e}`);let[n,s]=i;if(!t5.includes(n)||s&&!["signin","callback","webauthn-options"].includes(n))throw new N(`Cannot parse action at ${e}`);return{action:n,providerId:s}}(r.pathname,t.basePath);return{url:r,action:i,providerId:n,method:e.method,headers:Object.fromEntries(e.headers),body:e.body?await t4(e):void 0,cookies:(0,tJ.Q)(e.headers.get("cookie")??"")??{},error:r.searchParams.get("error")??void 0,query:Object.fromEntries(r.searchParams)}}catch(i){let r=t6(t);r.error(i),r.debug("request",e)}}function t7(e){let t=new Headers(e.headers);e.cookies?.forEach(e=>{let{name:r,value:i,options:n}=e,s=tJ.q(r,i,n);t.has("Set-Cookie")?t.append("Set-Cookie",s):t.set("Set-Cookie",s)});let r=e.body;"application/json"===t.get("content-type")?r=JSON.stringify(e.body):"application/x-www-form-urlencoded"===t.get("content-type")&&(r=new URLSearchParams(e.body).toString());let i=new Response(r,{headers:t,status:e.redirect?302:e.status??200});return e.redirect&&i.headers.set("Location",e.redirect),i}async function t9(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("").toString()}function re(e){let t=e=>("0"+e.toString(16)).slice(-2);return Array.from(crypto.getRandomValues(new Uint8Array(e))).reduce((e,r)=>e+t(r),"")}async function rt({options:e,cookieValue:t,isPost:r,bodyValue:i}){if(t){let[n,s]=t.split("|");if(s===await t9(`${n}${e.secret}`))return{csrfTokenVerified:r&&n===i,csrfToken:n}}let n=re(32),s=await t9(`${n}${e.secret}`);return{cookie:`${n}|${s}`,csrfToken:n}}function rr(e,t){if(!t)throw new B(`CSRF token was missing during an action ${e}`)}function ri(e){return null!==e&&"object"==typeof e}function rn(e,...t){if(!t.length)return e;let r=t.shift();if(ri(e)&&ri(r))for(let t in r)ri(r[t])?(ri(e[t])||(e[t]=Array.isArray(r[t])?[]:{}),rn(e[t],r[t])):void 0!==r[t]&&(e[t]=r[t]);return rn(e,...t)}let rs=e=>ra({id:e.sub??e.id??crypto.randomUUID(),name:e.name??e.nickname??e.preferred_username,email:e.email,image:e.picture}),ro=e=>ra({access_token:e.access_token,id_token:e.id_token,refresh_token:e.refresh_token,expires_at:e.expires_at,scope:e.scope,token_type:e.token_type,session_state:e.session_state});function ra(e){let t={};for(let[r,i]of Object.entries(e))void 0!==i&&(t[r]=i);return t}function rl(e,t){if(!e&&t)return;if("string"==typeof e)return{url:new URL(e)};let r=new URL(e?.url??"https://authjs.dev");if(e?.params!=null)for(let[t,i]of Object.entries(e.params))"claims"===t&&(i=JSON.stringify(i)),r.searchParams.set(t,String(i));return{url:r,request:e?.request,conform:e?.conform,...e?.clientPrivateKey?{clientPrivateKey:e?.clientPrivateKey}:null}}let rc={signIn:()=>!0,redirect:({url:e,baseUrl:t})=>e.startsWith("/")?`${t}${e}`:new URL(e).origin===t?e:t,session:({session:e})=>({user:{name:e.user?.name,email:e.user?.email,image:e.user?.image},expires:e.expires?.toISOString?.()??e.expires}),jwt:({token:e})=>e};async function ru({authOptions:e,providerId:t,action:r,url:i,cookies:n,callbackUrl:s,csrfToken:o,csrfDisabled:a,isPost:l}){var c;let d=t6(e),{providers:p,provider:f}=function(e){let{providerId:t,options:r}=e,i=new URL(r.basePath??"/auth",e.url.origin),n=e.providers.map(e=>{let t="function"==typeof e?e():e,{options:n,...s}=t,o=n?.id??s.id,a=rn(s,n,{signinUrl:`${i}/signin/${o}`,callbackUrl:`${i}/callback/${o}`});return"oauth"===t.type||"oidc"===t.type?(a.redirectProxyUrl??(a.redirectProxyUrl=r.redirectProxyUrl),function(e){e.issuer&&(e.wellKnown??(e.wellKnown=`${e.issuer}/.well-known/openid-configuration`));let t=rl(e.authorization,e.issuer);t&&!t.url?.searchParams.has("scope")&&t.url.searchParams.set("scope","openid profile email");let r=rl(e.token,e.issuer),i=rl(e.userinfo,e.issuer),n=e.checks??["pkce"];return e.redirectProxyUrl&&(n.includes("state")||n.push("state"),e.redirectProxyUrl=`${e.redirectProxyUrl}/callback/${e.id}`),{...e,authorization:t,token:r,checks:n,userinfo:i,profile:e.profile??rs,account:e.account??ro}}(a)):a});return{providers:n,provider:n.find(({id:e})=>e===t)}}({providers:e.providers,url:i,providerId:t,options:e}),m=!1;if((f?.type==="oauth"||f?.type==="oidc")&&f.redirectProxyUrl)try{m=new URL(f.redirectProxyUrl).origin===i.origin}catch{throw TypeError(`redirectProxyUrl must be a valid URL. Received: ${f.redirectProxyUrl}`)}let y={debug:!1,pages:{},theme:{colorScheme:"auto",logo:"",brandColor:"",buttonText:""},...e,url:i,action:r,provider:f,cookies:rn(u(e.useSecureCookies??"https:"===i.protocol),e.cookies),providers:p,session:{strategy:e.adapter?"database":"jwt",maxAge:2592e3,updateAge:86400,generateSessionToken:()=>crypto.randomUUID(),...e.session},jwt:{secret:e.secret,maxAge:e.session?.maxAge??2592e3,encode:tZ,decode:tX,...e.jwt},events:Object.keys(c=e.events??{}).reduce((e,t)=>(e[t]=async(...e)=>{try{let r=c[t];return await r(...e)}catch(e){d.error(new w(e))}},e),{}),adapter:function(e,t){if(e)return Object.keys(e).reduce((r,i)=>(r[i]=async(...r)=>{try{t.debug(`adapter_${i}`,{args:r});let n=e[i];return await n(...r)}catch(r){let e=new h(r);throw t.error(e),e}},r),{})}(e.adapter,d),callbacks:{...rc,...e.callbacks},logger:d,callbackUrl:i.origin,isOnRedirectProxy:m,experimental:{...e.experimental}},g=[];if(a)y.csrfTokenVerified=!0;else{let{csrfToken:e,cookie:t,csrfTokenVerified:r}=await rt({options:y,cookieValue:n?.[y.cookies.csrfToken.name],isPost:l,bodyValue:o});y.csrfToken=e,y.csrfTokenVerified=r,t&&g.push({name:y.cookies.csrfToken.name,value:t,options:y.cookies.csrfToken.options})}let{callbackUrl:b,callbackUrlCookie:v}=await t0({options:y,cookieValue:n?.[y.cookies.callbackUrl.name],paramValue:s});return y.callbackUrl=b,v&&g.push({name:y.cookies.callbackUrl.name,value:v,options:y.cookies.callbackUrl.options}),{options:y,cookies:g}}var rd,rp,rf,rh,rm,ry,rg,rw,rb,rv,r_,rS={},rk=[],rA=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function rx(e,t){for(var r in t)e[r]=t[r];return e}function rE(e){var t=e.parentNode;t&&t.removeChild(e)}function rT(e,t,r,i,n){var s={type:e,props:t,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==n?++rb:n};return null==n&&null!=rw.vnode&&rw.vnode(s),s}function rP(e){return e.children}function rC(e,t){this.props=e,this.context=t}function r$(e,t){if(null==t)return e.__?r$(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?r$(e):null}function rO(e){(!e.__d&&(e.__d=!0)&&rv.push(e)&&!rj.__r++||r_!==rw.debounceRendering)&&((r_=rw.debounceRendering)||setTimeout)(rj)}function rj(){for(var e;rj.__r=rv.length;)e=rv.sort(function(e,t){return e.__v.__b-t.__v.__b}),rv=[],e.some(function(e){var t,r,i,n,s;e.__d&&(n=(i=e.__v).__e,(s=e.__P)&&(t=[],(r=rx({},i)).__v=i.__v+1,rQ(s,i,r,e.__n,void 0!==s.ownerSVGElement,null!=i.__h?[n]:null,t,null==n?r$(i):n,i.__h),rB(t,i),i.__e!=n&&function e(t){var r,i;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,r=0;r<t.__k.length;r++)if(null!=(i=t.__k[r])&&null!=i.__e){t.__e=t.__c.base=i.__e;break}return e(t)}}(i)))})}function rR(e,t,r,i,n,s,o,a,l,c){var u,d,p,f,h,m,y,g=i&&i.__k||rk,w=g.length;for(r.__k=[],u=0;u<t.length;u++)if(null!=(f=r.__k[u]=null==(f=t[u])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f||"bigint"==typeof f?rT(null,f,null,null,f):Array.isArray(f)?rT(rP,{children:f},null,null,null):f.__b>0?rT(f.type,f.props,f.key,f.ref?f.ref:null,f.__v):f)){if(f.__=r,f.__b=r.__b+1,null===(p=g[u])||p&&f.key==p.key&&f.type===p.type)g[u]=void 0;else for(d=0;d<w;d++){if((p=g[d])&&f.key==p.key&&f.type===p.type){g[d]=void 0;break}p=null}rQ(e,f,p=p||rS,n,s,o,a,l,c),h=f.__e,(d=f.ref)&&p.ref!=d&&(y||(y=[]),p.ref&&y.push(p.ref,null,f),y.push(d,f.__c||h,f)),null!=h?(null==m&&(m=h),"function"==typeof f.type&&f.__k===p.__k?f.__d=l=function e(t,r,i){for(var n,s=t.__k,o=0;s&&o<s.length;o++)(n=s[o])&&(n.__=t,r="function"==typeof n.type?e(n,r,i):rU(i,n,n,s,n.__e,r));return r}(f,l,e):l=rU(e,f,p,g,h,l),"function"==typeof r.type&&(r.__d=l)):l&&p.__e==l&&l.parentNode!=e&&(l=r$(p))}for(r.__e=m,u=w;u--;)null!=g[u]&&function e(t,r,i){var n,s;if(rw.unmount&&rw.unmount(t),(n=t.ref)&&(n.current&&n.current!==t.__e||rq(n,null,r)),null!=(n=t.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){rw.__e(e,r)}n.base=n.__P=null,t.__c=void 0}if(n=t.__k)for(s=0;s<n.length;s++)n[s]&&e(n[s],r,i||"function"!=typeof t.type);i||null==t.__e||rE(t.__e),t.__=t.__e=t.__d=void 0}(g[u],g[u]);if(y)for(u=0;u<y.length;u++)rq(y[u],y[++u],y[++u])}function rU(e,t,r,i,n,s){var o,a,l;if(void 0!==t.__d)o=t.__d,t.__d=void 0;else if(null==r||n!=s||null==n.parentNode)e:if(null==s||s.parentNode!==e)e.appendChild(n),o=null;else{for(a=s,l=0;(a=a.nextSibling)&&l<i.length;l+=1)if(a==n)break e;e.insertBefore(n,s),o=s}return void 0!==o?o:n.nextSibling}function rN(e,t,r){"-"===t[0]?e.setProperty(t,r):e[t]=null==r?"":"number"!=typeof r||rA.test(t)?r:r+"px"}function rI(e,t,r,i,n){var s;e:if("style"===t){if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)r&&t in r||rN(e.style,t,"");if(r)for(t in r)i&&r[t]===i[t]||rN(e.style,t,r[t])}}else if("o"===t[0]&&"n"===t[1])s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase() in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=r,r?i||e.addEventListener(t,s?rL:rD,s):e.removeEventListener(t,s?rL:rD,s);else if("dangerouslySetInnerHTML"!==t){if(n)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null==r||!1===r&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,r))}}function rD(e){this.l[e.type+!1](rw.event?rw.event(e):e)}function rL(e){this.l[e.type+!0](rw.event?rw.event(e):e)}function rQ(e,t,r,i,n,s,o,a,l){var c,u,d,p,f,h,m,y,g,w,b,v,_,S,k,A=t.type;if(void 0!==t.constructor)return null;null!=r.__h&&(l=r.__h,a=t.__e=r.__e,t.__h=null,s=[a]),(c=rw.__b)&&c(t);try{e:if("function"==typeof A){if(y=t.props,g=(c=A.contextType)&&i[c.__c],w=c?g?g.props.value:c.__:i,r.__c?m=(u=t.__c=r.__c).__=u.__E:("prototype"in A&&A.prototype.render?t.__c=u=new A(y,w):(t.__c=u=new rC(y,w),u.constructor=A,u.render=rM),g&&g.sub(u),u.props=y,u.state||(u.state={}),u.context=w,u.__n=i,d=u.__d=!0,u.__h=[],u._sb=[]),null==u.__s&&(u.__s=u.state),null!=A.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=rx({},u.__s)),rx(u.__s,A.getDerivedStateFromProps(y,u.__s))),p=u.props,f=u.state,d)null==A.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(null==A.getDerivedStateFromProps&&y!==p&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(y,w),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(y,u.__s,w)||t.__v===r.__v){for(u.props=y,u.state=u.__s,t.__v!==r.__v&&(u.__d=!1),u.__v=t,t.__e=r.__e,t.__k=r.__k,t.__k.forEach(function(e){e&&(e.__=t)}),b=0;b<u._sb.length;b++)u.__h.push(u._sb[b]);u._sb=[],u.__h.length&&o.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(y,u.__s,w),null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(p,f,h)})}if(u.context=w,u.props=y,u.__v=t,u.__P=e,v=rw.__r,_=0,"prototype"in A&&A.prototype.render){for(u.state=u.__s,u.__d=!1,v&&v(t),c=u.render(u.props,u.state,u.context),S=0;S<u._sb.length;S++)u.__h.push(u._sb[S]);u._sb=[]}else do u.__d=!1,v&&v(t),c=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++_<25);u.state=u.__s,null!=u.getChildContext&&(i=rx(rx({},i),u.getChildContext())),d||null==u.getSnapshotBeforeUpdate||(h=u.getSnapshotBeforeUpdate(p,f)),k=null!=c&&c.type===rP&&null==c.key?c.props.children:c,rR(e,Array.isArray(k)?k:[k],t,r,i,n,s,o,a,l),u.base=t.__e,t.__h=null,u.__h.length&&o.push(u),m&&(u.__E=u.__=null),u.__e=!1}else null==s&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=function(e,t,r,i,n,s,o,a){var l,c,u,d=r.props,p=t.props,f=t.type,h=0;if("svg"===f&&(n=!0),null!=s){for(;h<s.length;h++)if((l=s[h])&&"setAttribute"in l==!!f&&(f?l.localName===f:3===l.nodeType)){e=l,s[h]=null;break}}if(null==e){if(null===f)return document.createTextNode(p);e=n?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,p.is&&p),s=null,a=!1}if(null===f)d===p||a&&e.data===p||(e.data=p);else{if(s=s&&rg.call(e.childNodes),c=(d=r.props||rS).dangerouslySetInnerHTML,u=p.dangerouslySetInnerHTML,!a){if(null!=s)for(d={},h=0;h<e.attributes.length;h++)d[e.attributes[h].name]=e.attributes[h].value;(u||c)&&(u&&(c&&u.__html==c.__html||u.__html===e.innerHTML)||(e.innerHTML=u&&u.__html||""))}if(function(e,t,r,i,n){var s;for(s in r)"children"===s||"key"===s||s in t||rI(e,s,null,r[s],i);for(s in t)n&&"function"!=typeof t[s]||"children"===s||"key"===s||"value"===s||"checked"===s||r[s]===t[s]||rI(e,s,t[s],r[s],i)}(e,p,d,n,a),u)t.__k=[];else if(rR(e,Array.isArray(h=t.props.children)?h:[h],t,r,i,n&&"foreignObject"!==f,s,o,s?s[0]:r.__k&&r$(r,0),a),null!=s)for(h=s.length;h--;)null!=s[h]&&rE(s[h]);a||("value"in p&&void 0!==(h=p.value)&&(h!==e.value||"progress"===f&&!h||"option"===f&&h!==d.value)&&rI(e,"value",h,d.value,!1),"checked"in p&&void 0!==(h=p.checked)&&h!==e.checked&&rI(e,"checked",h,d.checked,!1))}return e}(r.__e,t,r,i,n,s,o,l);(c=rw.diffed)&&c(t)}catch(e){t.__v=null,(l||null!=s)&&(t.__e=a,t.__h=!!l,s[s.indexOf(a)]=null),rw.__e(e,t,r)}}function rB(e,t){rw.__c&&rw.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){rw.__e(e,t.__v)}})}function rq(e,t,r){try{"function"==typeof e?e(t):e.current=t}catch(e){rw.__e(e,r)}}function rM(e,t,r){return this.constructor(e,r)}function rz(e,t){var r,i,n,s;r=e,rw.__&&rw.__(r,t),n=(i="function"==typeof rz)?null:rz&&rz.__k||t.__k,s=[],rQ(t,r=(!i&&rz||t).__k=function(e,t,r){var i,n,s,o={};for(s in t)"key"==s?i=t[s]:"ref"==s?n=t[s]:o[s]=t[s];if(arguments.length>2&&(o.children=arguments.length>3?rg.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===o[s]&&(o[s]=e.defaultProps[s]);return rT(e,o,i,n,null)}(rP,null,[r]),n||rS,rS,void 0!==t.ownerSVGElement,!i&&rz?[rz]:n?null:t.firstChild?rg.call(t.childNodes):null,s,!i&&rz?rz:n?n.__e:t.firstChild,i),rB(s,r)}rg=rk.slice,rw={__e:function(e,t,r,i){for(var n,s,o;t=t.__;)if((n=t.__c)&&!n.__)try{if((s=n.constructor)&&null!=s.getDerivedStateFromError&&(n.setState(s.getDerivedStateFromError(e)),o=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e,i||{}),o=n.__d),o)return n.__E=n}catch(t){e=t}throw e}},rb=0,rC.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=rx({},this.state),"function"==typeof e&&(e=e(rx({},r),this.props)),e&&rx(r,e),null!=e&&this.__v&&(t&&this._sb.push(t),rO(this))},rC.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),rO(this))},rC.prototype.render=rP,rv=[],rj.__r=0;var rH=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,rK=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,rW=/[\s\n\\/='"\0<>]/,rF=/^xlink:?./,rJ=/["&<]/;function rV(e){if(!1===rJ.test(e+=""))return e;for(var t=0,r=0,i="",n="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 60:n="&lt;";break;default:continue}r!==t&&(i+=e.slice(t,r)),i+=n,t=r+1}return r!==t&&(i+=e.slice(t,r)),i}var rG=function(e,t){return String(e).replace(/(\n+)/g,"$1"+(t||"	"))},rZ=function(e,t,r){return String(e).length>(t||40)||!r&&-1!==String(e).indexOf("\n")||-1!==String(e).indexOf("<")},rX={},rY=/([A-Z])/g;function r0(e){var t="";for(var r in e){var i=e[r];null!=i&&""!==i&&(t&&(t+=" "),t+="-"==r[0]?r:rX[r]||(rX[r]=r.replace(rY,"-$1").toLowerCase()),t="number"==typeof i&&!1===rH.test(r)?t+": "+i+"px;":t+": "+i+";")}return t||void 0}function r1(e,t){return Array.isArray(t)?t.reduce(r1,e):null!=t&&!1!==t&&e.push(t),e}function r2(){this.__d=!0}function r3(e,t){return{__v:e,context:t,props:e.props,setState:r2,forceUpdate:r2,__d:!0,__h:[]}}function r6(e,t){var r=e.contextType,i=r&&t[r.__c];return null!=r?i?i.props.value:r.__:t}var r5=[],r4={shallow:!0};r7.render=r7;var r8=[];function r7(e,t,r){t=t||{};var i,n=rw.__s;return rw.__s=!0,i=r&&(r.pretty||r.voidElements||r.sortAttributes||r.shallow||r.allAttributes||r.xml||r.attributeHook)?function e(t,r,i,n,s,o){if(null==t||"boolean"==typeof t)return"";if("object"!=typeof t)return rV(t);var a=i.pretty,l=a&&"string"==typeof a?a:"	";if(Array.isArray(t)){for(var c="",u=0;u<t.length;u++)a&&u>0&&(c+="\n"),c+=e(t[u],r,i,n,s,o);return c}var d,p=t.type,f=t.props,h=!1;if("function"==typeof p){if(h=!0,!i.shallow||!n&&!1!==i.renderRootComponent){if(p===rP){var m=[];return r1(m,t.props.children),e(m,r,i,!1!==i.shallowHighOrder,s,o)}var y,g=t.__c=r3(t,r);rw.__b&&rw.__b(t);var w=rw.__r;if(p.prototype&&"function"==typeof p.prototype.render){var b=r6(p,r);(g=t.__c=new p(f,b)).__v=t,g._dirty=g.__d=!0,g.props=f,null==g.state&&(g.state={}),null==g._nextState&&null==g.__s&&(g._nextState=g.__s=g.state),g.context=b,p.getDerivedStateFromProps?g.state=Object.assign({},g.state,p.getDerivedStateFromProps(g.props,g.state)):g.componentWillMount&&(g.componentWillMount(),g.state=g._nextState!==g.state?g._nextState:g.__s!==g.state?g.__s:g.state),w&&w(t),y=g.render(g.props,g.state,g.context)}else for(var v=r6(p,r),_=0;g.__d&&_++<25;)g.__d=!1,w&&w(t),y=p.call(t.__c,f,v);return g.getChildContext&&(r=Object.assign({},r,g.getChildContext())),rw.diffed&&rw.diffed(t),e(y,r,i,!1!==i.shallowHighOrder,s,o)}p=(d=p).displayName||d!==Function&&d.name||function(e){var t=(Function.prototype.toString.call(e).match(/^\s*function\s+([^( ]+)/)||"")[1];if(!t){for(var r=-1,i=r5.length;i--;)if(r5[i]===e){r=i;break}r<0&&(r=r5.push(e)-1),t="UnnamedComponent"+r}return t}(d)}var S,k,A="<"+p;if(f){var x=Object.keys(f);i&&!0===i.sortAttributes&&x.sort();for(var E=0;E<x.length;E++){var T=x[E],P=f[T];if("children"!==T){if(!rW.test(T)&&(i&&i.allAttributes||"key"!==T&&"ref"!==T&&"__self"!==T&&"__source"!==T)){if("defaultValue"===T)T="value";else if("defaultChecked"===T)T="checked";else if("defaultSelected"===T)T="selected";else if("className"===T){if(void 0!==f.class)continue;T="class"}else s&&rF.test(T)&&(T=T.toLowerCase().replace(/^xlink:?/,"xlink:"));if("htmlFor"===T){if(f.for)continue;T="for"}"style"===T&&P&&"object"==typeof P&&(P=r0(P)),"a"===T[0]&&"r"===T[1]&&"boolean"==typeof P&&(P=String(P));var C=i.attributeHook&&i.attributeHook(T,P,r,i,h);if(C||""===C)A+=C;else if("dangerouslySetInnerHTML"===T)k=P&&P.__html;else if("textarea"===p&&"value"===T)S=P;else if((P||0===P||""===P)&&"function"!=typeof P){if(!(!0!==P&&""!==P||(P=T,i&&i.xml))){A=A+" "+T;continue}if("value"===T){if("select"===p){o=P;continue}"option"===p&&o==P&&void 0===f.selected&&(A+=" selected")}A=A+" "+T+'="'+rV(P)+'"'}}}else S=P}}if(a){var $=A.replace(/\n\s*/," ");$===A||~$.indexOf("\n")?a&&~A.indexOf("\n")&&(A+="\n"):A=$}if(A+=">",rW.test(p))throw Error(p+" is not a valid HTML tag name in "+A);var O,j=rK.test(p)||i.voidElements&&i.voidElements.test(p),R=[];if(k)a&&rZ(k)&&(k="\n"+l+rG(k,l)),A+=k;else if(null!=S&&r1(O=[],S).length){for(var U=a&&~A.indexOf("\n"),N=!1,I=0;I<O.length;I++){var D=O[I];if(null!=D&&!1!==D){var L=e(D,r,i,!0,"svg"===p||"foreignObject"!==p&&s,o);if(a&&!U&&rZ(L)&&(U=!0),L){if(a){var Q=L.length>0&&"<"!=L[0];N&&Q?R[R.length-1]+=L:R.push(L),N=Q}else R.push(L)}}}if(a&&U)for(var B=R.length;B--;)R[B]="\n"+l+rG(R[B],l)}if(R.length||k)A+=R.join("");else if(i&&i.xml)return A.substring(0,A.length-1)+" />";return!j||O||k?(a&&~A.indexOf("\n")&&(A+="\n"),A=A+"</"+p+">"):A=A.replace(/>$/," />"),A}(e,t,r):function e(t,r,i,n){if(null==t||!0===t||!1===t||""===t)return"";if("object"!=typeof t)return rV(t);if(r9(t)){for(var s="",o=0;o<t.length;o++)s+=e(t[o],r,i,n);return s}rw.__b&&rw.__b(t);var a=t.type,l=t.props;if("function"==typeof a){if(a===rP)return e(t.props.children,r,i,n);h=a.prototype&&"function"==typeof a.prototype.render?(c=r,d=r6(u=t.type,c),p=new u(t.props,d),t.__c=p,p.__v=t,p.__d=!0,p.props=t.props,null==p.state&&(p.state={}),null==p.__s&&(p.__s=p.state),p.context=d,u.getDerivedStateFromProps?p.state=ie({},p.state,u.getDerivedStateFromProps(p.props,p.state)):p.componentWillMount&&(p.componentWillMount(),p.state=p.__s!==p.state?p.__s:p.state),(f=rw.__r)&&f(t),p.render(p.props,p.state,p.context)):function(e,t){var r,i=r3(e,t),n=r6(e.type,t);e.__c=i;for(var s=rw.__r,o=0;i.__d&&o++<25;)i.__d=!1,s&&s(e),r=e.type.call(i,e.props,n);return r}(t,r);var c,u,d,p,f,h,m=t.__c;m.getChildContext&&(r=ie({},r,m.getChildContext()));var y=e(h,r,i,n);return rw.diffed&&rw.diffed(t),y}var g,w,b="<";if(b+=a,l)for(var v in g=l.children,l){var _,S,k,A=l[v];if(!("key"===v||"ref"===v||"__self"===v||"__source"===v||"children"===v||"className"===v&&"class"in l||"htmlFor"===v&&"for"in l||rW.test(v))){if(S=v="className"===(_=v)?"class":"htmlFor"===_?"for":"defaultValue"===_?"value":"defaultChecked"===_?"checked":"defaultSelected"===_?"selected":i&&rF.test(_)?_.toLowerCase().replace(/^xlink:?/,"xlink:"):_,k=A,A="style"===S&&null!=k&&"object"==typeof k?r0(k):"a"===S[0]&&"r"===S[1]&&"boolean"==typeof k?String(k):k,"dangerouslySetInnerHTML"===v)w=A&&A.__html;else if("textarea"===a&&"value"===v)g=A;else if((A||0===A||""===A)&&"function"!=typeof A){if(!0===A||""===A){A=v,b=b+" "+v;continue}if("value"===v){if("select"===a){n=A;continue}"option"!==a||n!=A||"selected"in l||(b+=" selected")}b=b+" "+v+'="'+rV(A)+'"'}}}var x=b;if(b+=">",rW.test(a))throw Error(a+" is not a valid HTML tag name in "+b);var E="",T=!1;if(w)E+=w,T=!0;else if("string"==typeof g)E+=rV(g),T=!0;else if(r9(g))for(var P=0;P<g.length;P++){var C=g[P];if(null!=C&&!1!==C){var $=e(C,r,"svg"===a||"foreignObject"!==a&&i,n);$&&(E+=$,T=!0)}}else if(null!=g&&!1!==g&&!0!==g){var O=e(g,r,"svg"===a||"foreignObject"!==a&&i,n);O&&(E+=O,T=!0)}if(rw.diffed&&rw.diffed(t),T)b+=E;else if(rK.test(a))return x+" />";return b+"</"+a+">"}(e,t,!1,void 0),rw.__c&&rw.__c(e,r8),rw.__s=n,r8.length=0,i}var r9=Array.isArray,ie=Object.assign;r7.shallowRender=function(e,t){return r7(e,t,r4)};var it=0;function ir(e,t,r,i,n){var s,o,a={};for(o in t)"ref"==o?s=t[o]:a[o]=t[o];var l={type:e,props:a,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--it,__source:n,__self:i};if("function"==typeof e&&(s=e.defaultProps))for(o in s)void 0===a[o]&&(a[o]=s[o]);return rw.vnode&&rw.vnode(l),l}async function ii(e,t){let r=window.SimpleWebAuthnBrowser;async function i(r){let i=new URL(`${e}/webauthn-options/${t}`);r&&i.searchParams.append("action",r),s().forEach(e=>{i.searchParams.append(e.name,e.value)});let n=await fetch(i);if(!n.ok){console.error("Failed to fetch options",n);return}return n.json()}function n(){let e=`#${t}-form`,r=document.querySelector(e);if(!r)throw Error(`Form '${e}' not found`);return r}function s(){return Array.from(n().querySelectorAll("input[data-form-field]"))}async function o(e,t){let r=n();if(e){let t=document.createElement("input");t.type="hidden",t.name="action",t.value=e,r.appendChild(t)}if(t){let e=document.createElement("input");e.type="hidden",e.name="data",e.value=JSON.stringify(t),r.appendChild(e)}return r.submit()}async function a(e,t){let i=await r.startAuthentication(e,t);return await o("authenticate",i)}async function l(e){s().forEach(e=>{if(e.required&&!e.value)throw Error(`Missing required field: ${e.name}`)});let t=await r.startRegistration(e);return await o("register",t)}async function c(){if(!r.browserSupportsWebAuthnAutofill())return;let e=await i("authenticate");if(!e){console.error("Failed to fetch option for autofill authentication");return}try{await a(e.options,!0)}catch(e){console.error(e)}}(async function(){let e=n();if(!r.browserSupportsWebAuthn()){e.style.display="none";return}e&&e.addEventListener("submit",async e=>{e.preventDefault();let t=await i(void 0);if(!t){console.error("Failed to fetch options for form submission");return}if("authenticate"===t.action)try{await a(t.options,!1)}catch(e){console.error(e)}else if("register"===t.action)try{await l(t.options)}catch(e){console.error(e)}})})(),c()}let is={default:"Unable to sign in.",Signin:"Try signing in with a different account.",OAuthSignin:"Try signing in with a different account.",OAuthCallbackError:"Try signing in with a different account.",OAuthCreateAccount:"Try signing in with a different account.",EmailCreateAccount:"Try signing in with a different account.",Callback:"Try signing in with a different account.",OAuthAccountNotLinked:"To confirm your identity, sign in with the same account you used originally.",EmailSignin:"The e-mail could not be sent.",CredentialsSignin:"Sign in failed. Check the details you provided are correct.",SessionRequired:"Please sign in to access this page."},io=`:root {
  --border-width: 1px;
  --border-radius: 0.5rem;
  --color-error: #c94b4b;
  --color-info: #157efb;
  --color-info-hover: #0f6ddb;
  --color-info-text: #fff;
}

.__next-auth-theme-auto,
.__next-auth-theme-light {
  --color-background: #ececec;
  --color-background-hover: rgba(236, 236, 236, 0.8);
  --color-background-card: #fff;
  --color-text: #000;
  --color-primary: #444;
  --color-control-border: #bbb;
  --color-button-active-background: #f9f9f9;
  --color-button-active-border: #aaa;
  --color-separator: #ccc;
}

.__next-auth-theme-dark {
  --color-background: #161b22;
  --color-background-hover: rgba(22, 27, 34, 0.8);
  --color-background-card: #0d1117;
  --color-text: #fff;
  --color-primary: #ccc;
  --color-control-border: #555;
  --color-button-active-background: #060606;
  --color-button-active-border: #666;
  --color-separator: #444;
}

@media (prefers-color-scheme: dark) {
  .__next-auth-theme-auto {
    --color-background: #161b22;
    --color-background-hover: rgba(22, 27, 34, 0.8);
    --color-background-card: #0d1117;
    --color-text: #fff;
    --color-primary: #ccc;
    --color-control-border: #555;
    --color-button-active-background: #060606;
    --color-button-active-border: #666;
    --color-separator: #444;
  }

  button,
  a.button {
    color: var(--provider-dark-color, var(--color-primary)) !important;
    background-color: var(
      --provider-dark-bg,
      var(--color-background)
    ) !important;
  }

    :is(button,a.button):hover {
      background-color: var(
        --provider-dark-bg-hover,
        var(--color-background-hover)
      ) !important;
    }

    :is(button,a.button) span {
      color: var(--provider-dark-bg) !important;
    }
}

html {
  box-sizing: border-box;
}

*,
*:before,
*:after {
  box-sizing: inherit;
  margin: 0;
  padding: 0;
}

body {
  background-color: var(--color-background);
  margin: 0;
  padding: 0;
  font-family:
    ui-sans-serif,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    "Helvetica Neue",
    Arial,
    "Noto Sans",
    sans-serif,
    "Apple Color Emoji",
    "Segoe UI Emoji",
    "Segoe UI Symbol",
    "Noto Color Emoji";
}

h1 {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  font-weight: 400;
  color: var(--color-text);
}

p {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  color: var(--color-text);
}

form {
  margin: 0;
  padding: 0;
}

label {
  font-weight: 500;
  text-align: left;
  margin-bottom: 0.25rem;
  display: block;
  color: var(--color-text);
}

input[type] {
  box-sizing: border-box;
  display: block;
  width: 100%;
  padding: 0.5rem 1rem;
  border: var(--border-width) solid var(--color-control-border);
  background: var(--color-background-card);
  font-size: 1rem;
  border-radius: var(--border-radius);
  color: var(--color-text);
}

p {
  font-size: 1.1rem;
  line-height: 2rem;
}

a.button {
  text-decoration: none;
  line-height: 1rem;
}

a.button:link,
  a.button:visited {
    background-color: var(--color-background);
    color: var(--color-primary);
  }

button,
a.button {
  padding: 0.75rem 1rem;
  color: var(--provider-color, var(--color-primary));
  background-color: var(--provider-bg, var(--color-background));
  border: 1px solid #00000031;
  font-size: 0.9rem;
  height: 50px;
  border-radius: var(--border-radius);
  transition: background-color 250ms ease-in-out;
  font-weight: 300;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

:is(button,a.button):hover {
    background-color: var(--provider-bg-hover, var(--color-background-hover));
    cursor: pointer;
  }

:is(button,a.button):active {
    cursor: pointer;
  }

:is(button,a.button) span {
    color: #fff;
  }

#submitButton {
  color: var(--button-text-color, var(--color-info-text));
  background-color: var(--brand-color, var(--color-info));
  width: 100%;
}

#submitButton:hover {
    background-color: var(
      --button-hover-bg,
      var(--color-info-hover)
    ) !important;
  }

a.site {
  color: var(--color-primary);
  text-decoration: none;
  font-size: 1rem;
  line-height: 2rem;
}

a.site:hover {
    text-decoration: underline;
  }

.page {
  position: absolute;
  width: 100%;
  height: 100%;
  display: grid;
  place-items: center;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.page > div {
    text-align: center;
  }

.error a.button {
    padding-left: 2rem;
    padding-right: 2rem;
    margin-top: 0.5rem;
  }

.error .message {
    margin-bottom: 1.5rem;
  }

.signin input[type="text"] {
    margin-left: auto;
    margin-right: auto;
    display: block;
  }

.signin hr {
    display: block;
    border: 0;
    border-top: 1px solid var(--color-separator);
    margin: 2rem auto 1rem auto;
    overflow: visible;
  }

.signin hr::before {
      content: "or";
      background: var(--color-background-card);
      color: #888;
      padding: 0 0.4rem;
      position: relative;
      top: -0.7rem;
    }

.signin .error {
    background: #f5f5f5;
    font-weight: 500;
    border-radius: 0.3rem;
    background: var(--color-error);
  }

.signin .error p {
      text-align: left;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      line-height: 1.2rem;
      color: var(--color-info-text);
    }

.signin > div,
  .signin form {
    display: block;
  }

.signin > div input[type], .signin form input[type] {
      margin-bottom: 0.5rem;
    }

.signin > div button, .signin form button {
      width: 100%;
    }

.signin .provider + .provider {
    margin-top: 1rem;
  }

.logo {
  display: inline-block;
  max-width: 150px;
  margin: 1.25rem 0;
  max-height: 70px;
}

.card {
  background-color: var(--color-background-card);
  border-radius: 1rem;
  padding: 1.25rem 2rem;
}

.card .header {
    color: var(--color-primary);
  }

.card input[type]::-moz-placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type]::placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type] {
    background: color-mix(in srgb, var(--color-background-card) 95%, black);
  }

.section-header {
  color: var(--color-text);
}

@media screen and (min-width: 450px) {
  .card {
    margin: 2rem 0;
    width: 368px;
  }
}

@media screen and (max-width: 450px) {
  .card {
    margin: 1rem 0;
    width: 343px;
  }
}
`;function ia({html:e,title:t,status:r,cookies:i,theme:n,headTags:s}){return{cookies:i,status:r,headers:{"Content-Type":"text/html"},body:`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>${io}</style><title>${t}</title>${s??""}</head><body class="__next-auth-theme-${n?.colorScheme??"auto"}"><div class="page">${r7(e)}</div></body></html>`}}function il(e){let{url:t,theme:r,query:i,cookies:n,pages:s,providers:o}=e;return{csrf:(e,t,r)=>e?(t.logger.warn("csrf-disabled"),r.push({name:t.cookies.csrfToken.name,value:"",options:{...t.cookies.csrfToken.options,maxAge:0}}),{status:404,cookies:r}):{headers:{"Content-Type":"application/json"},body:{csrfToken:t.csrfToken},cookies:r},providers:e=>({headers:{"Content-Type":"application/json"},body:e.reduce((e,{id:t,name:r,type:i,signinUrl:n,callbackUrl:s})=>(e[t]={id:t,name:r,type:i,signinUrl:n,callbackUrl:s},e),{})}),signin(t,a){if(t)throw new N("Unsupported action");if(s?.signIn){let t=`${s.signIn}${s.signIn.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:e.callbackUrl??"/"})}`;return a&&(t=`${t}&${new URLSearchParams({error:a})}`),{redirect:t,cookies:n}}let l=o?.find(e=>"webauthn"===e.type&&e.enableConditionalUI&&!!e.simpleWebAuthnBrowserVersion),c="";if(l){let{simpleWebAuthnBrowserVersion:e}=l;c=`<script src="https://unpkg.com/@simplewebauthn/browser@${e}/dist/bundle/index.umd.min.js" crossorigin="anonymous"></script>`}return ia({cookies:n,theme:r,html:function(e){let{csrfToken:t,providers:r=[],callbackUrl:i,theme:n,email:s,error:o}=e;"undefined"!=typeof document&&n?.brandColor&&document.documentElement.style.setProperty("--brand-color",n.brandColor),"undefined"!=typeof document&&n?.buttonText&&document.documentElement.style.setProperty("--button-text-color",n.buttonText);let a=o&&(is[o]??is.default),l=r.find(e=>"webauthn"===e.type&&e.enableConditionalUI)?.id;return ir("div",{className:"signin",children:[n?.brandColor&&ir("style",{dangerouslySetInnerHTML:{__html:`:root {--brand-color: ${n.brandColor}}`}}),n?.buttonText&&ir("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${n.buttonText}
        }
      `}}),ir("div",{className:"card",children:[a&&ir("div",{className:"error",children:ir("p",{children:a})}),n?.logo&&ir("img",{src:n.logo,alt:"Logo",className:"logo"}),r.map((e,n)=>{let o,a,l;("oauth"===e.type||"oidc"===e.type)&&({bg:o="#fff",brandColor:a,logo:l=`https://authjs.dev/img/providers/${e.id}.svg`}=e.style??{});let c=a??o??"#fff";return ir("div",{className:"provider",children:["oauth"===e.type||"oidc"===e.type?ir("form",{action:e.signinUrl,method:"POST",children:[ir("input",{type:"hidden",name:"csrfToken",value:t}),i&&ir("input",{type:"hidden",name:"callbackUrl",value:i}),ir("button",{type:"submit",className:"button",style:{"--provider-bg":"#fff","--provider-bg-hover":`color-mix(in srgb, ${c} 30%, #fff)`,"--provider-dark-bg":"#161b22","--provider-dark-bg-hover":`color-mix(in srgb, ${c} 30%, #000)`},tabIndex:0,children:[ir("span",{style:{filter:"invert(1) grayscale(1) brightness(1.3) contrast(9000)","mix-blend-mode":"luminosity",opacity:.95},children:["Sign in with ",e.name]}),l&&ir("img",{loading:"lazy",height:24,src:l})]})]}):null,("email"===e.type||"credentials"===e.type||"webauthn"===e.type)&&n>0&&"email"!==r[n-1].type&&"credentials"!==r[n-1].type&&"webauthn"!==r[n-1].type&&ir("hr",{}),"email"===e.type&&ir("form",{action:e.signinUrl,method:"POST",children:[ir("input",{type:"hidden",name:"csrfToken",value:t}),ir("label",{className:"section-header",htmlFor:`input-email-for-${e.id}-provider`,children:"Email"}),ir("input",{id:`input-email-for-${e.id}-provider`,autoFocus:!0,type:"email",name:"email",value:s,placeholder:"email@example.com",required:!0}),ir("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),"credentials"===e.type&&ir("form",{action:e.callbackUrl,method:"POST",children:[ir("input",{type:"hidden",name:"csrfToken",value:t}),Object.keys(e.credentials).map(t=>ir("div",{children:[ir("label",{className:"section-header",htmlFor:`input-${t}-for-${e.id}-provider`,children:e.credentials[t].label??t}),ir("input",{name:t,id:`input-${t}-for-${e.id}-provider`,type:e.credentials[t].type??"text",placeholder:e.credentials[t].placeholder??"",...e.credentials[t]})]},`input-group-${e.id}`)),ir("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),"webauthn"===e.type&&ir("form",{action:e.callbackUrl,method:"POST",id:`${e.id}-form`,children:[ir("input",{type:"hidden",name:"csrfToken",value:t}),Object.keys(e.formFields).map(t=>ir("div",{children:[ir("label",{className:"section-header",htmlFor:`input-${t}-for-${e.id}-provider`,children:e.formFields[t].label??t}),ir("input",{name:t,"data-form-field":!0,id:`input-${t}-for-${e.id}-provider`,type:e.formFields[t].type??"text",placeholder:e.formFields[t].placeholder??"",...e.formFields[t]})]},`input-group-${e.id}`)),ir("button",{id:`submitButton-${e.id}`,type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),("email"===e.type||"credentials"===e.type||"webauthn"===e.type)&&n+1<r.length&&ir("hr",{})]},e.id)})]}),l&&ir(rP,{children:ir("script",{dangerouslySetInnerHTML:{__html:`
const currentURL = window.location.href;
const authURL = currentURL.substring(0, currentURL.lastIndexOf('/'));
(${ii})(authURL, "${l}");
`}})})]})}({csrfToken:e.csrfToken,providers:e.providers?.filter(e=>["email","oauth","oidc"].includes(e.type)||"credentials"===e.type&&e.credentials||"webauthn"===e.type&&e.formFields||!1),callbackUrl:e.callbackUrl,theme:e.theme,error:a,...i}),title:"Sign In",headTags:c})},signout:()=>s?.signOut?{redirect:s.signOut,cookies:n}:ia({cookies:n,theme:r,html:function(e){let{url:t,csrfToken:r,theme:i}=e;return ir("div",{className:"signout",children:[i?.brandColor&&ir("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${i.brandColor}
        }
      `}}),i?.buttonText&&ir("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${i.buttonText}
        }
      `}}),ir("div",{className:"card",children:[i?.logo&&ir("img",{src:i.logo,alt:"Logo",className:"logo"}),ir("h1",{children:"Signout"}),ir("p",{children:"Are you sure you want to sign out?"}),ir("form",{action:t?.toString(),method:"POST",children:[ir("input",{type:"hidden",name:"csrfToken",value:r}),ir("button",{id:"submitButton",type:"submit",children:"Sign out"})]})]})]})}({csrfToken:e.csrfToken,url:t,theme:r}),title:"Sign Out"}),verifyRequest:e=>s?.verifyRequest?{redirect:s.verifyRequest,cookies:n}:ia({cookies:n,theme:r,html:function(e){let{url:t,theme:r}=e;return ir("div",{className:"verify-request",children:[r.brandColor&&ir("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${r.brandColor}
        }
      `}}),ir("div",{className:"card",children:[r.logo&&ir("img",{src:r.logo,alt:"Logo",className:"logo"}),ir("h1",{children:"Check your email"}),ir("p",{children:"A sign in link has been sent to your email address."}),ir("p",{children:ir("a",{className:"site",href:t.origin,children:t.host})})]})]})}({url:t,theme:r,...e}),title:"Verify Request"}),error:e=>s?.error?{redirect:`${s.error}${s.error.includes("?")?"&":"?"}error=${e}`,cookies:n}:ia({cookies:n,theme:r,...function(e){let{url:t,error:r="default",theme:i}=e,n=`${t}/signin`,s={default:{status:200,heading:"Error",message:ir("p",{children:ir("a",{className:"site",href:t?.origin,children:t?.host})})},Configuration:{status:500,heading:"Server error",message:ir("div",{children:[ir("p",{children:"There is a problem with the server configuration."}),ir("p",{children:"Check the server logs for more information."})]})},AccessDenied:{status:403,heading:"Access Denied",message:ir("div",{children:[ir("p",{children:"You do not have permission to sign in."}),ir("p",{children:ir("a",{className:"button",href:n,children:"Sign in"})})]})},Verification:{status:403,heading:"Unable to sign in",message:ir("div",{children:[ir("p",{children:"The sign in link is no longer valid."}),ir("p",{children:"It may have been used already or it may have expired."})]}),signin:ir("a",{className:"button",href:n,children:"Sign in"})}},{status:o,heading:a,message:l,signin:c}=s[r]??s.default;return{status:o,html:ir("div",{className:"error",children:[i?.brandColor&&ir("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${i?.brandColor}
        }
      `}}),ir("div",{className:"card",children:[i?.logo&&ir("img",{src:i?.logo,alt:"Logo",className:"logo"}),ir("h1",{children:a}),ir("div",{className:"message",children:l}),c]})]})}}({url:t,theme:r,error:e}),title:"Error"})}}function ic(e,t=Date.now()){return new Date(t+1e3*e)}async function iu(e,t,r,i){if(!r?.providerAccountId||!r.type)throw Error("Missing or invalid provider account");if(!["email","oauth","oidc","webauthn"].includes(r.type))throw Error("Provider not supported");let{adapter:n,jwt:s,events:o,session:{strategy:a,generateSessionToken:l}}=i;if(!n)return{user:t,account:r};let c=r,{createUser:u,updateUser:d,getUser:p,getUserByAccount:f,getUserByEmail:h,linkAccount:m,createSession:y,getSessionAndUser:g,deleteSession:w}=n,b=null,v=null,_=!1,S="jwt"===a;if(e){if(S)try{let t=i.cookies.sessionToken.name;(b=await s.decode({...s,token:e,salt:t}))&&"sub"in b&&b.sub&&(v=await p(b.sub))}catch{}else{let t=await g(e);t&&(b=t.session,v=t.user)}}if("email"===c.type){let r=await h(t.email);return r?(v?.id!==r.id&&!S&&e&&await w(e),v=await d({id:r.id,emailVerified:new Date}),await o.updateUser?.({user:v})):(v=await u({...t,emailVerified:new Date}),await o.createUser?.({user:v}),_=!0),{session:b=S?{}:await y({sessionToken:l(),userId:v.id,expires:ic(i.session.maxAge)}),user:v,isNewUser:_}}if("webauthn"===c.type){let e=await f({providerAccountId:c.providerAccountId,provider:c.provider});if(e){if(v){if(e.id===v.id){let e={...c,userId:v.id};return{session:b,user:v,isNewUser:_,account:e}}throw new K("The account is already associated with another user",{provider:c.provider})}b=S?{}:await y({sessionToken:l(),userId:e.id,expires:ic(i.session.maxAge)});let t={...c,userId:e.id};return{session:b,user:e,isNewUser:_,account:t}}{if(v){await m({...c,userId:v.id}),await o.linkAccount?.({user:v,account:c,profile:t});let e={...c,userId:v.id};return{session:b,user:v,isNewUser:_,account:e}}if(t.email?await h(t.email):null)throw new K("Another account already exists with the same e-mail address",{provider:c.provider});v=await u({...t}),await o.createUser?.({user:v}),await m({...c,userId:v.id}),await o.linkAccount?.({user:v,account:c,profile:t}),b=S?{}:await y({sessionToken:l(),userId:v.id,expires:ic(i.session.maxAge)});let e={...c,userId:v.id};return{session:b,user:v,isNewUser:!0,account:e}}}let k=await f({providerAccountId:c.providerAccountId,provider:c.provider});if(k){if(v){if(k.id===v.id)return{session:b,user:v,isNewUser:_};throw new P("The account is already associated with another user",{provider:c.provider})}return{session:b=S?{}:await y({sessionToken:l(),userId:k.id,expires:ic(i.session.maxAge)}),user:k,isNewUser:_}}{let{provider:e}=i,{type:r,provider:n,providerAccountId:s,userId:a,...d}=c;if(c=Object.assign(e.account(d)??{},{providerAccountId:s,provider:n,type:r,userId:a}),v)return await m({...c,userId:v.id}),await o.linkAccount?.({user:v,account:c,profile:t}),{session:b,user:v,isNewUser:_};let p=t.email?await h(t.email):null;if(p){let e=i.provider;if(e?.allowDangerousEmailAccountLinking)v=p;else throw new P("Another account already exists with the same e-mail address",{provider:c.provider})}else v=await u({...t,emailVerified:null});return await o.createUser?.({user:v}),await m({...c,userId:v.id}),await o.linkAccount?.({user:v,account:c,profile:t}),{session:b=S?{}:await y({sessionToken:l(),userId:v.id,expires:ic(i.session.maxAge)}),user:v,isNewUser:!0}}}function id(e,t){if(null==e)return!1;try{return e instanceof t||Object.getPrototypeOf(e)[Symbol.toStringTag]===t.prototype[Symbol.toStringTag]}catch{return!1}}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(s="oauth4webapi/v2.17.0");let ip=Symbol(),ih=Symbol(),im=Symbol(),iy=Symbol(),ig=Symbol(),iw=Symbol(),ib=Symbol(),iv=new TextEncoder,i_=new TextDecoder;function iS(e){return"string"==typeof e?iv.encode(e):i_.decode(e)}function ik(e){return"string"==typeof e?function(e){try{let t=atob(e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}catch(e){throw new iT("The input to be decoded is not correctly encoded.",{cause:e})}}(e):function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));let t=[];for(let r=0;r<e.byteLength;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return btoa(t.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(e)}class iA{constructor(e){this.cache=new Map,this._cache=new Map,this.maxSize=e}get(e){let t=this.cache.get(e);return t||((t=this._cache.get(e))?(this.update(e,t),t):void 0)}has(e){return this.cache.has(e)||this._cache.has(e)}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this.update(e,t),this}delete(e){return this.cache.has(e)?this.cache.delete(e):!!this._cache.has(e)&&this._cache.delete(e)}update(e,t){this.cache.set(e,t),this.cache.size>=this.maxSize&&(this._cache=this.cache,this.cache=new Map)}}class ix extends Error{constructor(e){super(e??"operation not supported"),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class iE extends Error{constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}let iT=iE,iP=new iA(100);function iC(e){return e instanceof CryptoKey}function i$(e){return iC(e)&&"private"===e.type}function iO(e){try{let t=e.headers.get("dpop-nonce");t&&iP.set(new URL(e.url).origin,t)}catch{}return e}function ij(e){return!(null===e||"object"!=typeof e||Array.isArray(e))}function iR(e){id(e,Headers)&&(e=Object.fromEntries(e.entries()));let t=new Headers(e);if(s&&!t.has("user-agent")&&t.set("user-agent",s),t.has("authorization"))throw TypeError('"options.headers" must not include the "authorization" header name');if(t.has("dpop"))throw TypeError('"options.headers" must not include the "dpop" header name');return t}function iU(e){if("function"==typeof e&&(e=e()),!(e instanceof AbortSignal))throw TypeError('"options.signal" must return or be an instance of AbortSignal');return e}async function iN(e,t){if(!(e instanceof URL))throw TypeError('"issuerIdentifier" must be an instance of URL');if("https:"!==e.protocol&&"http:"!==e.protocol)throw TypeError('"issuer.protocol" must be "https:" or "http:"');let r=new URL(e.href);switch(t?.algorithm){case void 0:case"oidc":r.pathname=`${r.pathname}/.well-known/openid-configuration`.replace("//","/");break;case"oauth2":"/"===r.pathname?r.pathname=".well-known/oauth-authorization-server":r.pathname=`.well-known/oauth-authorization-server/${r.pathname}`.replace("//","/");break;default:throw TypeError('"options.algorithm" must be "oidc" (default), or "oauth2"')}let i=iR(t?.headers);return i.set("accept","application/json"),(t?.[im]||fetch)(r.href,{headers:Object.fromEntries(i.entries()),method:"GET",redirect:"manual",signal:t?.signal?iU(t.signal):null}).then(iO)}function iI(e){return"string"==typeof e&&0!==e.length}async function iD(e,t){let r;if(!(e instanceof URL))throw TypeError('"expectedIssuer" must be an instance of URL');if(!id(t,Response))throw TypeError('"response" must be an instance of Response');if(200!==t.status)throw new iT('"response" is not a conform Authorization Server Metadata response');nS(t);try{r=await t.json()}catch(e){throw new iT('failed to parse "response" body as JSON',{cause:e})}if(!ij(r))throw new iT('"response" body must be a top level object');if(!iI(r.issuer))throw new iT('"response" body "issuer" property must be a non-empty string');if(new URL(r.issuer).href!==e.href)throw new iT('"response" body "issuer" does not match "expectedIssuer"');return r}function iL(){return ik(crypto.getRandomValues(new Uint8Array(32)))}async function iQ(e){if(!iI(e))throw TypeError('"codeVerifier" must be a non-empty string');return ik(await crypto.subtle.digest("SHA-256",iS(e)))}function iB(e){return encodeURIComponent(e).replace(/%20/g,"+")}function iq(e){switch(e.algorithm.name){case"RSA-PSS":return function(e){switch(e.algorithm.hash.name){case"SHA-256":return"PS256";case"SHA-384":return"PS384";case"SHA-512":return"PS512";default:throw new ix("unsupported RsaHashedKeyAlgorithm hash name")}}(e);case"RSASSA-PKCS1-v1_5":return function(e){switch(e.algorithm.hash.name){case"SHA-256":return"RS256";case"SHA-384":return"RS384";case"SHA-512":return"RS512";default:throw new ix("unsupported RsaHashedKeyAlgorithm hash name")}}(e);case"ECDSA":return function(e){switch(e.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512";default:throw new ix("unsupported EcKeyAlgorithm namedCurve")}}(e);case"Ed25519":case"Ed448":return"EdDSA";default:throw new ix("unsupported CryptoKey algorithm name")}}function iM(e){let t=e?.[ip];return"number"==typeof t&&Number.isFinite(t)?t:0}function iz(e){let t=e?.[ih];return"number"==typeof t&&Number.isFinite(t)&&-1!==Math.sign(t)?t:30}function iH(){return Math.floor(Date.now()/1e3)}async function iK(e,t,r,i,n){let s={alg:iq(r),kid:i},o=function(e,t){let r=iH()+iM(t);return{jti:iL(),aud:[e.issuer,e.token_endpoint],exp:r+60,iat:r,nbf:r,iss:t.client_id,sub:t.client_id}}(e,t);return n?.(s,o),iX(s,o,r)}function iW(e){if("object"!=typeof e||null===e)throw TypeError('"as" must be an object');if(!iI(e.issuer))throw TypeError('"as.issuer" property must be a non-empty string');return!0}function iF(e){if("object"!=typeof e||null===e)throw TypeError('"client" must be an object');if(!iI(e.client_id))throw TypeError('"client.client_id" property must be a non-empty string');return!0}function iJ(e){if(!iI(e))throw TypeError('"client.client_secret" property must be a non-empty string');return e}function iV(e,t){if(void 0!==t)throw TypeError(`"options.clientPrivateKey" property must not be provided when ${e} client authentication method is used.`)}function iG(e,t){if(void 0!==t)throw TypeError(`"client.client_secret" property must not be provided when ${e} client authentication method is used.`)}async function iZ(e,t,r,i,n){switch(r.delete("client_secret"),r.delete("client_assertion_type"),r.delete("client_assertion"),t.token_endpoint_auth_method){case void 0:case"client_secret_basic":iV("client_secret_basic",n),i.set("authorization",function(e,t){let r=iB(e),i=iB(t),n=btoa(`${r}:${i}`);return`Basic ${n}`}(t.client_id,iJ(t.client_secret)));break;case"client_secret_post":iV("client_secret_post",n),r.set("client_id",t.client_id),r.set("client_secret",iJ(t.client_secret));break;case"private_key_jwt":{if(iG("private_key_jwt",t.client_secret),void 0===n)throw TypeError('"options.clientPrivateKey" must be provided when "client.token_endpoint_auth_method" is "private_key_jwt"');let{key:i,kid:s,modifyAssertion:o}=function(e){if(e instanceof CryptoKey)return{key:e};if(!(e?.key instanceof CryptoKey))return{};if(void 0!==e.kid&&!iI(e.kid))throw TypeError('"kid" must be a non-empty string');return{key:e.key,kid:e.kid,modifyAssertion:e[iy]}}(n);if(!i$(i))throw TypeError('"options.clientPrivateKey.key" must be a private CryptoKey');r.set("client_id",t.client_id),r.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),r.set("client_assertion",await iK(e,t,i,s,o));break}case"tls_client_auth":case"self_signed_tls_client_auth":case"none":iG(t.token_endpoint_auth_method,t.client_secret),iV(t.token_endpoint_auth_method,n),r.set("client_id",t.client_id);break;default:throw new ix("unsupported client token_endpoint_auth_method")}}async function iX(e,t,r){if(!r.usages.includes("sign"))throw TypeError('CryptoKey instances used for signing assertions must include "sign" in their "usages"');let i=`${ik(iS(JSON.stringify(e)))}.${ik(iS(JSON.stringify(t)))}`,n=ik(await crypto.subtle.sign(nT(r),r,iS(i)));return`${i}.${n}`}async function iY(e,t,r,i,n,s){let{privateKey:o,publicKey:a,nonce:l=iP.get(r.origin)}=t;if(!i$(o))throw TypeError('"DPoP.privateKey" must be a private CryptoKey');if(!(iC(a)&&"public"===a.type))throw TypeError('"DPoP.publicKey" must be a public CryptoKey');if(void 0!==l&&!iI(l))throw TypeError('"DPoP.nonce" must be a non-empty string or undefined');if(!a.extractable)throw TypeError('"DPoP.publicKey.extractable" must be true');let c=iH()+n,u={alg:iq(o),typ:"dpop+jwt",jwk:await i1(a)},d={iat:c,jti:iL(),htm:i,nonce:l,htu:`${r.origin}${r.pathname}`,ath:s?ik(await crypto.subtle.digest("SHA-256",iS(s))):void 0};t[iy]?.(u,d),e.set("dpop",await iX(u,d,o))}async function i0(e){let{kty:t,e:r,n:i,x:n,y:s,crv:a}=await crypto.subtle.exportKey("jwk",e),l={kty:t,e:r,n:i,x:n,y:s,crv:a};return o.set(e,l),l}async function i1(e){return o||(o=new WeakMap),o.get(e)||i0(e)}function i2(e,t,r){if("string"!=typeof e){if(r)throw TypeError(`"as.mtls_endpoint_aliases.${t}" must be a string`);throw TypeError(`"as.${t}" must be a string`)}return new URL(e)}function i3(e,t,r=!1){return r&&e.mtls_endpoint_aliases&&t in e.mtls_endpoint_aliases?i2(e.mtls_endpoint_aliases[t],t,r):i2(e[t],t,r)}function i6(e,t){return!!(e.use_mtls_endpoint_aliases||t?.[ib])}function i5(e){return!("object"!=typeof e||Array.isArray(e))&&null!==e&&void 0!==e.error}let i4=/((?:,|, )?[0-9a-zA-Z!#$%&'*+-.^_`|~]+=)/,i8=/(?:^|, ?)([0-9a-zA-Z!#$%&'*+\-.^_`|~]+)(?=$|[ ,])/g;async function i7(e,t,r,i,n,s){if(!iI(e))throw TypeError('"accessToken" must be a non-empty string');if(!(r instanceof URL))throw TypeError('"url" must be an instance of URL');return i=iR(i),s?.DPoP===void 0?i.set("authorization",`Bearer ${e}`):(await iY(i,s.DPoP,r,t.toUpperCase(),iM({[ip]:s?.[ip]}),e),i.set("authorization",`DPoP ${e}`)),(s?.[im]||fetch)(r.href,{body:n,headers:Object.fromEntries(i.entries()),method:t,redirect:"manual",signal:s?.signal?iU(s.signal):null}).then(iO)}async function i9(e,t,r,i){iW(e),iF(t);let n=i3(e,"userinfo_endpoint",i6(t,i)),s=iR(i?.headers);return t.userinfo_signed_response_alg?s.set("accept","application/jwt"):(s.set("accept","application/json"),s.append("accept","application/jwt")),i7(r,"GET",n,s,null,{...i,[ip]:iM(t)})}function ne(e,t,r,i){a||(a=new WeakMap),a.set(e,{jwks:t,uat:r,get age(){return iH()-this.uat}}),i&&Object.assign(i,{jwks:structuredClone(t),uat:r})}function nt(e,t){a?.delete(e),delete t?.jwks,delete t?.uat}let nr=Symbol();async function ni(e,t,r,i){let n;if(iW(e),iF(t),!id(i,Response))throw TypeError('"response" must be an instance of Response');if(200!==i.status)throw new iT('"response" is not a conform UserInfo Endpoint response');if("application/jwt"===i.headers.get("content-type")?.split(";")[0]){nS(i);let{claims:r,jwt:s}=await n$(await i.text(),nO.bind(void 0,t.userinfo_signed_response_alg,e.userinfo_signing_alg_values_supported),nP,iM(t),iz(t),t[ig]).then(nu.bind(void 0,t.client_id)).then(np.bind(void 0,e.issuer));na.set(i,s),n=r}else{if(t.userinfo_signed_response_alg)throw new iT("JWT UserInfo Response expected");nS(i);try{n=await i.json()}catch(e){throw new iT('failed to parse "response" body as JSON',{cause:e})}}if(!ij(n))throw new iT('"response" body must be a top level object');if(!iI(n.sub))throw new iT('"response" body "sub" property must be a non-empty string');if(r===nr);else{if(!iI(r))throw new iT('"expectedSubject" must be a non-empty string');if(n.sub!==r)throw new iT('unexpected "response" body "sub" value')}return n}async function nn(e,t,r,i,n,s,o){return await iZ(e,t,n,s,o?.clientPrivateKey),s.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),(o?.[im]||fetch)(i.href,{body:n,headers:Object.fromEntries(s.entries()),method:r,redirect:"manual",signal:o?.signal?iU(o.signal):null}).then(iO)}async function ns(e,t,r,i,n){let s=i3(e,"token_endpoint",i6(t,n));i.set("grant_type",r);let o=iR(n?.headers);return o.set("accept","application/json"),n?.DPoP!==void 0&&await iY(o,n.DPoP,s,"POST",iM(t)),nn(e,t,"POST",s,i,o,n)}let no=new WeakMap,na=new WeakMap;function nl(e){if(!e.id_token)return;let t=no.get(e);if(!t)throw TypeError('"ref" was already garbage collected or did not resolve from the proper sources');return t[0]}async function nc(e,t,r,i=!1,n=!1){let s;if(iW(e),iF(t),!id(r,Response))throw TypeError('"response" must be an instance of Response');if(200!==r.status){let e;if(e=await nx(r))return e;throw new iT('"response" is not a conform Token Endpoint response')}nS(r);try{s=await r.json()}catch(e){throw new iT('failed to parse "response" body as JSON',{cause:e})}if(!ij(s))throw new iT('"response" body must be a top level object');if(!iI(s.access_token))throw new iT('"response" body "access_token" property must be a non-empty string');if(!iI(s.token_type))throw new iT('"response" body "token_type" property must be a non-empty string');if(s.token_type=s.token_type.toLowerCase(),"dpop"!==s.token_type&&"bearer"!==s.token_type)throw new ix("unsupported `token_type` value");if(void 0!==s.expires_in&&("number"!=typeof s.expires_in||s.expires_in<=0))throw new iT('"response" body "expires_in" property must be a positive number');if(!n&&void 0!==s.refresh_token&&!iI(s.refresh_token))throw new iT('"response" body "refresh_token" property must be a non-empty string');if(void 0!==s.scope&&"string"!=typeof s.scope)throw new iT('"response" body "scope" property must be a string');if(!i){if(void 0!==s.id_token&&!iI(s.id_token))throw new iT('"response" body "id_token" property must be a non-empty string');if(s.id_token){let{claims:r,jwt:i}=await n$(s.id_token,nO.bind(void 0,t.id_token_signed_response_alg,e.id_token_signing_alg_values_supported),nP,iM(t),iz(t),t[ig]).then(ng.bind(void 0,["aud","exp","iat","iss","sub"])).then(nf.bind(void 0,e.issuer)).then(nd.bind(void 0,t.client_id));if(Array.isArray(r.aud)&&1!==r.aud.length){if(void 0===r.azp)throw new iT('ID Token "aud" (audience) claim includes additional untrusted audiences');if(r.azp!==t.client_id)throw new iT('unexpected ID Token "azp" (authorized party) claim value')}if(void 0!==r.auth_time&&(!Number.isFinite(r.auth_time)||1!==Math.sign(r.auth_time)))throw new iT('ID Token "auth_time" (authentication time) must be a positive number');no.set(s,[r,i])}}return s}function nu(e,t){return void 0!==t.claims.aud?nd(e,t):t}function nd(e,t){if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e))throw new iT('unexpected JWT "aud" (audience) claim value')}else if(t.claims.aud!==e)throw new iT('unexpected JWT "aud" (audience) claim value');return t}function np(e,t){return void 0!==t.claims.iss?nf(e,t):t}function nf(e,t){if(t.claims.iss!==e)throw new iT('unexpected JWT "iss" (issuer) claim value');return t}let nh=new WeakSet;async function nm(e,t,r,i,n,s){if(iW(e),iF(t),!nh.has(r))throw TypeError('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()');if(!iI(i))throw TypeError('"redirectUri" must be a non-empty string');if(!iI(n))throw TypeError('"codeVerifier" must be a non-empty string');let o=nj(r,"code");if(!o)throw new iT('no authorization code in "callbackParameters"');let a=new URLSearchParams(s?.additionalParameters);return a.set("redirect_uri",i),a.set("code_verifier",n),a.set("code",o),ns(e,t,"authorization_code",a,s)}let ny={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation"};function ng(e,t){for(let r of e)if(void 0===t.claims[r])throw new iT(`JWT "${r}" (${ny[r]}) claim missing`);return t}let nw=Symbol(),nb=Symbol();async function nv(e,t,r,i,n){let s=await nc(e,t,r);if(i5(s))return s;if(!iI(s.id_token))throw new iT('"response" body "id_token" property must be a non-empty string');n??(n=t.default_max_age??nb);let o=nl(s);if((t.require_auth_time||n!==nb)&&void 0===o.auth_time)throw new iT('ID Token "auth_time" (authentication time) claim missing');if(n!==nb){if("number"!=typeof n||n<0)throw TypeError('"maxAge" must be a non-negative number');let e=iH()+iM(t),r=iz(t);if(o.auth_time+n<e-r)throw new iT("too much time has elapsed since the last End-User authentication")}switch(i){case void 0:case nw:if(void 0!==o.nonce)throw new iT('unexpected ID Token "nonce" claim value');break;default:if(!iI(i))throw TypeError('"expectedNonce" must be a non-empty string');if(void 0===o.nonce)throw new iT('ID Token "nonce" claim missing');if(o.nonce!==i)throw new iT('unexpected ID Token "nonce" claim value')}return s}async function n_(e,t,r){let i=await nc(e,t,r,!0);if(i5(i))return i;if(void 0!==i.id_token){if("string"==typeof i.id_token&&i.id_token.length)throw new iT("Unexpected ID Token returned, use processAuthorizationCodeOpenIDResponse() for OpenID Connect callback processing");delete i.id_token}return i}function nS(e){if(e.bodyUsed)throw TypeError('"response" body has been used already')}async function nk(e,t){iW(e);let r=i3(e,"jwks_uri"),i=iR(t?.headers);return i.set("accept","application/json"),i.append("accept","application/jwk-set+json"),(t?.[im]||fetch)(r.href,{headers:Object.fromEntries(i.entries()),method:"GET",redirect:"manual",signal:t?.signal?iU(t.signal):null}).then(iO)}async function nA(e){let t;if(!id(e,Response))throw TypeError('"response" must be an instance of Response');if(200!==e.status)throw new iT('"response" is not a conform JSON Web Key Set response');nS(e);try{t=await e.json()}catch(e){throw new iT('failed to parse "response" body as JSON',{cause:e})}if(!ij(t))throw new iT('"response" body must be a top level object');if(!Array.isArray(t.keys))throw new iT('"response" body "keys" property must be an array');if(!Array.prototype.every.call(t.keys,ij))throw new iT('"response" body "keys" property members must be JWK formatted objects');return t}async function nx(e){if(e.status>399&&e.status<500){nS(e);try{let t=await e.json();if(ij(t)&&"string"==typeof t.error&&t.error.length)return void 0!==t.error_description&&"string"!=typeof t.error_description&&delete t.error_description,void 0!==t.error_uri&&"string"!=typeof t.error_uri&&delete t.error_uri,void 0!==t.algs&&"string"!=typeof t.algs&&delete t.algs,void 0!==t.scope&&"string"!=typeof t.scope&&delete t.scope,t}catch{}}}function nE(e){if("number"!=typeof e.modulusLength||e.modulusLength<2048)throw new iT(`${e.name} modulusLength must be at least 2048 bits`)}function nT(e){switch(e.algorithm.name){case"ECDSA":return{name:e.algorithm.name,hash:function(e){switch(e){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new ix}}(e.algorithm.namedCurve)};case"RSA-PSS":switch(nE(e.algorithm),e.algorithm.hash.name){case"SHA-256":case"SHA-384":case"SHA-512":return{name:e.algorithm.name,saltLength:parseInt(e.algorithm.hash.name.slice(-3),10)>>3};default:throw new ix}case"RSASSA-PKCS1-v1_5":return nE(e.algorithm),e.algorithm.name;case"Ed448":case"Ed25519":return e.algorithm.name}throw new ix}let nP=Symbol();async function nC(e,t,r,i){let n=`${e}.${t}`;if(!await crypto.subtle.verify(nT(r),r,i,iS(n)))throw new iT("JWT signature verification failed")}async function n$(e,t,r,i,n,s){let o,a,l,{0:c,1:u,2:d,length:p}=e.split(".");if(5===p){if(void 0!==s)e=await s(e),{0:c,1:u,2:d,length:p}=e.split(".");else throw new ix("JWE structure JWTs are not supported")}if(3!==p)throw new iT("Invalid JWT");try{o=JSON.parse(iS(ik(c)))}catch(e){throw new iT("failed to parse JWT Header body as base64url encoded JSON",{cause:e})}if(!ij(o))throw new iT("JWT Header must be a top level object");if(t(o),void 0!==o.crit)throw new iT('unexpected JWT "crit" header parameter');let f=ik(d);r!==nP&&(a=await r(o),await nC(c,u,a,f));try{l=JSON.parse(iS(ik(u)))}catch(e){throw new iT("failed to parse JWT Payload body as base64url encoded JSON",{cause:e})}if(!ij(l))throw new iT("JWT Payload must be a top level object");let h=iH()+i;if(void 0!==l.exp){if("number"!=typeof l.exp)throw new iT('unexpected JWT "exp" (expiration time) claim type');if(l.exp<=h-n)throw new iT('unexpected JWT "exp" (expiration time) claim value, timestamp is <= now()')}if(void 0!==l.iat&&"number"!=typeof l.iat)throw new iT('unexpected JWT "iat" (issued at) claim type');if(void 0!==l.iss&&"string"!=typeof l.iss)throw new iT('unexpected JWT "iss" (issuer) claim type');if(void 0!==l.nbf){if("number"!=typeof l.nbf)throw new iT('unexpected JWT "nbf" (not before) claim type');if(l.nbf>h+n)throw new iT('unexpected JWT "nbf" (not before) claim value, timestamp is > now()')}if(void 0!==l.aud&&"string"!=typeof l.aud&&!Array.isArray(l.aud))throw new iT('unexpected JWT "aud" (audience) claim type');return{header:o,claims:l,signature:f,key:a,jwt:e}}function nO(e,t,r){if(void 0!==e){if(r.alg!==e)throw new iT('unexpected JWT "alg" header parameter');return}if(Array.isArray(t)){if(!t.includes(r.alg))throw new iT('unexpected JWT "alg" header parameter');return}if("RS256"!==r.alg)throw new iT('unexpected JWT "alg" header parameter')}function nj(e,t){let{0:r,length:i}=e.getAll(t);if(i>1)throw new iT(`"${t}" parameter must be provided only once`);return r}let nR=Symbol(),nU=Symbol();async function nN(e,t){let{ext:r,key_ops:i,use:n,...s}=t;return crypto.subtle.importKey("jwk",s,function(e,t){switch(e){case"PS256":case"PS384":case"PS512":return{name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`};case"RS256":case"RS384":case"RS512":return{name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`};case"ES256":case"ES384":return{name:"ECDSA",namedCurve:`P-${e.slice(-3)}`};case"ES512":return{name:"ECDSA",namedCurve:"P-521"};case"EdDSA":switch(t){case"Ed25519":case"Ed448":return t;default:throw new ix}default:throw new ix}}(e,t.crv),!0,["verify"])}async function nI(e,t,r){let{cookies:i,logger:n}=r,s=i[e],o=new Date;o.setTime(o.getTime()+9e5),n.debug(`CREATE_${e.toUpperCase()}`,{name:s.name,payload:t,COOKIE_TTL:900,expires:o});let a=await tZ({...r.jwt,maxAge:900,token:{value:t},salt:s.name}),l={...s.options,expires:o};return{name:s.name,value:a,options:l}}async function nD(e,t,r){try{let{logger:i,cookies:n,jwt:s}=r;if(i.debug(`PARSE_${e.toUpperCase()}`,{cookie:t}),!t)throw new S(`${e} cookie was missing`);let o=await tX({...s,token:t,salt:n[e].name});if(o?.value)return o.value;throw Error("Invalid cookie")}catch(t){throw new S(`${e} value could not be parsed`,{cause:t})}}function nL(e,t,r){let{logger:i,cookies:n}=t,s=n[e];i.debug(`CLEAR_${e.toUpperCase()}`,{cookie:s}),r.push({name:s.name,value:"",options:{...n[e].options,maxAge:0}})}function nQ(e,t){return async function(r,i,n){let{provider:s,logger:o}=n;if(!s?.checks?.includes(e))return;let a=r?.[n.cookies[t].name];o.debug(`USE_${t.toUpperCase()}`,{value:a});let l=await nD(t,a,n);return nL(t,n,i),l}}let nB={async create(e){let t=iL(),r=await iQ(t);return{cookie:await nI("pkceCodeVerifier",t,e),value:r}},use:nQ("pkce","pkceCodeVerifier")},nq="encodedState",nM={async create(e,t){let{provider:r}=e;if(!r.checks.includes("state")){if(t)throw new S("State data was provided but the provider is not configured to use state");return}let i={origin:t,random:iL()},n=await tZ({secret:e.jwt.secret,token:i,salt:nq,maxAge:900});return{cookie:await nI("state",n,e),value:n}},use:nQ("state","state"),async decode(e,t){try{t.logger.debug("DECODE_STATE",{state:e});let r=await tX({secret:t.jwt.secret,token:e,salt:nq});if(r)return r;throw Error("Invalid state")}catch(e){throw new S("State could not be decoded",{cause:e})}}},nz={async create(e){if(!e.provider.checks.includes("nonce"))return;let t=iL();return{cookie:await nI("nonce",t,e),value:t}},use:nQ("nonce","nonce")},nH="encodedWebauthnChallenge",nK={create:async(e,t,r)=>({cookie:await nI("webauthnChallenge",await tZ({secret:e.jwt.secret,token:{challenge:t,registerData:r},salt:nH,maxAge:900}),e)}),async use(e,t,r){let i=t?.[e.cookies.webauthnChallenge.name],n=await nD("webauthnChallenge",i,e),s=await tX({secret:e.jwt.secret,token:n,salt:nH});if(nL("webauthnChallenge",e,r),!s)throw new S("WebAuthn challenge was missing");return s}};async function nW(e,t,r){let i,n,s;let{logger:o,provider:a}=r,{token:l,userinfo:c}=a;if(l?.url&&"authjs.dev"!==l.url.host||c?.url&&"authjs.dev"!==c.url.host)i={issuer:a.issuer??"https://authjs.dev",token_endpoint:l?.url.toString(),userinfo_endpoint:c?.url.toString()};else{let e=new URL(a.issuer),t=await iN(e),r=await iD(e,t);if(!r.token_endpoint)throw TypeError("TODO: Authorization server did not provide a token endpoint.");if(!r.userinfo_endpoint)throw TypeError("TODO: Authorization server did not provide a userinfo endpoint.");i=r}let u={client_id:a.clientId,client_secret:a.clientSecret,...a.client},d=[],p=await nM.use(t,d,r),f=function(e,t,r,i){var n;if(iW(e),iF(t),r instanceof URL&&(r=r.searchParams),!(r instanceof URLSearchParams))throw TypeError('"parameters" must be an instance of URLSearchParams, or URL');if(nj(r,"response"))throw new iT('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()');let s=nj(r,"iss"),o=nj(r,"state");if(!s&&e.authorization_response_iss_parameter_supported)throw new iT('response parameter "iss" (issuer) missing');if(s&&s!==e.issuer)throw new iT('unexpected "iss" (issuer) response parameter value');switch(i){case void 0:case nU:if(void 0!==o)throw new iT('unexpected "state" response parameter encountered');break;case nR:break;default:if(!iI(i))throw new iT('"expectedState" must be a non-empty string');if(void 0===o)throw new iT('response parameter "state" missing');if(o!==i)throw new iT('unexpected "state" response parameter value')}let a=nj(r,"error");if(a)return{error:a,error_description:nj(r,"error_description"),error_uri:nj(r,"error_uri")};let l=nj(r,"id_token"),c=nj(r,"token");if(void 0!==l||void 0!==c)throw new ix("implicit and hybrid flows are not supported");return n=new URLSearchParams(r),nh.add(n),n}(i,u,new URLSearchParams(e),a.checks.includes("state")?p:nR);if(i5(f)){let e={providerId:a.id,...f};throw o.debug("OAuthCallbackError",e),new C("OAuth Provider returned an error",e)}let h=await nB.use(t,d,r),m=a.callbackUrl;!r.isOnRedirectProxy&&a.redirectProxyUrl&&(m=a.redirectProxyUrl);let y=await nm(i,u,f,m,h??"auth",{[im]:(...e)=>(!a.checks.includes("pkce")&&e[1]?.body instanceof URLSearchParams&&e[1].body.delete("code_verifier"),fetch(...e)),clientPrivateKey:a.token?.clientPrivateKey});if(a.token?.conform&&(y=await a.token.conform(y.clone())??y),n=function(e){if(!id(e,Response))throw TypeError('"response" must be an instance of Response');let t=e.headers.get("www-authenticate");if(null===t)return;let r=[];for(let{1:e,index:i}of t.matchAll(i8))r.push([e,i]);if(r.length)return r.map(([e,r],i,n)=>{let s=n[i+1];return function(e,t){let r=t.split(i4).slice(1);if(!r.length)return{scheme:e.toLowerCase(),parameters:{}};r[r.length-1]=r[r.length-1].replace(/,$/,"");let i={};for(let e=1;e<r.length;e+=2){var n;let t=e;if('"'===r[t][0])for(;'"'!==r[t].slice(-1)&&++e<r.length;)r[t]+=r[e];i[r[t-1].replace(/^(?:, ?)|=$/g,"").toLowerCase()]=(n=r[t]).length>=2&&'"'===n[0]&&'"'===n[n.length-1]?n.slice(1,-1):n}return{scheme:e.toLowerCase(),parameters:i}}(e,s?t.slice(r,s[1]):t.slice(r))})}(y)){for(let e of n)console.log("challenge",e);throw Error("TODO: Handle www-authenticate challenges as needed")}let g={};if("oidc"===a.type){let e=await nz.use(t,d,r),n=await nv(i,u,y,e??nw);if(i5(n))throw console.log("error",n),Error("TODO: Handle OIDC response body error");let o=nl(n);if(g=o,!1===a.idToken){let e=await i9(i,u,n.access_token);g=await ni(i,u,o.sub,e)}s=n}else{let e=await n_(i,u,y);if(s=e,i5(e))throw console.log("error",e),Error("TODO: Handle OAuth 2.0 response body error");if(c?.request){let e=await c.request({tokens:s,provider:a});e instanceof Object&&(g=e)}else if(c?.url){let t=await i9(i,u,e.access_token);g=await t.json()}else throw TypeError("No userinfo endpoint configured")}return s.expires_in&&(s.expires_at=Math.floor(Date.now()/1e3)+Number(s.expires_in)),{...await nF(g,a,s,o),profile:g,cookies:d}}async function nF(e,t,r,i){try{let i=await t.profile(e,r);return{user:{...i,id:crypto.randomUUID(),email:i.email?.toLowerCase()},account:{...r,provider:t.id,type:t.type,providerAccountId:i.id??crypto.randomUUID()}}}catch(r){i.debug("getProfile error details",e),i.error(new $(r,{provider:t.id}))}}async function nJ(e,t,r,i){let n=await nY(e,t,r),{cookie:s}=await nK.create(e,n.challenge,r);return{status:200,cookies:[...i??[],s],body:{action:"register",options:n},headers:{"Content-Type":"application/json"}}}async function nV(e,t,r,i){let n=await nX(e,t,r),{cookie:s}=await nK.create(e,n.challenge);return{status:200,cookies:[...i??[],s],body:{action:"authenticate",options:n},headers:{"Content-Type":"application/json"}}}async function nG(e,t,r){let i;let{adapter:n,provider:s}=e,o=t.body&&"string"==typeof t.body.data?JSON.parse(t.body.data):void 0;if(!o||"object"!=typeof o||!("id"in o)||"string"!=typeof o.id)throw new p("Invalid WebAuthn Authentication response");let a=n2(n1(o.id)),l=await n.getAuthenticator(a);if(!l)throw new p(`WebAuthn authenticator not found in database: ${JSON.stringify({credentialID:a})}`);let{challenge:c}=await nK.use(e,t.cookies,r);try{let r=s.getRelayingParty(e,t);i=await s.simpleWebAuthn.verifyAuthenticationResponse({...s.verifyAuthenticationOptions,expectedChallenge:c,response:o,authenticator:{...l,credentialDeviceType:l.credentialDeviceType,transports:n3(l.transports),credentialID:n1(l.credentialID),credentialPublicKey:n1(l.credentialPublicKey)},expectedOrigin:r.origin,expectedRPID:r.id})}catch(e){throw new H(e)}let{verified:u,authenticationInfo:d}=i;if(!u)throw new H("WebAuthn authentication response could not be verified");try{let{newCounter:e}=d;await n.updateAuthenticatorCounter(l.credentialID,e)}catch(e){throw new h(`Failed to update authenticator counter. This may cause future authentication attempts to fail. ${JSON.stringify({credentialID:a,oldCounter:l.counter,newCounter:d.newCounter})}`,e)}let f=await n.getAccount(l.providerAccountId,s.id);if(!f)throw new p(`WebAuthn account not found in database: ${JSON.stringify({credentialID:a,providerAccountId:l.providerAccountId})}`);let m=await n.getUser(f.userId);if(!m)throw new p(`WebAuthn user not found in database: ${JSON.stringify({credentialID:a,providerAccountId:l.providerAccountId,userID:f.userId})}`);return{account:f,user:m}}async function nZ(e,t,r){var i;let n;let{provider:s}=e,o=t.body&&"string"==typeof t.body.data?JSON.parse(t.body.data):void 0;if(!o||"object"!=typeof o||!("id"in o)||"string"!=typeof o.id)throw new p("Invalid WebAuthn Registration response");let{challenge:a,registerData:l}=await nK.use(e,t.cookies,r);if(!l)throw new p("Missing user registration data in WebAuthn challenge cookie");try{let r=s.getRelayingParty(e,t);n=await s.simpleWebAuthn.verifyRegistrationResponse({...s.verifyRegistrationOptions,expectedChallenge:a,response:o,expectedOrigin:r.origin,expectedRPID:r.id})}catch(e){throw new H(e)}if(!n.verified||!n.registrationInfo)throw new H("WebAuthn registration response could not be verified");let c={providerAccountId:n2(n.registrationInfo.credentialID),provider:e.provider.id,type:s.type},u={providerAccountId:c.providerAccountId,counter:n.registrationInfo.counter,credentialID:n2(n.registrationInfo.credentialID),credentialPublicKey:n2(n.registrationInfo.credentialPublicKey),credentialBackedUp:n.registrationInfo.credentialBackedUp,credentialDeviceType:n.registrationInfo.credentialDeviceType,transports:(i=o.response.transports,i?.join(","))};return{user:l,account:c,authenticator:u}}async function nX(e,t,r){let{provider:i,adapter:n}=e,s=r&&r.id?await n.listAuthenticatorsByUserId(r.id):null,o=i.getRelayingParty(e,t);return await i.simpleWebAuthn.generateAuthenticationOptions({...i.authenticationOptions,rpID:o.id,allowCredentials:s?.map(e=>({id:n1(e.credentialID),type:"public-key",transports:n3(e.transports)}))})}async function nY(e,t,r){let{provider:i,adapter:n}=e,s=r.id?await n.listAuthenticatorsByUserId(r.id):null,o=re(32),a=i.getRelayingParty(e,t);return await i.simpleWebAuthn.generateRegistrationOptions({...i.registrationOptions,userID:o,userName:r.email,userDisplayName:r.name??void 0,rpID:a.id,rpName:a.name,excludeCredentials:s?.map(e=>({id:n1(e.credentialID),type:"public-key",transports:n3(e.transports)}))})}function n0(e){let{provider:t,adapter:r}=e;if(!r)throw new A("An adapter is required for the WebAuthn provider");if(!t||"webauthn"!==t.type)throw new D("Provider must be WebAuthn");return{...e,provider:t,adapter:r}}function n1(e){return new Uint8Array(Buffer.from(e,"base64"))}function n2(e){return Buffer.from(e).toString("base64")}function n3(e){return e?e.split(","):void 0}async function n6(e,t,r,i){if(!t.provider)throw new D("Callback route called without provider");let{query:n,body:s,method:o,headers:a}=e,{provider:l,adapter:c,url:u,callbackUrl:d,pages:f,jwt:h,events:m,callbacks:g,session:{strategy:w,maxAge:b},logger:_}=t,S="jwt"===w;try{if("oauth"===l.type||"oidc"===l.type){let o;let a=l.authorization?.url.searchParams.get("response_mode")==="form_post"?s:n;if(t.isOnRedirectProxy&&a?.state){let e=await nM.decode(a.state,t);if(e?.origin&&new URL(e.origin).origin!==t.url.origin){let t=`${e.origin}?${new URLSearchParams(a)}`;return _.debug("Proxy redirecting to",t),{redirect:t,cookies:i}}}let p=await nW(a,e.cookies,t);p.cookies.length&&i.push(...p.cookies),_.debug("authorization result",p);let{user:y,account:w,profile:v}=p;if(!y||!w||!v)return{redirect:`${u}/signin`,cookies:i};if(c){let{getUserByAccount:e}=c;o=await e({providerAccountId:w.providerAccountId,provider:l.id})}let k=await n5({user:o??y,account:w,profile:v},t);if(k)return{redirect:k,cookies:i};let{user:A,session:x,isNewUser:E}=await iu(r.value,y,w,t);if(S){let e={name:A.name,email:A.email,picture:A.image,sub:A.id?.toString()},n=await g.jwt({token:e,user:A,account:w,profile:v,isNewUser:E,trigger:E?"signUp":"signIn"});if(null===n)i.push(...r.clean());else{let e=t.cookies.sessionToken.name,s=await h.encode({...h,token:n,salt:e}),o=new Date;o.setTime(o.getTime()+1e3*b);let a=r.chunk(s,{expires:o});i.push(...a)}}else i.push({name:t.cookies.sessionToken.name,value:x.sessionToken,options:{...t.cookies.sessionToken.options,expires:x.expires}});if(await m.signIn?.({user:A,account:w,profile:v,isNewUser:E}),E&&f.newUser)return{redirect:`${f.newUser}${f.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:d})}`,cookies:i};return{redirect:d,cookies:i}}if("email"===l.type){let e=n?.token,s=n?.email;if(!e){let t=TypeError("Missing token. The sign-in URL was manually opened without token or the link was not sent correctly in the email.",{cause:{hasToken:!!e}});throw t.name="Configuration",t}let o=l.secret??t.secret,a=await c.useVerificationToken({identifier:s,token:await t9(`${e}${o}`)}),u=!!a,p=u&&a.expires.valueOf()<Date.now();if(!u||p||s&&a.identifier!==s)throw new Q({hasInvite:u,expired:p});let{identifier:y}=a,w=await c.getUserByEmail(y)??{id:crypto.randomUUID(),email:y,emailVerified:null},v={providerAccountId:w.email,userId:w.id,type:"email",provider:l.id},_=await n5({user:w,account:v},t);if(_)return{redirect:_,cookies:i};let{user:k,session:A,isNewUser:x}=await iu(r.value,w,v,t);if(S){let e={name:k.name,email:k.email,picture:k.image,sub:k.id?.toString()},n=await g.jwt({token:e,user:k,account:v,isNewUser:x,trigger:x?"signUp":"signIn"});if(null===n)i.push(...r.clean());else{let e=t.cookies.sessionToken.name,s=await h.encode({...h,token:n,salt:e}),o=new Date;o.setTime(o.getTime()+1e3*b);let a=r.chunk(s,{expires:o});i.push(...a)}}else i.push({name:t.cookies.sessionToken.name,value:A.sessionToken,options:{...t.cookies.sessionToken.options,expires:A.expires}});if(await m.signIn?.({user:k,account:v,isNewUser:x}),x&&f.newUser)return{redirect:`${f.newUser}${f.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:d})}`,cookies:i};return{redirect:d,cookies:i}}if("credentials"===l.type&&"POST"===o){let e=s??{};Object.entries(n??{}).forEach(([e,t])=>u.searchParams.set(e,t));let c=await l.authorize(e,new Request(u,{headers:a,method:o,body:JSON.stringify(s)}));if(c)c.id=c.id?.toString()??crypto.randomUUID();else throw new v;let p={providerAccountId:c.id,type:"credentials",provider:l.id},f=await n5({user:c,account:p,credentials:e},t);if(f)return{redirect:f,cookies:i};let y={name:c.name,email:c.email,picture:c.image,sub:c.id},w=await g.jwt({token:y,user:c,account:p,isNewUser:!1,trigger:"signIn"});if(null===w)i.push(...r.clean());else{let e=t.cookies.sessionToken.name,n=await h.encode({...h,token:w,salt:e}),s=new Date;s.setTime(s.getTime()+1e3*b);let o=r.chunk(n,{expires:s});i.push(...o)}return await m.signIn?.({user:c,account:p}),{redirect:d,cookies:i}}if("webauthn"===l.type&&"POST"===o){let n,s,o;let a=e.body?.action;if("string"!=typeof a||"authenticate"!==a&&"register"!==a)throw new p("Invalid action parameter");let l=n0(t);switch(a){case"authenticate":{let t=await nG(l,e,i);n=t.user,s=t.account;break}case"register":{let r=await nZ(t,e,i);n=r.user,s=r.account,o=r.authenticator}}await n5({user:n,account:s},t);let{user:c,isNewUser:u,session:y,account:w}=await iu(r.value,n,s,t);if(!w)throw new p("Error creating or finding account");if(o&&c.id&&await l.adapter.createAuthenticator({...o,userId:c.id}),S){let e={name:c.name,email:c.email,picture:c.image,sub:c.id?.toString()},n=await g.jwt({token:e,user:c,account:w,isNewUser:u,trigger:u?"signUp":"signIn"});if(null===n)i.push(...r.clean());else{let e=t.cookies.sessionToken.name,s=await h.encode({...h,token:n,salt:e}),o=new Date;o.setTime(o.getTime()+1e3*b);let a=r.chunk(s,{expires:o});i.push(...a)}}else i.push({name:t.cookies.sessionToken.name,value:y.sessionToken,options:{...t.cookies.sessionToken.options,expires:y.expires}});if(await m.signIn?.({user:c,account:w,isNewUser:u}),u&&f.newUser)return{redirect:`${f.newUser}${f.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:d})}`,cookies:i};return{redirect:d,cookies:i}}throw new D(`Callback for provider type (${l.type}) is not supported`)}catch(t){if(t instanceof p)throw t;let e=new y(t,{provider:l.id});throw _.debug("callback route error details",{method:o,query:n,body:s}),e}}async function n5(e,t){let r;let{signIn:i,redirect:n}=t.callbacks;try{r=await i(e)}catch(e){if(e instanceof p)throw e;throw new m(e)}if(!r)throw new m("AccessDenied");if("string"==typeof r)return await n({url:r,baseUrl:t.url.origin})}async function n4(e,t,r,i,n){let{adapter:s,jwt:o,events:a,callbacks:l,logger:c,session:{strategy:u,maxAge:d}}=e,p={body:null,headers:{"Content-Type":"application/json"},cookies:r},f=t.value;if(!f)return p;if("jwt"===u){try{let r=e.cookies.sessionToken.name,s=await o.decode({...o,token:f,salt:r});if(!s)throw Error("Invalid JWT");let c=await l.jwt({token:s,...i&&{trigger:"update"},session:n}),u=ic(d);if(null!==c){let e={user:{name:c.name,email:c.email,image:c.picture},expires:u.toISOString()},i=await l.session({session:e,token:c});p.body=i;let n=await o.encode({...o,token:c,salt:r}),s=t.chunk(n,{expires:u});p.cookies?.push(...s),await a.session?.({session:i,token:c})}else p.cookies?.push(...t.clean())}catch(e){c.error(new k(e)),p.cookies?.push(...t.clean())}return p}try{let{getSessionAndUser:r,deleteSession:o,updateSession:c}=s,u=await r(f);if(u&&u.session.expires.valueOf()<Date.now()&&(await o(f),u=null),u){let{user:t,session:r}=u,s=e.session.updateAge,o=r.expires.valueOf()-1e3*d+1e3*s,h=ic(d);o<=Date.now()&&await c({sessionToken:f,expires:h});let m=await l.session({session:{...r,user:t},user:t,newSession:n,...i?{trigger:"update"}:{}});p.body=m,p.cookies?.push({name:e.cookies.sessionToken.name,value:f,options:{...e.cookies.sessionToken.options,expires:h}}),await a.session?.({session:m})}else f&&p.cookies?.push(...t.clean())}catch(e){c.error(new O(e))}return p}async function n8(e,t){let r,i;let{logger:n,provider:s}=t,o=s.authorization?.url;if(!o||"authjs.dev"===o.host){let e=new URL(s.issuer),t=await iN(e),r=await iD(e,t);if(!r.authorization_endpoint)throw TypeError("Authorization server did not provide an authorization endpoint.");o=new URL(r.authorization_endpoint)}let a=o.searchParams,l=s.callbackUrl;!t.isOnRedirectProxy&&s.redirectProxyUrl&&(l=s.redirectProxyUrl,i=s.callbackUrl,n.debug("using redirect proxy",{redirect_uri:l,data:i}));let c=Object.assign({response_type:"code",client_id:s.clientId,redirect_uri:l,...s.authorization?.params},Object.fromEntries(s.authorization?.url.searchParams??[]),e);for(let e in c)a.set(e,c[e]);let u=[],d=await nM.create(t,i);if(d&&(a.set("state",d.value),u.push(d.cookie)),s.checks?.includes("pkce")){if(r&&!r.code_challenge_methods_supported?.includes("S256"))"oidc"===s.type&&(s.checks=["nonce"]);else{let{value:e,cookie:r}=await nB.create(t);a.set("code_challenge",e),a.set("code_challenge_method","S256"),u.push(r)}}let p=await nz.create(t);return p&&(a.set("nonce",p.value),u.push(p.cookie)),"oidc"!==s.type||o.searchParams.has("scope")||o.searchParams.set("scope","openid profile email"),n.debug("authorization url is ready",{url:o,cookies:u,provider:s}),{redirect:o.toString(),cookies:u}}async function n7(e,t){let r;let{body:i}=e,{provider:n,callbacks:s,adapter:o}=t,a=(n.normalizeIdentifier??function(e){if(!e)throw Error("Missing email from request body.");let[t,r]=e.toLowerCase().trim().split("@");return r=r.split(",")[0],`${t}@${r}`})(i?.email),l={id:crypto.randomUUID(),email:a,emailVerified:null},c=await o.getUserByEmail(a)??l,u={providerAccountId:a,userId:c.id,type:"email",provider:n.id};try{r=await s.signIn({user:c,account:u,email:{verificationRequest:!0}})}catch(e){throw new m(e)}if(!r)throw new m("AccessDenied");if("string"==typeof r)return{redirect:await s.redirect({url:r,baseUrl:t.url.origin})};let{callbackUrl:d,theme:p}=t,f=await n.generateVerificationToken?.()??re(32),h=new Date(Date.now()+(n.maxAge??86400)*1e3),y=n.secret??t.secret,g=new URL(t.basePath,t.url.origin),w=n.sendVerificationRequest({identifier:a,token:f,expires:h,url:`${g}/callback/${n.id}?${new URLSearchParams({callbackUrl:d,token:f,email:a})}`,provider:n,theme:p,request:new Request(e.url,{headers:e.headers,method:e.method,body:"POST"===e.method?JSON.stringify(e.body??{}):void 0})}),b=o.createVerificationToken?.({identifier:a,token:await t9(`${f}${y}`),expires:h});return await Promise.all([w,b]),{redirect:`${g}/verify-request?${new URLSearchParams({provider:n.id,type:n.type})}`}}async function n9(e,t,r){let i=`${r.url.origin}${r.basePath}/signin`;if(!r.provider)return{redirect:i,cookies:t};switch(r.provider.type){case"oauth":case"oidc":{let{redirect:i,cookies:n}=await n8(e.query,r);return n&&t.push(...n),{redirect:i,cookies:t}}case"email":return{...await n7(e,r),cookies:t};default:return{redirect:i,cookies:t}}}async function se(e,t,r){let{jwt:i,events:n,callbackUrl:s,logger:o,session:a}=r,l=t.value;if(!l)return{redirect:s,cookies:e};try{if("jwt"===a.strategy){let e=r.cookies.sessionToken.name,t=await i.decode({...i,token:l,salt:e});await n.signOut?.({token:t})}else{let e=await r.adapter?.deleteSession(l);await n.signOut?.({session:e})}}catch(e){o.error(new U(e))}return e.push(...t.clean()),{redirect:s,cookies:e}}async function st(e,t){let{adapter:r,jwt:i,session:{strategy:n}}=e,s=t.value;if(!s)return null;if("jwt"===n){let t=e.cookies.sessionToken.name,r=await i.decode({...i,token:s,salt:t});if(r&&r.sub)return{id:r.sub,name:r.name,email:r.email,image:r.picture}}else{let e=await r?.getSessionAndUser(s);if(e)return e.user}return null}async function sr(e,t,r,i){let n=n0(t),{provider:s}=n,{action:o}=e.query??{};if("register"!==o&&"authenticate"!==o&&void 0!==o)return{status:400,body:{error:"Invalid action"},cookies:i,headers:{"Content-Type":"application/json"}};let a=await st(t,r),l=a?{user:a,exists:!0}:await s.getUserInfo(t,e),c=l?.user;switch(function(e,t,r){let{user:i,exists:n=!1}=r??{};switch(e){case"authenticate":return"authenticate";case"register":if(i&&t===n)return"register";break;case void 0:if(!t){if(!i||n)return"authenticate";return"register"}}return null}(o,!!a,l)){case"authenticate":return nV(n,e,c,i);case"register":if("string"==typeof c?.email)return nJ(n,e,c,i);break;default:return{status:400,body:{error:"Invalid request"},cookies:i,headers:{"Content-Type":"application/json"}}}}async function si(e,t){let{action:r,providerId:i,error:n,method:s}=e,o=t.skipCSRFCheck===sn,{options:a,cookies:l}=await ru({authOptions:t,action:r,providerId:i,url:e.url,callbackUrl:e.body?.callbackUrl??e.query?.callbackUrl,csrfToken:e.body?.csrfToken,cookies:e.cookies,isPost:"POST"===s,csrfDisabled:o}),c=new d(a.cookies.sessionToken,e.cookies,a.logger);if("GET"===s){let t=il({...a,query:e.query,cookies:l});switch(r){case"callback":return await n6(e,a,c,l);case"csrf":return t.csrf(o,a,l);case"error":return t.error(n);case"providers":return t.providers(a.providers);case"session":return await n4(a,c,l);case"signin":return t.signin(i,n);case"signout":return t.signout();case"verify-request":return t.verifyRequest();case"webauthn-options":return await sr(e,a,c,l)}}else{let{csrfTokenVerified:t}=a;switch(r){case"callback":return"credentials"===a.provider.type&&rr(r,t),await n6(e,a,c,l);case"session":return rr(r,t),await n4(a,c,l,!0,e.body?.data);case"signin":return rr(r,t),await n9(e,l,a);case"signout":return rr(r,t),await se(l,c,a)}}throw new N(`Cannot handle action: ${r}`)}let sn=Symbol("skip-csrf-check"),ss=Symbol("return-type-raw");function so(e,t,r,i,n){let s;let o=n?.basePath,a=i.AUTH_URL??i.NEXTAUTH_URL;if(a)s=new URL(a),o&&"/"!==o&&"/"!==s.pathname&&(s.pathname!==o&&t6(n).warn("env-url-basepath-mismatch"),s.pathname="/");else{let e=r.get("x-forwarded-host")??r.get("host"),i=r.get("x-forwarded-proto")??t??"https",n=i.endsWith(":")?i:i+":";s=new URL(`${n}//${e}`)}let l=s.toString().replace(/\/$/,"");if(o){let t=o?.replace(/(^\/|\/$)/g,"")??"";return new URL(`${l}/${t}/${e}`)}return new URL(`${l}/${e}`)}async function sa(e,t){let r=t6(t),i=await t8(e,t);if(!i)return Response.json("Bad request.",{status:400});let n=function(e,t){let{url:r}=e,i=[];if(!F&&t.debug&&i.push("debug-enabled"),!t.trustHost)return new L(`Host must be trusted. URL was: ${e.url}`);if(!t.secret?.length)return new T("Please define a `secret`");let n=e.query?.callbackUrl;if(n&&!J(n,r.origin))return new b(`Invalid callback URL. Received: ${n}`);let{callbackUrl:s}=u(t.useSecureCookies??"https:"===r.protocol),o=e.cookies?.[t.cookies?.callbackUrl?.name??s.name];if(o&&!J(o,r.origin))return new b(`Invalid callback URL. Received: ${o}`);let a=!1;for(let e of t.providers){let t="function"==typeof e?e():e;if(("oauth"===t.type||"oidc"===t.type)&&!(t.issuer??t.options?.issuer)){let e;let{authorization:r,token:i,userinfo:n}=t;if("string"==typeof r||r?.url?"string"==typeof i||i?.url?"string"==typeof n||n?.url||(e="userinfo"):e="token":e="authorization",e)return new _(`Provider "${t.id}" is missing both \`issuer\` and \`${e}\` endpoint config. At least one of them is required`)}if("credentials"===t.type)V=!0;else if("email"===t.type)G=!0;else if("webauthn"===t.type){var l;if(Z=!0,t.simpleWebAuthnBrowserVersion&&(l=t.simpleWebAuthnBrowserVersion,!/^v\d+(?:\.\d+){0,2}$/.test(l)))return new p(`Invalid provider config for "${t.id}": simpleWebAuthnBrowserVersion "${t.simpleWebAuthnBrowserVersion}" must be a valid semver string.`);if(t.enableConditionalUI){if(a)return new M("Multiple webauthn providers have 'enableConditionalUI' set to True. Only one provider can have this option enabled at a time");if(a=!0,!Object.values(t.formFields).some(e=>e.autocomplete&&e.autocomplete.toString().indexOf("webauthn")>-1))return new z(`Provider "${t.id}" has 'enableConditionalUI' set to True, but none of its formFields have 'webauthn' in their autocomplete param`)}}}if(V){let e=t.session?.strategy==="database",r=!t.providers.some(e=>"credentials"!==("function"==typeof e?e():e).type);if(e&&r)return new I("Signing in with credentials only supported if JWT strategy is enabled");if(t.providers.some(e=>{let t="function"==typeof e?e():e;return"credentials"===t.type&&!t.authorize}))return new E("Must define an authorize() handler to use credentials authentication provider")}let{adapter:c,session:d}=t,f=[];if(G||d?.strategy==="database"||!d?.strategy&&c){if(G){if(!c)return new A("Email login requires an adapter");f.push(...X)}else{if(!c)return new A("Database session requires an adapter");f.push(...Y)}}if(Z){if(!t.experimental?.enableWebAuthn)return new W("WebAuthn is an experimental feature. To enable it, set `experimental.enableWebAuthn` to `true` in your config");if(i.push("experimental-webauthn"),!c)return new A("WebAuthn requires an adapter");f.push(...ee)}if(c){let e=f.filter(e=>!(e in c));if(e.length)return new x(`Required adapter methods were missing: ${e.join(", ")}`)}return F||(F=!0),i}(i,t);if(Array.isArray(n))n.forEach(r.warn);else if(n){if(r.error(n),!new Set(["signin","signout","error","verify-request"]).has(i.action)||"GET"!==i.method)return Response.json({message:"There was a problem with the server configuration. Check the server logs for more information."},{status:500});let{pages:e,theme:s}=t,o=e?.error&&i.url.searchParams.get("callbackUrl")?.startsWith(e.error);if(!e?.error||o)return o&&r.error(new g(`The error page ${e?.error} should not require authentication`)),t7(il({theme:s}).error("Configuration"));let a=`${i.url.origin}${e.error}?error=Configuration`;return Response.redirect(a)}let s=e.headers?.has("X-Auth-Return-Redirect"),o=t.raw===ss;try{let e=await si(i,t);if(o)return e;let r=t7(e),n=r.headers.get("Location");if(!s||!n)return r;return Response.json({url:n},{headers:r.headers})}catch(d){r.error(d);let n=d instanceof p;if(n&&o&&!s)throw d;if("POST"===e.method&&"session"===i.action)return Response.json(null,{status:400});let a=new URLSearchParams({error:d instanceof p&&q.has(d.type)?d.type:"Configuration"});d instanceof v&&a.set("code",d.code);let l=n&&d.kind||"error",c=t.pages?.[l]??`${t.basePath}/${l.toLowerCase()}`,u=`${i.url.origin}${c}?${a}`;if(s)return Response.json({url:u});return Response.redirect(u)}}var sl=r(49588);function sc(e){let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return e;let{origin:r}=new URL(t),{href:i,origin:n}=e.nextUrl;return new sl.NextRequest(i.replace(n,r),e)}function su(e){try{e.secret??(e.secret=process.env.AUTH_SECRET??process.env.NEXTAUTH_SECRET);let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return;let{pathname:r}=new URL(t);if("/"===r)return;e.basePath||(e.basePath=r)}catch{}finally{e.basePath||(e.basePath="/api/auth"),function(e,t,r=!1){try{let i=e.AUTH_URL;i&&(t.basePath?r||t6(t).warn("env-url-basepath-redundant"):t.basePath=new URL(i).pathname)}catch{}finally{t.basePath??(t.basePath="/auth")}if(!t.secret?.length){t.secret=[];let r=e.AUTH_SECRET;for(let i of(r&&t.secret.push(r),[1,2,3])){let r=e[`AUTH_SECRET_${i}`];r&&t.secret.unshift(r)}}t.redirectProxyUrl??(t.redirectProxyUrl=e.AUTH_REDIRECT_PROXY_URL),t.trustHost??(t.trustHost=!!(e.AUTH_URL??e.AUTH_TRUST_HOST??e.VERCEL??e.CF_PAGES??"production"!==e.NODE_ENV)),t.providers=t.providers.map(t=>{let{id:r}="function"==typeof t?t({}):t,i=r.toUpperCase().replace(/-/g,"_"),n=e[`AUTH_${i}_ID`],s=e[`AUTH_${i}_SECRET`],o=e[`AUTH_${i}_ISSUER`],a=e[`AUTH_${i}_KEY`],l="function"==typeof t?t({clientId:n,clientSecret:s,issuer:o,apiKey:a}):t;return"oauth"===l.type||"oidc"===l.type?(l.clientId??(l.clientId=n),l.clientSecret??(l.clientSecret=s),l.issuer??(l.issuer=o)):"email"===l.type&&(l.apiKey??(l.apiKey=a)),l})}(process.env,e,!0)}}var sd=r(4742);async function sp(e,t){return sa(new Request(so("session",e.get("x-forwarded-proto"),e,process.env,t),{headers:{cookie:e.get("cookie")??""}}),{...t,callbacks:{...t.callbacks,async session(...e){let r=await t.callbacks?.session?.(...e)??{...e[0].session,expires:e[0].session.expires?.toISOString?.()??e[0].session.expires};return{user:e[0].user??e[0].token,...r}}}})}function sf(e){return"function"==typeof e}function sh(e,t){return"function"==typeof e?async(...r)=>{if(!r.length){let r=(0,sd.headers)(),i=await e(void 0);return t?.(i),sp(r,i).then(e=>e.json())}if(r[0]instanceof Request){let i=r[0],n=r[1],s=await e(i);return t?.(s),sm([i,n],s)}if(sf(r[0])){let i=r[0];return async(...r)=>{let n=await e(r[0]);return t?.(n),sm(r,n,i)}}let i="req"in r[0]?r[0].req:r[0],n="res"in r[0]?r[0].res:r[1],s=await e(i);return t?.(s),sp(new Headers(i.headers),s).then(async e=>{let t=await e.json();for(let t of e.headers.getSetCookie())"headers"in n?n.headers.append("set-cookie",t):n.appendHeader("set-cookie",t);return t})}:(...t)=>{if(!t.length)return sp((0,sd.headers)(),e).then(e=>e.json());if(t[0]instanceof Request)return sm([t[0],t[1]],e);if(sf(t[0])){let r=t[0];return async(...t)=>sm(t,e,r).then(e=>e)}let r="req"in t[0]?t[0].req:t[0],i="res"in t[0]?t[0].res:t[1];return sp(new Headers(r.headers),e).then(async e=>{let t=await e.json();for(let t of e.headers.getSetCookie())"headers"in i?i.headers.append("set-cookie",t):i.appendHeader("set-cookie",t);return t})}}async function sm(e,t,r){let i=sc(e[0]),n=await sp(i.headers,t),s=await n.json(),o=!0;t.callbacks?.authorized&&(o=await t.callbacks.authorized({request:i,auth:s}));let a=sl.NextResponse.next?.();if(o instanceof Response){a=o;let e=o.headers.get("Location"),{pathname:r}=i.nextUrl;e&&function(e,t,r){let i=t.replace(`${e}/`,""),n=Object.values(r.pages??{});return(sy.has(i)||n.includes(t))&&t===e}(r,new URL(e).pathname,t)&&(o=!0)}else if(r)i.auth=s,a=await r(i,e[1])??sl.NextResponse.next();else if(!o){let e=t.pages?.signIn??`${t.basePath}/signin`;if(i.nextUrl.pathname!==e){let t=i.nextUrl.clone();t.pathname=e,t.searchParams.set("callbackUrl",i.nextUrl.href),a=sl.NextResponse.redirect(t)}}let l=new Response(a?.body,a);for(let e of n.headers.getSetCookie())l.headers.append("set-cookie",e);return l}let sy=new Set(["providers","session","csrf","signin","signout","callback","verify-request","error"]);var sg=r(69319);async function sw(e,t={},r,i){let n=new Headers((0,sd.headers)()),{redirect:s=!0,redirectTo:o,...a}=t instanceof FormData?Object.fromEntries(t):t,l=o?.toString()??n.get("Referer")??"/",c=so("signin",n.get("x-forwarded-proto"),n,process.env,i);if(!e)return c.searchParams.append("callbackUrl",l),s&&(0,sg.redirect)(c.toString()),c.toString();let u=`${c}/${e}?${new URLSearchParams(r)}`,d={};for(let t of i.providers){let{options:r,...i}="function"==typeof t?t():t,n=r?.id??i.id;if(n===e){d={id:n,type:r?.type??i.type};break}}if(!d.id){let e=`${c}?${new URLSearchParams({callbackUrl:l})}`;return s&&(0,sg.redirect)(e),e}"credentials"===d.type&&(u=u.replace("signin","callback")),n.set("Content-Type","application/x-www-form-urlencoded");let p=new Request(u,{method:"POST",headers:n,body:new URLSearchParams({...a,callbackUrl:l})}),f=await sa(p,{...i,raw:ss,skipCSRFCheck:sn});for(let e of f?.cookies??[])(0,sd.cookies)().set(e.name,e.value,e.options);let h=(f instanceof Response?f.headers.get("Location"):f.redirect)??u;return s?(0,sg.redirect)(h):h}async function sb(e,t){let r=new Headers((0,sd.headers)());r.set("Content-Type","application/x-www-form-urlencoded");let i=so("signout",r.get("x-forwarded-proto"),r,process.env,t),n=new URLSearchParams({callbackUrl:e?.redirectTo??r.get("Referer")??"/"}),s=new Request(i,{method:"POST",headers:r,body:n}),o=await sa(s,{...t,raw:ss,skipCSRFCheck:sn});for(let e of o?.cookies??[])(0,sd.cookies)().set(e.name,e.value,e.options);return e?.redirect??!0?(0,sg.redirect)(o.redirect):o}async function sv(e,t){let r=new Headers((0,sd.headers)());r.set("Content-Type","application/json");let i=new Request(so("session",r.get("x-forwarded-proto"),r,process.env,t),{method:"POST",headers:r,body:JSON.stringify({data:e})}),n=await sa(i,{...t,raw:ss,skipCSRFCheck:sn});for(let e of n?.cookies??[])(0,sd.cookies)().set(e.name,e.value,e.options);return n.body}function s_(e){if("function"==typeof e){let t=async t=>{let r=await e(t);return su(r),sa(sc(t),r)};return{handlers:{GET:t,POST:t},auth:sh(e,e=>su(e)),signIn:async(t,r,i)=>{let n=await e(void 0);return su(n),sw(t,r,i,n)},signOut:async t=>{let r=await e(void 0);return su(r),sb(t,r)},unstable_update:async t=>{let r=await e(void 0);return su(r),sv(t,r)}}}su(e);let t=t=>sa(sc(t),e);return{handlers:{GET:t,POST:t},auth:sh(e),signIn:(t,r,i)=>sw(t,r,i,e),signOut:t=>sb(t,e),unstable_update:t=>sv(t,e)}}},32219:(e,t,r)=>{"use strict";r.d(t,{Z:()=>ev});var i=r(22037),n=r(57147);let s=new Map,o=new Map,a=Symbol("OriginError"),l={};class c extends Promise{constructor(e,t,r,i,n={}){let o,l;super((e,t)=>{o=e,l=t}),this.tagged=Array.isArray(e.raw),this.strings=e,this.args=t,this.handler=r,this.canceller=i,this.options=n,this.state=null,this.statement=null,this.resolve=e=>(this.active=!1,o(e)),this.reject=e=>(this.active=!1,l(e)),this.active=!1,this.cancelled=null,this.executed=!1,this.signature="",this[a]=this.handler.debug?Error():this.tagged&&function(e){if(s.has(e))return s.get(e);let t=Error.stackTraceLimit;return Error.stackTraceLimit=4,s.set(e,Error()),Error.stackTraceLimit=t,s.get(e)}(this.strings)}get origin(){return(this.handler.debug?this[a].stack:this.tagged&&o.has(this.strings)?o.get(this.strings):o.set(this.strings,this[a].stack).get(this.strings))||""}static get[Symbol.species](){return Promise}cancel(){return this.canceller&&(this.canceller(this),this.canceller=null)}simple(){return this.options.simple=!0,this.options.prepare=!1,this}async readable(){return this.simple(),this.streaming=!0,this}async writable(){return this.simple(),this.streaming=!0,this}cursor(e=1,t){let r;return(this.options.simple=!1,"function"==typeof e&&(t=e,e=1),this.cursorRows=e,"function"==typeof t)?(this.cursorFn=t,this):{[Symbol.asyncIterator]:()=>({next:()=>{if(this.executed&&!this.active)return{done:!0};r&&r();let e=new Promise((e,t)=>{this.cursorFn=t=>(e({value:t,done:!1}),new Promise(e=>r=e)),this.resolve=()=>(this.active=!1,e({done:!0})),this.reject=e=>(this.active=!1,t(e))});return this.execute(),e},return:()=>(r&&r(l),{done:!0})})}}describe(){return this.options.simple=!1,this.onlyDescribe=this.options.prepare=!0,this}stream(){throw Error(".stream has been renamed to .forEach")}forEach(e){return this.forEachFn=e,this.handle(),this}raw(){return this.isRaw=!0,this}values(){return this.isRaw="values",this}async handle(){!this.executed&&(this.executed=!0)&&await 1&&this.handler(this)}execute(){return this.handle(),this}then(){return this.handle(),super.then.apply(this,arguments)}catch(){return this.handle(),super.catch.apply(this,arguments)}finally(){return this.handle(),super.finally.apply(this,arguments)}}class u extends Error{constructor(e){super(e.message),this.name=this.constructor.name,Object.assign(this,e)}}let d={connection:function e(t,r,i){let{host:n,port:s}=i||r,o=Object.assign(Error("write "+t+" "+(r.path||n+":"+s)),{code:t,errno:t,address:r.path||n},r.path?{}:{port:s});return Error.captureStackTrace(o,e),o},postgres:function e(t){let r=new u(t);return Error.captureStackTrace(r,e),r},generic:function e(t,r){let i=Object.assign(Error(t+": "+r),{code:t});return Error.captureStackTrace(i,e),i},notSupported:function e(t){let r=Object.assign(Error(t+" (B) is not supported"),{code:"MESSAGE_NOT_SUPPORTED",name:t});return Error.captureStackTrace(r,e),r}};class p{then(){x()}catch(){x()}finally(){x()}}class f extends p{constructor(e){super(),this.value=O(e)}}class h extends p{constructor(e,t,r){super(),this.value=e,this.type=t,this.array=r}}class m extends p{constructor(e,t){super(),this.first=e,this.rest=t}build(e,t,r,i){let n=A.map(([t,r])=>({fn:r,i:e.search(t)})).sort((e,t)=>e.i-t.i).pop();return -1===n.i?$(this.first,i):n.fn(this.first,this.rest,t,r,i)}}function y(e,t,r,i){let n=e instanceof h?e.value:e;if(void 0===n&&(e instanceof h?e.value=i.transform.undefined:n=e=i.transform.undefined,void 0===n))throw d.generic("UNDEFINED_VALUE","Undefined values are not allowed");return"$"+r.push(e instanceof h?(t.push(e.value),e.array?e.array[e.type||j(e.value)]||e.type||function e(t){return Array.isArray(t)?e(t[0]):"string"==typeof t?1009:0}(e.value):e.type):(t.push(e),j(e)))}let g=C({string:{to:25,from:null,serialize:e=>""+e},number:{to:0,from:[21,23,26,700,701],serialize:e=>""+e,parse:e=>+e},json:{to:114,from:[114,3802],serialize:e=>JSON.stringify(e),parse:e=>JSON.parse(e)},boolean:{to:16,from:16,serialize:e=>!0===e?"t":"f",parse:e=>"t"===e},date:{to:1184,from:[1082,1114,1184],serialize:e=>(e instanceof Date?e:new Date(e)).toISOString(),parse:e=>new Date(e)},bytea:{to:17,from:17,serialize:e=>"\\x"+Buffer.from(e).toString("hex"),parse:e=>Buffer.from(e.slice(2),"hex")}});function w(e,t,r,i,n,s){for(let o=1;o<e.strings.length;o++)t+=b(t,r,i,n,s)+e.strings[o],r=e.args[o];return t}function b(e,t,r,i,n){return t instanceof m?t.build(e,r,i,n):t instanceof c?v(t,r,i,n):t instanceof f?t.value:t&&t[0]instanceof c?t.reduce((e,t)=>e+" "+v(t,r,i,n),""):y(t,r,i,n)}function v(e,t,r,i){return e.fragment=!0,w(e,e.strings[0],e.args[0],t,r,i)}function _(e,t,r,i,n){return e.map(e=>"("+i.map(i=>b("values",e[i],t,r,n)).join(",")+")").join(",")}function S(e,t,r,i,n){let s=Array.isArray(e[0]),o=t.length?t.flat():Object.keys(s?e[0]:e);return _(s?e:[e],r,i,o,n)}function k(e,t,r,i,n){let s;return("string"==typeof e&&(e=[e].concat(t)),Array.isArray(e))?$(e,n):(t.length?t.flat():Object.keys(e)).map(t=>((s=e[t])instanceof c?v(s,r,i,n):s instanceof f?s.value:y(s,r,i,n))+" as "+O(n.transform.column.to?n.transform.column.to(t):t)).join(",")}let A=Object.entries({values:S,in:(...e)=>{let t=S(...e);return"()"===t?"(null)":t},select:k,as:k,returning:k,"\\(":k,update:(e,t,r,i,n)=>(t.length?t.flat():Object.keys(e)).map(t=>O(n.transform.column.to?n.transform.column.to(t):t)+"="+b("values",e[t],r,i,n)),insert(e,t,r,i,n){let s=t.length?t.flat():Object.keys(Array.isArray(e)?e[0]:e);return"("+$(s,n)+")values"+_(Array.isArray(e)?e:[e],r,i,s,n)}}).map(([e,t])=>[RegExp("((?:^|[\\s(])"+e+"(?:$|[\\s(]))(?![\\s\\S]*\\1)","i"),t]);function x(){throw d.generic("NOT_TAGGED_CALL","Query not called as a tagged template literal")}let E=g.serializers,T=g.parsers,P=function(e){let t=C(e||{});return{serializers:Object.assign({},E,t.serializers),parsers:Object.assign({},T,t.parsers)}};function C(e){return Object.keys(e).reduce((t,r)=>(e[r].from&&[].concat(e[r].from).forEach(i=>t.parsers[i]=e[r].parse),e[r].serialize&&(t.serializers[e[r].to]=e[r].serialize,e[r].from&&[].concat(e[r].from).forEach(i=>t.serializers[i]=e[r].serialize)),t),{parsers:{},serializers:{}})}function $(e,{transform:{column:t}}){return e.map(e=>O(t.to?t.to(e):e)).join(",")}let O=function(e){return'"'+e.replace(/"/g,'""').replace(/\./g,'"."')+'"'},j=function e(t){return t instanceof h?t.type:t instanceof Date?1184:t instanceof Uint8Array?17:!0===t||!1===t?16:"bigint"==typeof t?20:Array.isArray(t)?e(t[0]):0},R=/\\/g,U=/"/g,N=function e(t,r,i,n){if(!1===Array.isArray(t))return t;if(!t.length)return"{}";let s=t[0],o=1020===n?";":",";return Array.isArray(s)&&!s.type?"{"+t.map(t=>e(t,r,i,n)).join(o)+"}":"{"+t.map(e=>{if(void 0===e&&void 0===(e=i.transform.undefined))throw d.generic("UNDEFINED_VALUE","Undefined values are not allowed");return null===e?"null":'"'+(r?r(e.type?e.value:e):""+e).replace(R,"\\\\").replace(U,'\\"')+'"'}).join(o)+"}"},I={i:0,char:null,str:"",quoted:!1,last:0},D=e=>{let t=e[0];for(let r=1;r<e.length;r++)t+="_"===e[r]?e[++r].toUpperCase():e[r];return t},L=e=>{let t=e[0].toUpperCase();for(let r=1;r<e.length;r++)t+="_"===e[r]?e[++r].toUpperCase():e[r];return t},Q=e=>e.replace(/_/g,"-"),B=e=>e.replace(/([A-Z])/g,"_$1").toLowerCase(),q=e=>(e.slice(0,1)+e.slice(1).replace(/([A-Z])/g,"_$1")).toLowerCase(),M=e=>e.replace(/-/g,"_");function z(e){return function t(r,i){return"object"==typeof r&&null!==r&&(114===i.type||3802===i.type)?Array.isArray(r)?r.map(e=>t(e,i)):Object.entries(r).reduce((r,[n,s])=>Object.assign(r,{[e(n)]:t(s,i)}),{}):r}}D.column={from:D},D.value={from:z(D)},B.column={to:B};let H={...D};H.column.to=B,L.column={from:L},L.value={from:z(L)},q.column={to:q};let K={...L};K.column.to=q,Q.column={from:Q},Q.value={from:z(Q)},M.column={to:M};let W={...Q};W.column.to=M;var F=r(41808),J=r(24404),V=r(6113),G=r(12781),Z=r(4074);class X extends Array{constructor(){super(),Object.defineProperties(this,{count:{value:null,writable:!0},state:{value:null,writable:!0},command:{value:null,writable:!0},columns:{value:null,writable:!0},statement:{value:null,writable:!0}})}static get[Symbol.species](){return Array}}let Y=function(e=[]){let t=e.slice(),r=0;return{get length(){return t.length-r},remove:e=>{let r=t.indexOf(e);return -1===r?null:(t.splice(r,1),e)},push:e=>(t.push(e),e),shift:()=>{let e=t[r++];return r===t.length?(r=0,t=[]):t[r-1]=void 0,e}}},ee=Buffer.allocUnsafe(256),et=Object.assign(function(){return et.i=0,et},"BCcDdEFfHPpQSX".split("").reduce((e,t)=>{let r=t.charCodeAt(0);return e[t]=()=>(ee[0]=r,et.i=5,et),e},{}),{N:"\0",i:0,inc:e=>(et.i+=e,et),str(e){let t=Buffer.byteLength(e);return er(t),et.i+=ee.write(e,et.i,t,"utf8"),et},i16:e=>(er(2),ee.writeUInt16BE(e,et.i),et.i+=2,et),i32:(e,t)=>(t||0===t?ee.writeUInt32BE(e,t):(er(4),ee.writeUInt32BE(e,et.i),et.i+=4),et),z:e=>(er(e),ee.fill(0,et.i,et.i+e),et.i+=e,et),raw:e=>(ee=Buffer.concat([ee.subarray(0,et.i),e]),et.i=ee.length,et),end(e=1){ee.writeUInt32BE(et.i-e,e);let t=ee.subarray(0,et.i);return et.i=0,ee=Buffer.allocUnsafe(256),t}});function er(e){if(ee.length-et.i<e){let t=ee,r=t.length;ee=Buffer.allocUnsafe(r+(r>>1)+e),t.copy(ee)}}let ei=function e(t,r={},{onopen:i=eu,onend:n=eu,onclose:s=eu}={}){let{ssl:o,max:a,user:u,host:p,port:f,database:h,parsers:m,transform:g,onnotice:b,onnotify:v,onparameter:_,max_pipeline:S,keep_alive:k,backoff:A,target_session_attrs:x}=t,E=Y(),T=en++,P={pid:null,secret:null},C=ey(eW,t.idle_timeout),$=ey(eW,t.max_lifetime),O=ey(function(){eH(d.connection("CONNECT_TIMEOUT",t,j)),j.destroy()},t.connect_timeout),j=null,R,U=new X,D=Buffer.alloc(0),L=t.fetch_types,Q={},B={},q=Math.random().toString(36).slice(2),M=1,z=0,H=0,K=0,W=0,ee=0,er=0,ei=0,ep=null,eg=null,ew=!1,eb=null,ev=null,e_=null,eS=null,ek=null,eA=null,ex=null,eE=null,eT=null,eP=null,eC={queue:r.closed,idleTimer:C,connect(e){e_=e,eq()},terminate:eF,execute:ej,cancel:eO,end:eW,count:0,id:T};return r.closed&&r.closed.push(eC),eC;async function e$(){let e;try{e=t.socket?await Promise.resolve(t.socket(t)):new F.Socket}catch(e){ez(e);return}return e.on("error",ez),e.on("close",eJ),e.on("drain",eL),e}async function eO({pid:e,secret:t},r,i){try{R=et().i32(16).i32(80877102).i32(e).i32(t).end(16),await eB(),j.once("error",i),j.once("close",r)}catch(e){i(e)}}function ej(e){if(ew)return eK(e,d.connection("CONNECTION_DESTROYED",t));if(!e.cancelled)try{return e.state=P,eT?E.push(e):(eT=e).active=!0,function(e){let r=[],i=[],n=w(e,e.strings[0],e.args[0],r,i,t);e.tagged||e.args.forEach(e=>y(e,r,i,t)),e.prepare=t.prepare&&(!("prepare"in e.options)||e.options.prepare),e.string=n,e.signature=e.prepare&&i+n,e.onlyDescribe&&delete B[e.signature],e.parameters=e.parameters||r,e.prepared=e.prepare&&e.signature in B,e.describeFirst=e.onlyDescribe||r.length&&!e.prepared,e.statement=e.prepared?B[e.signature]:{string:n,types:i,name:e.prepare?q+M++:""},"function"==typeof t.debug&&t.debug(T,n,r,i)}(e),eN(function(e){if(e.parameters.length>=65534)throw d.generic("MAX_PARAMETERS_EXCEEDED","Max number of parameters (65534) exceeded");return e.options.simple?et().Q().str(e.statement.string+et.N).end():e.describeFirst?Buffer.concat([eR(e),eo]):e.prepare?e.prepared?eU(e):Buffer.concat([eR(e),eU(e)]):Buffer.concat([e6(e.statement.string,e.parameters,e.statement.types),ec,eU(e)])}(e))&&!e.describeFirst&&!e.cursorFn&&E.length<S&&(!e.options.onexecute||e.options.onexecute(eC))}catch(e){return 0===E.length&&eN(es),eH(e),!0}}function eR(e){return Buffer.concat([e6(e.statement.string,e.parameters,e.statement.types,e.statement.name),function(e,t=""){return et().D().str("S").str(t+et.N).end()}(0,e.statement.name)])}function eU(e){return Buffer.concat([function(e,r,i="",n=""){let s,o;return et().B().str(n+et.N).str(i+et.N).i16(0).i16(e.length),e.forEach((i,n)=>{if(null===i)return et.i32(4294967295);o=r[n],e[n]=i=o in t.serializers?t.serializers[o](i):""+i,s=et.i,et.inc(4).str(i).i32(et.i-s-4,s)}),et.i16(0),et.end()}(e.parameters,e.statement.types,e.statement.name,e.cursorName),e.cursorFn?e5("",e.cursorRows):el])}function eN(e,t){return(eA=eA?Buffer.concat([eA,e]):Buffer.from(e),t||eA.length>=1024)?eI(t):(null===eg&&(eg=setImmediate(eI)),!0)}function eI(e){let t=j.write(eA,e);return null!==eg&&clearImmediate(eg),eA=eg=null,t}async function eD(){if(eN(ea),!await new Promise(e=>j.once("data",t=>e(83===t[0])))&&"prefer"===o)return eM();j.removeAllListeners(),(j=J.connect({socket:j,servername:F.isIP(j.host)?void 0:j.host,..."require"===o||"allow"===o||"prefer"===o?{rejectUnauthorized:!1}:"verify-full"===o?{}:"object"==typeof o?o:{}})).on("secureConnect",eM),j.on("error",ez),j.on("close",eJ),j.on("drain",eL)}function eL(){eT||i(eC)}function eQ(r){if(!eb||(eb.push(r),!((H-=r.length)>0)))for(D=eb?Buffer.concat(eb,ee-H):0===D.length?r:Buffer.concat([D,r],D.length+r.length);D.length>4;){if((ee=D.readUInt32BE(1))>=D.length){H=ee-D.length,eb=[D];break}try{(function(r,n=r[0]){(68===n?function(e){let t,r,i,n=7,s=eT.isRaw?Array(eT.statement.columns.length):{};for(let o=0;o<eT.statement.columns.length;o++)r=eT.statement.columns[o],t=e.readInt32BE(n),n+=4,i=-1===t?null:!0===eT.isRaw?e.subarray(n,n+=t):void 0===r.parser?e.toString("utf8",n,n+=t):!0===r.parser.array?r.parser(e.toString("utf8",n+1,n+=t)):r.parser(e.toString("utf8",n,n+=t)),eT.isRaw?s[o]=!0===eT.isRaw?i:g.value.from?g.value.from(i,r):i:s[r.name]=g.value.from?g.value.from(i,r):i;eT.forEachFn?eT.forEachFn(g.row.from?g.row.from(s):s,U):U[ei++]=g.row.from?g.row.from(s):s}:100===n?function(e){ek&&(ek.push(e.subarray(5))||j.pause())}:65===n?function(e){if(!v)return;let t=9;for(;0!==e[t++];);v(e.toString("utf8",9,t-1),e.toString("utf8",t,e.length-1))}:83===n?function(e){let[r,i]=e.toString("utf8",5,e.length-1).split(et.N);Q[r]=i,t.parameters[r]!==i&&(t.parameters[r]=i,_&&_(r,i))}:90===n?function(r){if(eT&&eT.options.simple&&eT.resolve(ev||U),eT=ev=null,U=new X,O.cancel(),e_){if(x){var n;if(!Q.in_hot_standby||!Q.default_transaction_read_only)return function(){let e=new c([`
      show transaction_read_only;
      select pg_catalog.pg_is_in_recovery()
    `],[],ej,null,{simple:!0});e.resolve=([[e],[t]])=>{Q.default_transaction_read_only=e.transaction_read_only,Q.in_hot_standby=t.pg_is_in_recovery?"on":"off"},e.execute()}();if(n=Q,"read-write"===x&&"on"===n.default_transaction_read_only||"read-only"===x&&"off"===n.default_transaction_read_only||"primary"===x&&"on"===n.in_hot_standby||"standby"===x&&"off"===n.in_hot_standby||"prefer-standby"===x&&"off"===n.in_hot_standby&&t.host[W])return eF()}return L?(e_.reserve&&(e_=null),e2()):(e_&&!e_.reserve&&ej(e_),t.shared.retries=W=0,void(e_=null))}for(;E.length&&(eT=E.shift())&&(eT.active=!0,eT.cancelled);)e(t).cancel(eT.state,eT.cancelled.resolve,eT.cancelled.reject);eT||(eC.reserved?eC.reserved.release||73!==r[5]?eC.reserved():eS?eF():(eC.reserved=null,i(eC)):eS?eF():i(eC))}:67===n?function(e){ei=0;for(let t=e.length-1;t>0;t--)if(32===e[t]&&e[t+1]<58&&null===U.count&&(U.count=+e.toString("utf8",t+1,e.length-1)),e[t-1]>=65){U.command=e.toString("utf8",5,t),U.state=P;break}return(eP&&(eP(),eP=null),"BEGIN"!==U.command||1===a||eC.reserved)?eT.options.simple?eV():void(eT.cursorFn&&(U.count&&eT.cursorFn(U),eN(es)),eT.resolve(U)):eH(d.generic("UNSAFE_TRANSACTION","Only use sql.begin, sql.reserved or max: 1"))}:50===n?eV:49===n?function(){eT.parsing=!1}:116===n?function(e){let t=e.readUInt16BE(5);for(let r=0;r<t;++r)eT.statement.types[r]||(eT.statement.types[r]=e.readUInt32BE(7+4*r));eT.prepare&&(B[eT.signature]=eT.statement),eT.describeFirst&&!eT.onlyDescribe&&(eN(eU(eT)),eT.describeFirst=!1)}:84===n?function(e){let t;U.command&&((ev=ev||[U]).push(U=new X),U.count=null,eT.statement.columns=null);let r=e.readUInt16BE(5),i=7;eT.statement.columns=Array(r);for(let n=0;n<r;++n){for(t=i;0!==e[i++];);let r=e.readUInt32BE(i),s=e.readUInt16BE(i+4),o=e.readUInt32BE(i+6);eT.statement.columns[n]={name:g.column.from?g.column.from(e.toString("utf8",t,i-1)):e.toString("utf8",t,i-1),parser:m[o],table:r,number:s,type:o},i+=18}if(U.statement=eT.statement,eT.onlyDescribe)return eT.resolve(eT.statement),eN(es)}:82===n?eG:110===n?function(){if(U.statement=eT.statement,U.statement.columns=[],eT.onlyDescribe)return eT.resolve(eT.statement),eN(es)}:75===n?function(e){P.pid=e.readUInt32BE(5),P.secret=e.readUInt32BE(9)}:69===n?function(e){var t;eT&&(eT.cursorFn||eT.describeFirst)&&eN(es);let r=d.postgres(ef(e));eT&&eT.retried?eH(eT.retried):eT&&eT.prepared&&ed.has(r.routine)?(t=eT,delete B[t.signature],t.retried=r,ej(t)):eH(r)}:115===n?e3:51===n?function(){U.count&&eT.cursorFn(U),eT.resolve(U)}:71===n?function(){ek=new G.Writable({autoDestroy:!0,write(e,t,r){j.write(et().d().raw(e).end(),r)},destroy(e,t){t(e),j.write(et().f().str(e+et.N).end()),ek=null},final(e){j.write(et().c().end()),eP=e}}),eT.resolve(ek)}:78===n?function(e){b?b(ef(e)):console.log(ef(e))}:72===n?function(){ek=new G.Readable({read(){j.resume()}}),eT.resolve(ek)}:99===n?function(){ek&&ek.push(null),ek=null}:73===n?function(){}:86===n?function(){eH(d.notSupported("FunctionCallResponse"))}:118===n?function(){eH(d.notSupported("NegotiateProtocolVersion"))}:87===n?function(){ek=new G.Duplex({autoDestroy:!0,read(){j.resume()},write(e,t,r){j.write(et().d().raw(e).end(),r)},destroy(e,t){t(e),j.write(et().f().str(e+et.N).end()),ek=null},final(e){j.write(et().c().end()),eP=e}}),eT.resolve(ek)}:function(e){console.error("Postgres.js : Unknown Message:",e[0])})(r)})(D.subarray(0,ee+1))}catch(e){eT&&(eT.cursorFn||eT.describeFirst)&&eN(es),eH(e)}D=D.subarray(ee+1),H=0,eb=null}}async function eB(){if(ew=!1,Q={},j||(j=await e$()),j){if(O.start(),t.socket)return o?eD():eM();if(j.on("connect",o?eD:eM),t.path)return j.connect(t.path);j.ssl=o,j.connect(f[K],p[K]),j.host=p[K],j.port=f[K],K=(K+1)%f.length}}function eq(){setTimeout(eB,z?z+er-Z.performance.now():0)}function eM(){try{B={},L=t.fetch_types,q=Math.random().toString(36).slice(2),M=1,$.start(),j.on("data",eQ),k&&j.setKeepAlive&&j.setKeepAlive(!0,1e3*k);let e=R||et().inc(4).i16(3).z(2).str(Object.entries(Object.assign({user:u,database:h,client_encoding:"UTF8"},t.connection)).filter(([,e])=>e).map(([e,t])=>e+et.N+t).join(et.N)).z(2).end(0);eN(e)}catch(e){ez(e)}}function ez(e){if(eC.queue!==r.connecting||!t.host[W+1])for(eH(e);E.length;)eK(E.shift(),e)}function eH(e){ek&&(ek.destroy(e),ek=null),eT&&eK(eT,e),e_&&(eK(e_,e),e_=null)}function eK(e,r){if(e.reserve)return e.reject(r);r&&"object"==typeof r||(r=Error(r)),"query"in r||"parameters"in r||Object.defineProperties(r,{stack:{value:r.stack+e.origin.replace(/.*\n/,"\n"),enumerable:t.debug},query:{value:e.string,enumerable:t.debug},parameters:{value:e.parameters,enumerable:t.debug},args:{value:e.args,enumerable:t.debug},types:{value:e.statement&&e.statement.types,enumerable:t.debug}}),e.reject(r)}function eW(){return eS||(eC.reserved||n(eC),eC.reserved||e_||eT||0!==E.length?eS=new Promise(e=>ex=e):(eF(),new Promise(e=>j&&"closed"!==j.readyState?j.once("close",e):e())))}function eF(){ew=!0,(ek||eT||e_||E.length)&&ez(d.connection("CONNECTION_DESTROYED",t)),clearImmediate(eg),j&&(j.removeListener("data",eQ),j.removeListener("connect",eM),"open"===j.readyState&&j.end(et().X().end())),ex&&(ex(),eS=ex=null)}async function eJ(e){if(D=Buffer.alloc(0),H=0,eb=null,clearImmediate(eg),j.removeListener("data",eQ),j.removeListener("connect",eM),C.cancel(),$.cancel(),O.cancel(),j.removeAllListeners(),j=null,e_)return eq();!e&&(eT||E.length)&&ez(d.connection("CONNECTION_CLOSED",t,j)),z=Z.performance.now(),e&&t.shared.retries++,er=("function"==typeof A?A(t.shared.retries):A)*1e3,s(eC,d.connection("CONNECTION_CLOSED",t,j))}function eV(){U.statement||(U.statement=eT.statement),U.columns=eT.statement.columns}async function eG(e,t=e.readUInt32BE(5)){(3===t?eZ:5===t?eX:10===t?eY:11===t?e0:12===t?function(e){e.toString("utf8",9).split(et.N,1)[0].slice(2)!==ep&&(eH(d.generic("SASL_SIGNATURE_MISMATCH","The server did not return the correct signature")),j.destroy())}:0!==t?function(e,t){console.error("Postgres.js : Unknown Auth:",t)}:eu)(e,t)}async function eZ(){let e=await e1();eN(et().p().str(e).z(1).end())}async function eX(e){let t="md5"+await eh(Buffer.concat([Buffer.from(await eh(await e1()+u)),e.subarray(9)]));eN(et().p().str(t).z(1).end())}async function eY(){eE=(await V.randomBytes(18)).toString("base64"),et().p().str("SCRAM-SHA-256"+et.N);let e=et.i;eN(et.inc(4).str("n,,n=*,r="+eE).i32(et.i-e-4,e).end())}async function e0(e){let t=e.toString("utf8",9).split(",").reduce((e,t)=>(e[t[0]]=t.slice(2),e),{}),r=await V.pbkdf2Sync(await e1(),Buffer.from(t.s,"base64"),parseInt(t.i),32,"sha256"),i=await em(r,"Client Key"),n="n=*,r="+eE+",r="+t.r+",s="+t.s+",i="+t.i+",c=biws,r="+t.r;ep=(await em(await em(r,"Server Key"),n)).toString("base64");let s="c=biws,r="+t.r+",p="+(function(e,t){let r=Math.max(e.length,t.length),i=Buffer.allocUnsafe(r);for(let n=0;n<r;n++)i[n]=e[n]^t[n];return i})(i,Buffer.from(await em(await V.createHash("sha256").update(i).digest(),n))).toString("base64");eN(et().p().str(s).end())}function e1(){return Promise.resolve("function"==typeof t.pass?t.pass():t.pass)}async function e2(){L=!1,(await new c([`
      select b.oid, b.typarray
      from pg_catalog.pg_type a
      left join pg_catalog.pg_type b on b.oid = a.typelem
      where a.typcategory = 'A'
      group by b.oid, b.typarray
      order by b.oid
    `],[],ej)).forEach(({oid:e,typarray:r})=>(function(e,r){if(t.parsers[r]&&t.serializers[r])return;let i=t.parsers[e];t.shared.typeArrayMap[e]=r,t.parsers[r]=e=>(I.i=I.last=0,function e(t,r,i,n){let s=[],o=1020===n?";":",";for(;t.i<r.length;t.i++){if(t.char=r[t.i],t.quoted)"\\"===t.char?t.str+=r[++t.i]:'"'===t.char?(s.push(i?i(t.str):t.str),t.str="",t.quoted='"'===r[t.i+1],t.last=t.i+2):t.str+=t.char;else if('"'===t.char)t.quoted=!0;else if("{"===t.char)t.last=++t.i,s.push(e(t,r,i,n));else if("}"===t.char){t.quoted=!1,t.last<t.i&&s.push(i?i(r.slice(t.last,t.i)):r.slice(t.last,t.i)),t.last=t.i+1;break}else t.char===o&&"}"!==t.p&&'"'!==t.p&&(s.push(i?i(r.slice(t.last,t.i)):r.slice(t.last,t.i)),t.last=t.i+1);t.p=t.char}return t.last<t.i&&s.push(i?i(r.slice(t.last,t.i+1)):r.slice(t.last,t.i+1)),s}(I,e,i,r)),t.parsers[r].array=!0,t.serializers[r]=i=>N(i,t.serializers[e],t,r)})(e,r))}async function e3(){try{let e=await Promise.resolve(eT.cursorFn(U));ei=0,e===l?eN(function(e=""){return Buffer.concat([et().C().str("P").str(e+et.N).end(),et().S().end()])}(eT.portal)):(U=new X,eN(e5("",eT.cursorRows)))}catch(e){eN(es),eT.reject(e)}}function e6(e,t,r,i=""){return et().P().str(i+et.N).str(e+et.N).i16(t.length),t.forEach((e,t)=>et.i32(r[t]||0)),et.end()}function e5(e="",t=0){return Buffer.concat([et().E().str(e+et.N).i32(t).end(),eo])}},en=1,es=et().S().end(),eo=et().H().end(),ea=et().i32(8).i32(80877103).end(8),el=Buffer.concat([et().E().str(et.N).i32(0).end(),es]),ec=et().D().str("S").str(et.N).end(),eu=()=>{},ed=new Set(["FetchPreparedStatement","RevalidateCachedQuery","transformAssignedExpr"]),ep={83:"severity_local",86:"severity",67:"code",77:"message",68:"detail",72:"hint",80:"position",112:"internal_position",113:"internal_query",87:"where",115:"schema_name",116:"table_name",99:"column_name",100:"data type_name",110:"constraint_name",70:"file",76:"line",82:"routine"};function ef(e){let t={},r=5;for(let i=5;i<e.length-1;i++)0===e[i]&&(t[ep[e[r]]]=e.toString("utf8",r+1,i),r=i+1);return t}function eh(e){return V.createHash("md5").update(e).digest("hex")}function em(e,t){return V.createHmac("sha256",e).update(t).digest()}function ey(e,t){let r;if(!(t="function"==typeof t?t():t))return{cancel:eu,start:eu};return{cancel(){r&&(clearTimeout(r),r=null)},start(){r&&clearTimeout(r),r=setTimeout(i,1e3*t,arguments)}};function i(t){e.apply(null,t),r=null}}let eg=()=>{};function ew(e,t,r,i){let n,s,o;let a=i.raw?Array(t.length):{};for(let l=0;l<t.length;l++)n=e[r++],s=t[l],o=110===n?null:117===n?void 0:void 0===s.parser?e.toString("utf8",r+4,r+=4+e.readUInt32BE(r)):!0===s.parser.array?s.parser(e.toString("utf8",r+5,r+=4+e.readUInt32BE(r))):s.parser(e.toString("utf8",r+4,r+=4+e.readUInt32BE(r))),i.raw?a[l]=!0===i.raw?o:i.value.from?i.value.from(o,s):o:a[s.name]=i.value.from?i.value.from(o,s):o;return{i:r,row:i.row.from?i.row.from(a):a}}function eb(e,t,r=393216){return new Promise(async(i,n)=>{await e.begin(async e=>{let n;t||([{oid:t}]=await e`select lo_creat(-1) as oid`);let[{fd:s}]=await e`select lo_open(${t}, ${r}) as fd`,o={writable:l,readable:a,close:()=>e`select lo_close(${s})`.then(n),tell:()=>e`select lo_tell64(${s})`,read:t=>e`select loread(${s}, ${t}) as data`,write:t=>e`select lowrite(${s}, ${t})`,truncate:t=>e`select lo_truncate64(${s}, ${t})`,seek:(t,r=0)=>e`select lo_lseek64(${s}, ${t}, ${r})`,size:()=>e`
          select
            lo_lseek64(${s}, location, 0) as position,
            seek.size
          from (
            select
              lo_lseek64($1, 0, 2) as size,
              tell.location
            from (select lo_tell64($1) as location) tell
          ) seek
        `};return i(o),new Promise(async e=>n=e);async function a({highWaterMark:e=16384,start:t=0,end:r=1/0}={}){let i=r-t;return t&&await o.seek(t),new G.Readable({highWaterMark:e,async read(e){let t=e>i?e-i:e;i-=e;let[{data:r}]=await o.read(t);this.push(r),r.length<e&&this.push(null)}})}async function l({highWaterMark:e=16384,start:t=0}={}){return t&&await o.seek(t),new G.Writable({highWaterMark:e,write(e,t,r){o.write(e).then(()=>r(),r)}})}}).catch(n)})}Object.assign(e_,{PostgresError:u,toPascal:L,pascal:K,toCamel:D,camel:H,toKebab:Q,kebab:W,fromPascal:q,fromCamel:B,fromKebab:M,BigInt:{to:20,from:[20],parse:e=>BigInt(e),serialize:e=>e.toString()}});let ev=e_;function e_(e,t){let r=function(e,t){var r;if(e&&e.shared)return e;let n=process.env,s=(e&&"string"!=typeof e?e:t)||{},{url:o,multihost:a}=function(e){if(!e||"string"!=typeof e)return{url:{searchParams:new Map}};let t=e;t=decodeURIComponent((t=t.slice(t.indexOf("://")+3).split(/[?/]/)[0]).slice(t.indexOf("@")+1));let r=new URL(e.replace(t,t.split(",")[0]));return{url:{username:decodeURIComponent(r.username),password:decodeURIComponent(r.password),host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,searchParams:r.searchParams},multihost:t.indexOf(",")>-1&&t}}(e),l=[...o.searchParams].reduce((e,[t,r])=>(e[t]=r,e),{}),c=s.hostname||s.host||a||o.hostname||n.PGHOST||"localhost",u=s.port||o.port||n.PGPORT||5432,d=s.user||s.username||o.username||n.PGUSERNAME||n.PGUSER||function(){try{return i.userInfo().username}catch(e){return process.env.USERNAME||process.env.USER||process.env.LOGNAME}}();s.no_prepare&&(s.prepare=!1),l.sslmode&&(l.ssl=l.sslmode,delete l.sslmode),"timeout"in s&&(console.log("The timeout option is deprecated, use idle_timeout instead"),s.idle_timeout=s.timeout),"system"===l.sslrootcert&&(l.ssl="verify-full");let p=["idle_timeout","connect_timeout","max_lifetime","max_pipeline","backoff","keep_alive"],f={max:10,ssl:!1,idle_timeout:null,connect_timeout:30,max_lifetime:ek,max_pipeline:100,backoff:eS,keep_alive:60,prepare:!0,debug:!1,fetch_types:!0,publications:"alltables",target_session_attrs:null};return{host:Array.isArray(c)?c:c.split(",").map(e=>e.split(":")[0]),port:Array.isArray(u)?u:c.split(",").map(e=>parseInt(e.split(":")[1]||u)),path:s.path||c.indexOf("/")>-1&&c+"/.s.PGSQL."+u,database:s.database||s.db||(o.pathname||"").slice(1)||n.PGDATABASE||d,user:d,pass:s.pass||s.password||o.password||n.PGPASSWORD||"",...Object.entries(f).reduce((e,[t,r])=>{let i=t in s?s[t]:t in l?"disable"!==l[t]&&"false"!==l[t]&&l[t]:n["PG"+t.toUpperCase()]||r;return e[t]="string"==typeof i&&p.includes(t)?+i:i,e},{}),connection:{application_name:n.PGAPPNAME||"postgres.js",...s.connection,...Object.entries(l).reduce((e,[t,r])=>(t in f||(e[t]=r),e),{})},types:s.types||{},target_session_attrs:function(e,t,r){let i=e.target_session_attrs||t.searchParams.get("target_session_attrs")||r.PGTARGETSESSIONATTRS;if(!i||["read-write","read-only","primary","standby","prefer-standby"].includes(i))return i;throw Error("target_session_attrs "+i+" is not supported")}(s,o,n),onnotice:s.onnotice,onnotify:s.onnotify,onclose:s.onclose,onparameter:s.onparameter,socket:s.socket,transform:{undefined:(r=s.transform||{undefined:void 0}).undefined,column:{from:"function"==typeof r.column?r.column:r.column&&r.column.from,to:r.column&&r.column.to},value:{from:"function"==typeof r.value?r.value:r.value&&r.value.from,to:r.value&&r.value.to},row:{from:"function"==typeof r.row?r.row:r.row&&r.row.from,to:r.row&&r.row.to}},parameters:{},shared:{retries:0,typeArrayMap:{}},...P(s.types)}}(e,t),s=r.no_subscribe||function(e,t){let r=new Map,i="postgresjs_"+Math.random().toString(36).slice(2),n={},s,o,a=!1,l=d.sql=e({...t,transform:{column:{},value:{},row:{}},max:1,fetch_types:!1,idle_timeout:null,max_lifetime:null,connection:{...t.connection,replication:"database"},onclose:async function(){a||(o=null,n.pid=n.secret=void 0,p(await f(l,i,t.publications)),r.forEach(e=>e.forEach(({onsubscribe:e})=>e())))},no_subscribe:!0}),c=l.end,u=l.close;return l.end=async()=>(a=!0,o&&await new Promise(e=>(o.once("close",e),o.end())),c()),l.close=async()=>(o&&await new Promise(e=>(o.once("close",e),o.end())),u()),d;async function d(e,a,c=eg,u=eg){e=function(e){let t=e.match(/^(\*|insert|update|delete)?:?([^.]+?\.?[^=]+)?=?(.+)?/i)||[];if(!t)throw Error("Malformed subscribe pattern: "+e);let[,r,i,n]=t;return(r||"*")+(i?":"+(-1===i.indexOf(".")?"public."+i:i):"")+(n?"="+n:"")}(e),s||(s=f(l,i,t.publications));let h={fn:a,onsubscribe:c},m=r.has(e)?r.get(e).add(h):r.set(e,new Set([h])).get(e),y=()=>{m.delete(h),0===m.size&&r.delete(e)};return s.then(e=>(p(e),c(),o&&o.on("error",u),{unsubscribe:y,state:n,sql:l}))}function p(e){o=e.stream,n.pid=e.state.pid,n.secret=e.state.secret}async function f(e,r,i){if(!i)throw Error("Missing publication names");let n=await e.unsafe(`CREATE_REPLICATION_SLOT ${r} TEMPORARY LOGICAL pgoutput NOEXPORT_SNAPSHOT`),[s]=n,o=await e.unsafe(`START_REPLICATION SLOT ${r} LOGICAL ${s.consistent_point} (proto_version '1', publication_names '${i}')`).writable(),a={lsn:Buffer.concat(s.consistent_point.split("/").map(e=>Buffer.from(("00000000"+e).slice(-8),"hex")))};return o.on("data",function(r){119===r[0]?function(e,t,r,i,n){Object.entries({R:e=>{let i=1,s=t[e.readUInt32BE(i)]={schema:e.toString("utf8",i+=4,i=e.indexOf(0,i))||"pg_catalog",table:e.toString("utf8",i+1,i=e.indexOf(0,i+1)),columns:Array(e.readUInt16BE(i+=2)),keys:[]};i+=2;let o=0,a;for(;i<e.length;)(a=s.columns[o++]={key:e[i++],name:n.column.from?n.column.from(e.toString("utf8",i,i=e.indexOf(0,i))):e.toString("utf8",i,i=e.indexOf(0,i)),type:e.readUInt32BE(i+=1),parser:r[e.readUInt32BE(i)],atttypmod:e.readUInt32BE(i+=4)}).key&&s.keys.push(a),i+=4},Y:()=>{},O:()=>{},B:e=>{var r;t.date=(r=e.readBigInt64BE(9),new Date(Date.UTC(2e3,0,1)+Number(r/BigInt(1e3)))),t.lsn=e.subarray(1,9)},I:e=>{let r=1,s=t[e.readUInt32BE(r)],{row:o}=ew(e,s.columns,r+=7,n);i(o,{command:"insert",relation:s})},D:e=>{let r=1,s=t[e.readUInt32BE(r)],o=75===e[r+=4];i(o||79===e[r]?ew(e,s.columns,r+=3,n).row:null,{command:"delete",relation:s,key:o})},U:e=>{let r=1,s=t[e.readUInt32BE(r)],o=75===e[r+=4],a=o||79===e[r]?ew(e,s.columns,r+=3,n):null;a&&(r=a.i);let{row:l}=ew(e,s.columns,r+3,n);i(l,{command:"update",relation:s,key:o,old:a&&a.row})},T:()=>{},C:()=>{}}).reduce((e,[t,r])=>(e[t.charCodeAt(0)]=r,e),{})[e[0]](e)}(r.subarray(25),a,e.options.parsers,l,t.transform):107===r[0]&&r[17]&&(a.lsn=r.subarray(1,9),function(){let e=Buffer.alloc(34);e[0]=114,e.fill(a.lsn,1),e.writeBigInt64BE(BigInt(Date.now()-Date.UTC(2e3,0,1))*BigInt(1e3),25),o.write(e)}())}),o.on("error",function(e){console.error("Unexpected error during logical streaming - reconnecting",e)}),o.on("close",e.close),{stream:o,state:n.state};function l(e,t){let r=t.relation.schema+"."+t.relation.table;h("*",e,t),h("*:"+r,e,t),t.relation.keys.length&&h("*:"+r+"="+t.relation.keys.map(t=>e[t.name]),e,t),h(t.command,e,t),h(t.command+":"+r,e,t),t.relation.keys.length&&h(t.command+":"+r+"="+t.relation.keys.map(t=>e[t.name]),e,t)}}function h(e,t,i){r.has(e)&&r.get(e).forEach(({fn:r})=>r(t,i,e))}}(e_,{...r}),o=!1,a=Y(),p=Y(),y=Y(),g=Y(),w=Y(),b=Y(),v=Y(),_=Y(),S={connecting:p,reserved:y,closed:g,ended:w,open:b,busy:v,full:_},k=[...Array(r.max)].map(()=>ei(r,S,{onopen:q,onend:B,onclose:M})),A=x(function(e){return o?e.reject(d.connection("CONNECTION_ENDED",r,r)):b.length?U(b.shift(),e):g.length?Q(g.shift(),e):void(v.length?U(v.shift(),e):a.push(e))});return Object.assign(A,{get parameters(){return r.parameters},largeObject:eb.bind(null,A),subscribe:s,CLOSE:l,END:l,PostgresError:u,options:r,reserve:C,listen:E,begin:$,close:D,end:I}),A;function x(e){return e.debug=r.debug,Object.entries(r.types).reduce((e,[t,r])=>(e[t]=e=>new h(e,r.to),e),t),Object.assign(i,{types:t,typed:t,unsafe:function(t,r=[],i={}){return 2!=arguments.length||Array.isArray(r)||(i=r,r=[]),new c([t],r,e,N,{prepare:!1,...i,simple:"simple"in i?i.simple:0===r.length})},notify:T,array:function e(t,i){return Array.isArray(t)?new h(t,i||(t.length?j(t)||25:0),r.shared.typeArrayMap):e(Array.from(arguments))},json:R,file:function(t,r=[],i={}){return 2!=arguments.length||Array.isArray(r)||(i=r,r=[]),new c([],r,r=>{n.readFile(t,"utf8",(t,i)=>{if(t)return r.reject(t);r.strings=[i],e(r)})},N,{...i,simple:"simple"in i?i.simple:0===r.length})}}),i;function t(e,t){return new h(e,t)}function i(t,...n){return t&&Array.isArray(t.raw)?new c(t,n,e,N):"string"!=typeof t||n.length?new m(t,n):new f(r.transform.column.to?r.transform.column.to(t):t)}}async function E(e,t,i){let n={fn:t,onlisten:i},s=E.sql||(E.sql=e_({...r,max:1,idle_timeout:null,max_lifetime:null,fetch_types:!1,onclose(){Object.entries(E.channels).forEach(([e,{listeners:t}])=>{delete E.channels[e],Promise.all(t.map(t=>E(e,t.fn,t.onlisten).catch(()=>{})))})},onnotify(e,t){e in E.channels&&E.channels[e].listeners.forEach(e=>e.fn(t))}})),o=E.channels||(E.channels={});if(e in o){o[e].listeners.push(n);let t=await o[e].result;return n.onlisten&&n.onlisten(),{state:t.state,unlisten:l}}o[e]={result:s`listen ${s.unsafe('"'+e.replace(/"/g,'""')+'"')}`,listeners:[n]};let a=await o[e].result;return n.onlisten&&n.onlisten(),{state:a.state,unlisten:l};async function l(){if(e in o!=!1&&(o[e].listeners=o[e].listeners.filter(e=>e!==n),!o[e].listeners.length))return delete o[e],s`unlisten ${s.unsafe('"'+e.replace(/"/g,'""')+'"')}`}}async function T(e,t){return await A`select pg_notify(${e}, ${""+t})`}async function C(){let e=Y(),t=b.length?b.shift():await new Promise((e,t)=>{let r={reserve:e,reject:t};a.push(r),g.length&&Q(g.shift(),r)});O(t,y),t.reserved=()=>e.length?t.execute(e.shift()):O(t,y),t.reserved.release=!0;let r=x(function(r){t.queue===_?e.push(r):t.execute(r)||O(t,_)});return r.release=()=>{t.reserved=null,q(t)},r}async function $(e,t){t||(t=e,e="");let r=Y(),i=0,n,s=null;try{return await A.unsafe("begin "+e.replace(/[^a-z ]/ig,""),[],{onexecute:function(e){n=e,O(e,y),e.reserved=()=>r.length?e.execute(r.shift()):O(e,y)}}).execute(),await Promise.race([o(n,t),new Promise((e,t)=>n.onclose=t)])}catch(e){throw e}async function o(e,t,n){let a,l;let c=x(function(t){t.catch(e=>a||(a=e)),e.queue===_?r.push(t):e.execute(t)||O(e,_)});c.savepoint=function t(r,n){return r&&Array.isArray(r.raw)?t(e=>e.apply(e,arguments)):(1==arguments.length&&(n=r,r=null),o(e,n,"s"+i+++(r?"_"+r:"")))},c.prepare=e=>s=e.replace(/[^a-z0-9$-_. ]/gi),n&&await c`savepoint ${c(n)}`;try{if(l=await new Promise((e,r)=>{let i=t(c);Promise.resolve(Array.isArray(i)?Promise.all(i):i).then(e,r)}),a)throw a}catch(e){throw await (n?c`rollback to ${c(n)}`:c`rollback`),e instanceof u&&"25P02"===e.code&&a||e}return n||(s?await c`prepare transaction '${c.unsafe(s)}'`:await c`commit`),l}}function O(e,t){return e.queue.remove(e),t.push(e),e.queue=t,t===b?e.idleTimer.start():e.idleTimer.cancel(),e}function R(e){return new h(e,3802)}function U(e,t){return e.execute(t)?O(e,v):O(e,_)}function N(e){return new Promise((t,i)=>{e.state?e.active?ei(r).cancel(e.state,t,i):e.cancelled={resolve:t,reject:i}:(a.remove(e),e.cancelled=!0,e.reject(d.generic("57014","canceling statement due to user request")),t())})}async function I({timeout:e=null}={}){let t;return o||(await 1,o=Promise.race([new Promise(r=>null!==e&&(t=setTimeout(L,1e3*e,r))),Promise.all(k.map(e=>e.end()).concat(E.sql?E.sql.end({timeout:0}):[],s.sql?s.sql.end({timeout:0}):[]))]).then(()=>clearTimeout(t)))}async function D(){await Promise.all(k.map(e=>e.end()))}async function L(e){for(await Promise.all(k.map(e=>e.terminate()));a.length;)a.shift().reject(d.connection("CONNECTION_DESTROYED",r));e()}function Q(e,t){return O(e,p),e.connect(t),e}function B(e){O(e,w)}function q(e){if(0===a.length)return O(e,b);let t=Math.ceil(a.length/(p.length+1)),r=!0;for(;r&&a.length&&t-- >0;){let t=a.shift();if(t.reserve)return t.reserve(e);r=e.execute(t)}r?O(e,v):O(e,_)}function M(e,t){O(e,g),e.reserved=null,e.onclose&&(e.onclose(t),e.onclose=null),r.onclose&&r.onclose(e.id),a.length&&Q(e,a.shift())}}function eS(e){return(.5+Math.random()/2)*Math.min(3**e/100,20)}function ek(){return 60*(30+30*Math.random())}}};